(window.webpackJsonp=window.webpackJsonp||[]).push([[2],[function(e,t,n){"use strict";(function(e){var i=n(4),s=n(14),a=n(131),r=n(148),o=n(154),l=n(153),c=n(38),h=n(151),d=n(149),u=n(150),p=n(152),m=n(160),f=n(146),g=n.n(f),v=n(159),y=n(147),b=n(155),_=n(262),x=n(162),w=n(161),S=n(166),L=n(168),T=n(254);a.a;class E extends c.a{constructor(){super(),e(this),this.settings=g.a}initialize(){if(this.initialized)return;this.initialized=!0,this.version=new y.a,this.time=new r.a,this.keyboard=new d.a,this.mouse=new u.a,this.multiTouch=new h.a,this.scroll=new p.a,this.store=new l.a,this.viewport=new o.a,this.assets=new b.a,this.broadphase=new v.a,this.templateEngine=new m.a,this.time.addEventListener("update",this.update);const e=Object.assign({},i.a.files.get("canvas.pack"),i.a.files.get("canvas.pack/ao_maps"));return this.assets.register(e).then(this.onReady)}onReady(){this.ready||(this.ready=!0,this.physics=new w.a,this.renderer=new x.a,this.camera=new S.a,this.scene=new L.a,this.ui=new T.a,this.audio=new _.a,this.mouse.addEventListeners(),this.keyboard.addEventListeners(),this.multiTouch.addEventListeners(),this.scroll.addEventListeners(),this.time.start(),this.dispatchEvent({type:"applySettings"}),this.dispatchEvent({type:"ready"}),this.mouse.addEventListener("down",this.onMouseDown),this.mouse.addEventListener("up",this.onMouseUp),this.multiTouch.addEventListener("touchStart",this.onMouseDown),this.multiTouch.addEventListener("touchEnd",this.onMouseUp),this.keyboard.addEventListener("keyDown",this.onKeyDown),setTimeout(i.a.preloader.onLoad,100),addEventListener("beforeunload",this.onBeforeUnload),s.a.initialize())}update(){this.ready&&(this.dispatchEvent({type:"applySettings"}),this.dispatchEvent({type:"beforePhysics"}),this.dispatchEvent({type:"physics"}),this.dispatchEvent({type:"beforeUpdate"}),this.dispatchEvent({type:"update"}),this.dispatchEvent({type:"beforeRender"}),this.dispatchEvent({type:"render"}),this.dispatchEvent({type:"afterRender"}))}onMouseDown(){this.input=this.multiTouch.getTouch()||this.mouse,this.clickStartTime=this.time.elapsedTime}onMouseUp(){if(!this.input)return;const e=this.time.elapsedTime-this.clickStartTime,t=this.input.getDeltaPosition(),n=e<.25&&t.length()<15,{x:i,y:s}=this.input.currentPosition,a=this.isOverCanvas(i,s);n&&a&&(delete this.input,this.dispatchEvent({type:"click"}))}onKeyDown(e){"Escape"===e.key&&i.a.router.navigate()}onBeforeUnload(){const e=a.a.round(this.time.elapsedTime);i.a.tracker.event("time_passed, label, "+e)}isOverCanvas(e,t){const n=document.elementFromPoint(e,t);return this.renderer.domElement===n}}const A=new E;t.a=A,addEventListener("DOMContentLoaded",A.initialize)}).call(this,n(6).default)},,,,function(e,t,n){"use strict";t.a={viewID:"",data:Object.assign({},{config:window.config,content:window.content,manifest:window.manifest,language:window.config.locale.language})}},,function(e,t,n){"use strict";n.r(t),t.default=function(e){const t=function(e){const t=[];do{const n=Object.getOwnPropertyNames(e);for(let i=0,s=n.length;i<s;i++){const s=n[i],a=Object.getOwnPropertyDescriptor(e,s);a.get||a.set||t.push(s)}}while(e=Object.getPrototypeOf(e));return t}(e);for(let n=0,i=t.length;n<i;n++){const i=t[n],s=e[i];"constructor"!==i&&"function"==typeof s&&(e[i]=e[i].bind(e))}return e}},,,,,,,,function(e,t,n){"use strict";(function(e){var i=n(4),s=n(0);t.a=new class{constructor(){e(this),this.characters={},this.achievements={},this.trophies={},this.areas={},this.bottles={},this.stars={},this.cards={},this.outfit={},this.player={distance:0},this.soccer={games:0,bestScore:0},this.cycling={games:0,bestScore:0};const t=JSON.parse(localStorage.getItem("backup"));Object.assign(this,t)}initialize(){this.addEventListeners()}addEventListeners(){s.a.addEventListener("afterRender",this.afterRender)}setAchievement(e){this.achievements[e]||(this.achievements[e]=!0,this.achievement=e)}setAllAchievements(){content.dashboard.achievements.map(e=>e.id).forEach(e=>this.setAchievement(e))}setTrophy(e){this.trophies[e]||(this.trophies[e]=!0,this.trophy=e,"passion-powers-progress"===e&&i.a.tracker.event("dashboard_complete"))}afterRender(){const e=content.dashboard.achievements.length,t=Object.keys(this.achievements).length;s.a.player.hasMedal=t>=e,t>=e&&this.setTrophy("passion-powers-progress"),"home"!==i.a.viewID&&clearTimeout(this.timeout),(this.trophy||this.achievement)&&(this.timeout=setTimeout(this.display,1e3)),localStorage.setItem("backup",JSON.stringify({characters:this.characters,achievements:this.achievements,trophies:this.trophies,player:this.player,soccer:this.soccer,cycling:this.cycling,bottles:this.bottles,areas:this.areas,stars:this.stars,cards:this.cards,outfit:this.outfit}))}display(){if("home"!==i.a.viewID)return clearTimeout(this.timeout);if(this.trophy){const e="/trophy/"+this.trophy;i.a.router.navigate(e)}else this.achievement&&(s.a.ui.achievements.activate(!0,this.achievement),setTimeout(()=>s.a.ui.achievements.activate(!1),3e3),this.achievement=null)}}}).call(this,n(6).default)},,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));class i{constructor(){this.listeners={}}addEventListener(e,t){return this.listeners[e]||(this.listeners[e]=[]),-1===this.listeners[e].indexOf(t)&&this.listeners[e].push(t),this}hasEventListener(e,t){return void 0!==this.listeners[e]&&-1!==this.listeners[e].indexOf(t)}removeEventListener(e,t){const n=this.listeners[e];if(void 0!==n){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}return this}dispatchEvent(e){const t=this.listeners[e.type]||[];e.target=this;for(let n=0,i=t.length;n<i;n++)t[n].call(this,e);return this}}},,,,,function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return a}));var i=n(30),s=n(1);class a extends i.a{constructor(t,{width:n=128,height:i=128,flipY:a=!1}={}){const r=document.createElement("canvas");r.width=n,r.height=i,super(r),e(this),this.minFilter=s.V,this.magFilter=s.V,this.flipY=a,this.generateMipmaps=!0,this.transparent=!0,this.svg=t.cloneNode(!0),this.width=n,this.height=i,this.serializer=new XMLSerializer,this.data=document.createElement("img"),this.context=r.getContext("2d")}copy(e){return super.copy(e),this.svg=e.svg,this.width=e.width,this.height=e.height,this}setColor(e,t){const n=this.svg.querySelectorAll(e);n.length&&n.forEach(e=>e.style.fill=t)}rasterize(){return this.svg.setAttribute("width",this.width),this.svg.setAttribute("height",this.height),new Promise(e=>{const t=this.serializer.serializeToString(this.svg),n="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t)));this.data.onload=()=>{this.context.drawImage(this.data,0,0,this.width,this.height),this.needsUpdate=!0,e()},this.data.setAttribute("src",n)})}}}).call(this,n(6).default)},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));class i{constructor(){this.listeners={}}addEventListener(e,t){return this.listeners[e]||(this.listeners[e]=[]),-1===this.listeners[e].indexOf(t)&&this.listeners[e].push(t),this}hasEventListener(e,t){return void 0!==this.listeners[e]&&-1!==this.listeners[e].indexOf(t)}removeEventListener(e,t){const n=this.listeners[e];if(void 0!==n){const e=n.indexOf(t);-1!==e&&n.splice(e,1)}return this}dispatchEvent(e){const t=this.listeners[e.type]||[];e.target=this;for(let n=0,i=t.length;n<i;n++)t[n].call(this,e);return this}}},function(e,t,n){"use strict";t.a="varying vec2 vUv;\n\nvoid main() {\n\n\tvUv = uv;\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1. );\n\n}\n"},,,,function(e,t,n){"use strict";var i=n(5),s=n(2),a=n(3),r=n(15),o=n(68),l=n(83),c=n(1);const h={computeTangents:function(e){const t=e.index,n=e.attributes;if(null===t||void 0===n.position||void 0===n.normal||void 0===n.uv)return;const r=t.array,o=n.position.array,l=n.normal.array,c=n.uv.array,h=o.length/3;void 0===n.tangent&&e.setAttribute("tangent",new i.a(new Float32Array(4*h),4));const d=n.tangent.array,u=[],p=[];for(var m=0;m<h;m++)u[m]=new s.a,p[m]=new s.a;const f=new s.a,g=new s.a,v=new s.a,y=new a.a,b=new a.a,_=new a.a,x=new s.a,w=new s.a;function S(e,t,n){f.fromArray(o,3*e),g.fromArray(o,3*t),v.fromArray(o,3*n),y.fromArray(c,2*e),b.fromArray(c,2*t),_.fromArray(c,2*n),g.sub(f),v.sub(f),b.sub(y),_.sub(y);const i=1/(b.x*_.y-_.x*b.y);isFinite(i)&&(x.copy(g).multiplyScalar(_.y).addScaledVector(v,-b.y).multiplyScalar(i),w.copy(v).multiplyScalar(b.x).addScaledVector(g,-_.x).multiplyScalar(i),u[e].add(x),u[t].add(x),u[n].add(x),p[e].add(w),p[t].add(w),p[n].add(w))}let L=e.groups;0===L.length&&(L=[{start:0,count:r.length}]);m=0;for(var T=L.length;m<T;++m)for(var E=U=(O=L[m]).start,A=U+O.count;E<A;E+=3)S(r[E+0],r[E+1],r[E+2]);const M=new s.a,C=new s.a,D=new s.a,P=new s.a;let I,k,R;function z(e){D.fromArray(l,3*e),P.copy(D),k=u[e],M.copy(k),M.sub(D.multiplyScalar(D.dot(k))).normalize(),C.crossVectors(P,k),R=C.dot(p[e]),I=R<0?-1:1,d[4*e]=M.x,d[4*e+1]=M.y,d[4*e+2]=M.z,d[4*e+3]=I}for(m=0,T=L.length;m<T;++m){var O,U;for(E=U=(O=L[m]).start,A=U+O.count;E<A;E+=3)z(r[E+0]),z(r[E+1]),z(r[E+2])}},mergeBufferGeometries:function(e,t){const n=null!==e[0].index,i=new Set(Object.keys(e[0].attributes)),s=new Set(Object.keys(e[0].morphAttributes)),a={},o={},l=e[0].morphTargetsRelative,c=new r.a;let h=0;for(var d=0;d<e.length;++d){const r=e[d];let m=0;if(n!==(null!==r.index))return null;for(var u in r.attributes){if(!i.has(u))return null;void 0===a[u]&&(a[u]=[]),a[u].push(r.attributes[u]),m++}if(m!==i.size)return null;if(l!==r.morphTargetsRelative)return null;for(var u in r.morphAttributes){if(!s.has(u))return null;void 0===o[u]&&(o[u]=[]),o[u].push(r.morphAttributes[u])}if(c.userData.mergedUserData=c.userData.mergedUserData||[],c.userData.mergedUserData.push(r.userData),t){var p;if(n)p=r.index.count;else{if(void 0===r.attributes.position)return null;p=r.attributes.position.count}c.addGroup(h,p,d),h+=p}}if(n){let t=0;const n=[];for(d=0;d<e.length;++d){const i=e[d].index;for(var m=0;m<i.count;++m)n.push(i.getX(m)+t);t+=e[d].attributes.position.count}c.setIndex(n)}for(var u in a){const e=this.mergeBufferAttributes(a[u]);if(!e)return null;c.setAttribute(u,e)}for(var u in o){const e=o[u][0].length;if(0===e)break;c.morphAttributes=c.morphAttributes||{},c.morphAttributes[u]=[];for(d=0;d<e;++d){const e=[];for(m=0;m<o[u].length;++m)e.push(o[u][m][d]);const t=this.mergeBufferAttributes(e);if(!t)return null;c.morphAttributes[u].push(t)}}return c},mergeBufferAttributes:function(e){let t,n,s,a=0;for(var r=0;r<e.length;++r){const i=e[r];if(i.isInterleavedBufferAttribute)return null;if(void 0===t&&(t=i.array.constructor),t!==i.array.constructor)return null;if(void 0===n&&(n=i.itemSize),n!==i.itemSize)return null;if(void 0===s&&(s=i.normalized),s!==i.normalized)return null;a+=i.array.length}const o=new t(a);let l=0;for(r=0;r<e.length;++r)o.set(e[r].array,l),l+=e[r].array.length;return new i.a(o,n,s)},interleaveAttributes:function(e){let t,n=0,i=0;for(var s=0,a=e.length;s<a;++s){var r=e[s];if(void 0===t&&(t=r.array.constructor),t!==r.array.constructor)return null;n+=r.array.length,i+=r.itemSize}const c=new o.a(new t(n),i);let h=0;const d=[],u=["getX","getY","getZ","getW"],p=["setX","setY","setZ","setW"];var m=0;for(a=e.length;m<a;m++){const t=(r=e[m]).itemSize,n=r.count,i=new l.a(c,t,h,r.normalized);d.push(i),h+=t;for(let e=0;e<n;e++)for(let n=0;n<t;n++)i[p[n]](e,r[u[n]](e))}return d},estimateBytesUsed:function(e){let t=0;for(const n in e.attributes){const i=e.getAttribute(n);t+=i.count*i.itemSize*i.array.BYTES_PER_ELEMENT}const n=e.getIndex();return t+=n?n.count*n.itemSize*n.array.BYTES_PER_ELEMENT:0,t},mergeVertices:function(e,t=1e-4){t=Math.max(t,Number.EPSILON);const n={},s=e.getIndex(),a=e.getAttribute("position"),r=s?s.count:a.count;let o=0;const l=Object.keys(e.attributes),c={},h={},d=[],u=["getX","getY","getZ","getW"];for(var p=0,m=l.length;p<m;p++){c[y=l[p]]=[],(w=e.morphAttributes[y])&&(h[y]=new Array(w.length).fill().map(()=>[]))}const f=Math.log10(1/t),g=Math.pow(10,f);for(p=0;p<r;p++){const t=s?s.getX(p):p;let i="";var v=0;for(m=l.length;v<m;v++)for(var y=l[v],b=(x=e.getAttribute(y)).itemSize,_=0;_<b;_++)i+=~~(x[u[_]](t)*g)+",";if(i in n)d.push(n[i]);else{for(v=0,m=l.length;v<m;v++){y=l[v];var x=e.getAttribute(y),w=e.morphAttributes[y];b=x.itemSize;const n=c[y],i=h[y];for(_=0;_<b;_++){const e=u[_];if(n.push(x[e](t)),w)for(let n=0,s=w.length;n<s;n++)i[n].push(w[n][e](t))}}n[i]=o,d.push(o),o++}}const S=e.clone();for(p=0,m=l.length;p<m;p++){y=l[p];const t=e.getAttribute(y);var L=new t.array.constructor(c[y]);x=new i.a(L,t.itemSize,t.normalized);if(S.setAttribute(y,x),y in h)for(v=0;v<h[y].length;v++){const t=e.morphAttributes[y][v];L=new t.array.constructor(h[y][v]);const n=new i.a(L,t.itemSize,t.normalized);S.morphAttributes[y][v]=n}}return S.setIndex(d),S},toTrianglesDrawMode:function(e,t){if(t===c.Tc)return e;if(t===c.Rc||t===c.Sc){let i=e.getIndex();if(null===i){const t=[],s=e.getAttribute("position");if(void 0===s)return e;for(var n=0;n<s.count;n++)t.push(n);e.setIndex(t),i=e.getIndex()}const s=i.count-2,a=[];if(t===c.Rc)for(n=1;n<=s;n++)a.push(i.getX(0)),a.push(i.getX(n)),a.push(i.getX(n+1));else for(n=0;n<s;n++)n%2==0?(a.push(i.getX(n)),a.push(i.getX(n+1)),a.push(i.getX(n+2))):(a.push(i.getX(n+2)),a.push(i.getX(n+1)),a.push(i.getX(n)));a.length;const r=e.clone();return r.setIndex(a),r.clearGroups(),r}return e}};t.a=h},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c}));var i=n(35),s=n(19),a=n(24),r=n(0),o=n(177),l=n(178);class c extends i.a{constructor(t={}){c.prototype.mask=null,c.prototype.rimPower=null,c.prototype.rimStrength=null,super(t),e(this),this.type="StandardMaterial",this.vertexShader=o.a,this.fragmentShader=l.a;const{textures:n}=r.a.assets;this.uniforms=Object.assign({elapsedTime:{value:0},rimPower:{value:t.rimPower||1.5},rimStrength:{value:t.rimStrength||.1},matCap:{value:n.MatCap},matCapStrength:{value:0}},s.a.clone(a.a.standard.uniforms)),r.a.addEventListener("beforeUpdate",this.beforeUpdate)}beforeUpdate(){const{rimLight:e,matCap:t,ambientOcclusion:n}=r.a.settings.lighting;this.uniforms.elapsedTime.value=r.a.time.elapsedTime,this.uniforms.rimPower.value=e.power.value,this.uniforms.rimStrength.value=e.enabled.value?e.intensity.value:0,this.uniforms.matCapStrength.value=e.enabled.value?t.intensity.value:0,this.aoMapIntensity=n.enabled.value?n.intensity.value:0}}}).call(this,n(6).default)},,,,,,,,,function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return h}));var i=n(35),s=n(8),a=n(19),r=n(24),o=n(0),l=n(175),c=n(176);class h extends i.a{constructor(t={}){h.prototype.mask=null,h.prototype.rimPower=null,h.prototype.rimStrength=null,super(t),e(this),this.type="StandardMaterial",this.vertexShader=l.a,this.fragmentShader=c.a;const{textures:n}=o.a.assets;this.uniforms=Object.assign({elapsedTime:{value:0},rimPower:{value:t.rimPower||1.5},rimStrength:{value:t.rimStrength||.1},matCap:{value:n.MatCap},matCapStrength:{value:0},mouthState:{value:1},hasMedal:{value:0},colorIndex:{value:0},mainColor:{value:[new s.a("#39CACB"),new s.a("#30cc8d"),new s.a("#f1cc60"),new s.a("#f87c6e"),new s.a("#7473b1")]},secondaryColor:{value:[new s.a("#E5703A"),new s.a("#ee5b35"),new s.a("#76ccb1"),new s.a("#f0e077"),new s.a("#dbc164")]}},a.a.clone(r.a.standard.uniforms)),o.a.addEventListener("beforeUpdate",this.beforeUpdate)}beforeUpdate(){const{rimLight:e,matCap:t,ambientOcclusion:n}=o.a.settings.lighting;this.uniforms.elapsedTime.value=o.a.time.elapsedTime,this.uniforms.rimPower.value=e.power.value,this.uniforms.rimStrength.value=e.enabled.value?e.intensity.value:0,this.uniforms.matCapStrength.value=t.enabled.value?t.intensity.value:0,this.aoMapIntensity=n.enabled.value?n.intensity.value:0}}}).call(this,n(6).default)},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));class i{constructor(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(e,t){}render(e,t,n,i,s){}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var i=n(46),s=n(19),a=n(112),r=n(72),o=n(18),l=n(51),c=n(75);class h extends c.a{constructor(e,t){super(),this.textureID=void 0!==t?t:"tDiffuse",e instanceof i.a?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=s.a.clone(e.uniforms),this.material=new i.a({defines:e.defines||{},uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.camera=new a.a(-1,1,1,-1,0,1),this.scene=new r.a,this.quad=new o.a(new l.a(2,2),null),this.quad.frustumCulled=!1,this.quad.material=this.material,this.scene.add(this.quad)}render(e,t,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this.quad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),e.render(this.scene,this.camera)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera))}}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return m}));var i=n(7),s=n(2),a=n(26),r=n(40),o=n(5),l=n(304),c=n(12),h=n(16),d=n(0),u=n(14),p=n(53);class m extends i.a{constructor(){super(),e(this),this.index=0,this.size=new s.a(1,4,1),this.boundingBox=new a.a,this.boundingSphere=new r.a,this.scaleFactor=0,this.visible=!1,d.a.addEventListener("beforeUpdate",this.beforeUpdate)}initialize(){this.material=this.material.clone(),this.setObjects(),this.setGeometries(),this.setOutfit(),this.setAnimationMixer(),this.setBody(),this.setProperties(),this.addEventListeners(),h.a.to(this,1,{scaleFactor:.75,ease:"expo.out"})}addEventListeners(){d.a.addEventListener("update",this.update)}beforeUpdate(){this.setVisible(),this.visible&&!this.initialized&&this.initialize()}update(){this.setAnimation()}setProperties(){this.animationDelay=10*Math.random(),this.animationMixer.update(this.animationDelay)}setAnimation(){if(!this.visible)return this.skeleton.dispose();const e=this.currentAnimation||(this.setAnimationFromSpeed?this.setAnimationFromSpeed():"HappyIdle");for(const t in this.animations){const n=this.animations[t],i=t===e?1:0;n.weight=Math.lerp(n.weight,i,.1);const s=n.weight<.01?"stop":"play";"Player"!==this.name&&n[s]()}this.animationMixer.update(d.a.time.deltaTime)}setObjects(){this.object=new i.a,this.add(this.object),this.armature=new i.a,this.object.add(this.armature)}setGeometries(){if(this.outfit={top:0,middle:0,bottom:0},!m.heads){const{objects:e}=d.a.assets,t=e["Character.glb/Armature"];m.armature=new i.a,d.a.assets.clone(t,m.armature),m.heads=[],m.mouths=[],m.bodies=[],m.socks=[],m.shoes=[],m.armature.traverse(e=>{if(!e.isMesh)return;const t=e.name.split("_"),n=t[0],i=parseInt(t[1])-1;if(e.name.match(/(Bike|Wheel)/))return;e.skeleton.dispose(),e.updateMatrixWorld();const s=e.geometry.clone();s.applyMatrix4(e.matrixWorld);const a=s.attributes.uv2;for(let e=0,t=.5*a.array.length;e<t;e++){const t=a.getX(e);a.setX(e,.5*t)}if(this.setAttributes(e.name,s),e.name.match("Body_Staff"))return m.collier=s;if(e.name.match("Body_Winner"))return m.medal=s;switch(n){case"Character":m.main=s;break;case"Head":m.heads[i]=s;break;case"Mouth":m.mouths[i]=s;break;case"Body":m.bodies[i]=s;break;case"Socks":m.socks[i]=s;break;case"Shoes":m.shoes[i]=s}});for(let e=m.armature.children.length-1,t=0;e>=t;e--){const t=m.armature.children[e];t.name.match(/(Hips|Character)/g)||m.armature.remove(t)}}d.a.assets.clone(m.armature,this.armature),this.mesh=this.getObjectByName("Character"),this.mesh.material=this.material,this.mesh.castShadow=!0,this.mesh.receiveShadow=!0,this.mesh.frustumCulled=!1,this.skeleton=this.mesh.skeleton}setAttributes(e,t){const n=t.attributes.position.count,i=parseInt(e.replace(/[^\d.]/g,"")),s=e.match("Mouth")?i:e.match("Win")?4:0,a=new Array(n).fill(s),r=new o.a(new Float32Array(a),1);t.setAttribute("shape",r)}setAnimationMixer(e){e=e||["AirSquat","BicycleCrunch","Cycling","HappyIdle","Injured","PushUp","RightTurn","Running","SittingIdle","SoccerPenaltyKick","Swimming","TreadingWater","Walking","Waving"],this.animationMixer=new l.a(this.armature),this.animations={};for(let t=0,n=e.length;t<n;t++){const n=e[t],i=d.a.assets.animations["Character.glb/"+n];"RightTurn"===n&&i.tracks.remove(i.tracks[1]);const s=this.animationMixer.clipAction(i);this.animations[n]=s,s.weight="HappyIdle"===n?1:0,s.play()}this.animations.Running&&(this.animations.Running.timeScale=1.5),this.animations.Walking&&(this.animations.Walking.timeScale=this.animations.Running._clip.duration/this.animations.Walking._clip.duration,this.animations.Walking.timeScale=1.5),this.animations.RightTurn&&(this.animations.RightTurn.clampWhenFinished=!0)}setBody(){this.body=new c.Body({mass:"Player"===this.name?1:0,linearDamping:0,angularDamping:0,fixedRotation:!0}),this.radius=.6,this.shape=new c.Sphere(this.radius),this.body.addShape(this.shape);const{Default:e,Ball:t}=d.a.physics.groups;this.body.collisionFilterGroup=e,this.body.collisionFilterMask=e|t,this.body.mesh=this,this.body.material=d.a.physics.settings.Character,d.a.physics.add(this.body)}setOutfit(e){if(!e)if("Player"===this.name&&void 0!==u.a.outfit.top){const{top:e,middle:t,bottom:n}=u.a.outfit;this.outfit.top=e,this.outfit.middle=t,this.outfit.bottom=n}else{const{heads:e,bodies:t,shoes:n}=m;this.outfit.top=this.isStaff?3:Math.randInt(0,e.length-1),this.outfit.middle=Math.randInt(0,4),this.outfit.bottom=Math.randInt(0,n.length-1)}const{top:t,middle:n,bottom:i}=this.outfit,{main:s,mouths:a,heads:r,bodies:o,shoes:l,socks:c}=m,h=r[Math.euclideanModulo(t,r.length)],f=o[Math.euclideanModulo(n,o.length)],g=l[Math.euclideanModulo(i,l.length)],v=c[Math.euclideanModulo(i,c.length)],{textures:y}=d.a.assets;this.colorIndex=this.isStaff?4:Math.euclideanModulo(n,4),this.material.uniforms.colorIndex.value=this.colorIndex,this.material.map=y.Character,this.material.needsUpdate=!0;const b=[s,h,f,g,v];this.isStaff||this.canSpeak||"Player"===this.name?b.push(...a):b.push(a[0]),this.isStaff&&b.push(m.collier),this.mesh.geometry=p.a.mergeBufferGeometries(b),this.mesh.visible=!0,"Player"===this.name&&(u.a.outfit.top=this.outfit.top,u.a.outfit.middle=this.outfit.middle,u.a.outfit.bottom=this.outfit.bottom)}setMouth(){if(!this.isTalking)return;const{elapsedTime:e}=d.a.time;e-d.a.lastSpeakTime>3.5?this.material.uniforms.mouthState.value=1:e-this.lastMouthTime<this.mouthDelay||(this.lastMouthTime=e,this.mouthDelay=Math.randFloat(.05,.15),this.material.uniforms.mouthState.value=Math.randInt(1,3))}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c}));var i=n(18),s=n(35),a=n(12),r=n(16),o=n(4),l=n(0);class c extends i.a{constructor(t,n){const{materials:i,textures:r}=l.a.assets;i.Collectable||(i.Collectable=new s.a({map:r.Colors,envMap:r.EnvMap,roughness:.95,metalness:.15}));super(n,i.Collectable),e(this),this.node=t,this.name=t.name,this.castShadow=!0,this.receiveShadow=!0,this.body=new a.Body({mass:1}),this.shape=new a.Sphere(1),this.body.mesh=this;const{Default:o}=l.a.physics.groups;this.body.collisionFilterGroup=o,this.body.collisionFilterMask=o,this.body.addShape(this.shape),this.body.collisionResponse=!1,l.a.physics.add(this.body),l.a.addEventListener("ready",this.initialize)}initialize(){this.reset(),this.addEventListeners(),this.position.copy(this.node.position),this.body.position.copy(this.position),this.body.quaternion.copy(this.quaternion)}reset(){this.scaleFactor=0}addEventListeners(){l.a.addEventListener("beforeUpdate",this.beforeUpdate),this.body.addEventListener("collide",this.onCollide)}beforeUpdate(){this.scale.setScalar(this.scaleFactor),this.position.y=1+.25*Math.sin(2*l.a.time.elapsedTime),this.rotation.y+=.05,this.body.position.copy(this.position),this.body.quaternion.copy(this.quaternion);const{collectables:e}=l.a.settings.visibility;this.visible=this.scaleFactor>.05&&e.value;const t=l.a.scene.getPlayerDistance(this.position);this.activate(!this.collected&&t<25&&"home"===o.a.viewID),this.collected&&(this.visible=!1)}activate(e){if(this.active===e)return;this.active=e;const t=e?1:0;r.a.to(this,1,{scaleFactor:t,ease:"expo.out"}),this.body.disabled=!e}onCollide(){l.a.player.effect.emit(this.collectableID,this.position),l.a.audio.play("Collectable")}}}).call(this,n(6).default)},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(2),s=n(0),a=n(63),r=n(77);class o extends r.a{constructor(e,t){super();const{materials:n,textures:i}=s.a.assets;n.NonPlayableCharacter||(n.NonPlayableCharacter=new a.a({envMap:i.EnvMap,aoMap:i["canvas.pack/ao_maps/Other.png"],skinning:!0,roughness:.95,metalness:.15})),this.node=e,this.parameters=t,this.characterID=t.characterID,this.animationID=t.animationID,this.points=t.points,this.name=e.name,this.index=parseInt(this.name.replace(/[^\d.]/g,"")),this.material=n.NonPlayableCharacter,this.rotation.order="YXZ",this.position.copy(this.node.position),this.quaternion.copy(this.node.quaternion)}initialize(){this.initialized||(super.initialize(),this.initialized=!0,this.setHeight())}beforeUpdate(){this.setBoundingBox(),this.setProximity(),this.setScale(),super.beforeUpdate()}update(){super.update(),this.setPosition()}setProperties(){super.setProperties(),this.currentAnimation=this.animationID}setAnimationMixer(e){e=e||[this.animationID||"HappyIdle"],super.setAnimationMixer(e)}setPlayerClose(){const e=new i.a(1.5,0,1.5).add(this.position);s.a.player.body.position.copy(e),s.a.player.body.velocity.set(0,0,0),s.a.player.setHeight()}setVisible(){this.visible=this.intersectsFrustum&&this.isViewable&&this.isUnscaled,s.a.settings.visibility.npcs.value||(this.visible=!1)}setHeight(){if("SittingIdle"===this.animationID)this.position.y-=.35;else{const e=s.a.navigation.raycast(this.position,1,!1);e&&(this.position.y=e.y)}}setProximity(){if("Player"===this.name)return;const{frustum:e}=s.a.camera,t=s.a.scene.getPlayerDistance(this.position);this.intersectsFrustum=e.intersectsSphere(this.boundingSphere),this.isClose=t<(this.isInjured?10:4),this.isNearby=t<25,this.isViewable=t<50}setBoundingBox(){const e=i.a.get().copy(this.size).multiplyScalar(this.scaleFactor);this.boundingBox.setFromCenterAndSize(this.position,this.size),this.boundingBox.getBoundingSphere(this.boundingSphere),i.a.release(e)}setScale(){const{radiusFactor:e}=s.a.camera.controls,t=(1-e)*this.scaleFactor;this.scale.setScalar(t),this.isUnscaled=1-e>.01}setPosition(){this.body.position.copy(this.position),this.body.position.y=this.radius,this.body.disabled=!this.visible||!this.isClose}}},,,function(e,t,n){"use strict";var i=n(49);t.a={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:i.a,fragmentShader:"uniform float opacity;\n\nuniform sampler2D tDiffuse;\n\nvarying vec2 vUv;\n\nvoid main() {\n\n\tvec4 texelColor = texture2D( tDiffuse, vUv );\n\tgl_FragColor = texelColor;\n\n}\n"}},,,,,,,,,,function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return d}));var i=n(71),s=n(2),a=n(4),r=n(0),o=n(14),l=n(79),c=n(108),h=n(109);class d extends l.a{constructor(t,n){super(t,n),e(this),r.a.characters[this.characterID]=this,this.isIntro="Intro"===this.characterID,this.isInjured="Injured"===this.characterID,this.isStaff=!!d.routes[this.characterID]&&!this.isInjured,this.canSpeak=!!d.routes[this.characterID]&&!this.isIntro}addEventListeners(){super.addEventListeners(),r.a.addEventListener("click",this.onClick),r.a.addEventListener("startDialog",this.onDialogStart),r.a.addEventListener("endDialog",this.onDialogEnd),r.a.mouse.addEventListener("move",this.setHoverState),r.a.multiTouch.addEventListener("touchStart",this.setHoverState)}beforeUpdate(){super.beforeUpdate(),this.canSpeak&&this.isNearby&&this.visible&&(this.speechBubble||(this.speechBubble=new c.a(this),r.a.scene.add(this.speechBubble),this.raycastTarget=new h.a(this),r.a.scene.add(this.raycastTarget))),r.a.speakingCharacter!==this||this.isTalking||this.onDialogStart(),!r.a.speakingCharacter&&this.isTalking&&this.onDialogEnd()}update(){super.update(),this.setRotation(),this.setMouth()}setProperties(){super.setProperties(),this.raycaster=new i.a}setAnimationMixer(e){super.setAnimationMixer(e||["HappyIdle","Waving"])}setAnimation(e){this.currentAnimation=e||(this.isHovered?"Waving":"HappyIdle"),super.setAnimation()}setHoverState(){if(!this.visible||!this.isClose)return this.isHovered=!1;if(!this.canSpeak||r.a.player.isTalking)return this.isHovered=!1;if("home"!==a.a.viewID&&!this.isInjured||"home"===a.a.viewID&&this.isInjured)return this.isHovered=!1;const{multiTouch:e,mouse:t}=r.a,n=(e.getTouch()||t).getNormalizedPosition(r.a.viewport.size);this.raycaster.setFromCamera(n,r.a.camera),this.raycastTarget.visible=!0;const i=this.raycaster.intersectObject(this.raycastTarget);this.raycastTarget.visible=!1;const s=!!i.length;s&&!this.isHovered&&this.onHover(),this.isHovered=s}onHover(){r.a.audio.play("Hover",{volume:.5})}onClick({forceClick:e=!1}={}){const t=this.isHovered&&this.isClose;(e||t)&&a.a.router.navigate(d.routes[this.characterID])}onDialogStart(){this.isTalking||(this.isTalking=!0,this.isInjured&&(r.a.cycling.stop(),o.a.setTrophy("virtue-makes-victory")),o.a.characters[this.characterID]=!0)}onDialogEnd(){this.isTalking&&(this.isTalking=!1)}setRotation(){if(!this.isClose&&!this.isTalking)return;const e=this.isIntro?r.a.camera:r.a.player,t=s.a.get().copy(e.position).sub(this.position).setY(0).normalize(),n=Math.atan2(-t.z,t.x)+.5*Math.PI-this.rotation.y;this.object.rotation.y=Math.lerpAngle(this.object.rotation.y,n,.1),s.a.release(t)}}d.routes={},d.characterIDs={};for(const e in content.speeches){const t=e.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join("");d.routes[t]="/dialog/"+e.replace(/_/g,"-"),d.characterIDs[d.routes[t]]=t}}).call(this,n(6).default)},,,,,,,,,,function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return r}));var i=n(18),s=n(0),a=n(54);class r extends i.a{constructor(){const{objects:t,materials:n,textures:i}=s.a.assets;n.Bike||(n.Bike=new a.a({map:i.Colors,envMap:i.EnvMap,roughness:.95,metalness:.15})),super(),e(this);const r=t["Character.glb/Bike"];s.a.assets.clone(r,this),this.traverse(e=>{e.material=n.Bike,e.castShadow=!0,e.receiveShadow=!0}),this.position.initial=this.position.clone(),s.a.addEventListener("ready",this.initialize)}initialize(){this.reset(),this.addEventListeners()}reset(){}addEventListeners(){s.a.addEventListener("applySettings",this.applySettings)}applySettings(){}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c}));var i=n(18),s=n(2),a=n(16),r=n(4),o=n(0),l=n(63);class c extends i.a{constructor({onMinimap:t=!1}={}){const{geometries:n,textures:i}=o.a.assets,a=n["Park.glb/Pin"].clone(),r=new l.a({map:i.Character,envMap:i.EnvMap,roughness:.95,metalness:.15}),c=t?.015:.5;a.scale(c,c,c),super(a,r),e(this),this.onMinimap=t,this.viewID=t?"home":"overview",this.scaleFactor=1e-4,this.castShadow=!t,this.receiveShadow=!t,this.scale.setScalar(0),this.anchor=new s.a,o.a.renderer.prerender(this),o.a.addEventListener("ready",this.initialize)}initialize(){this.addEventListeners()}addEventListeners(){o.a.addEventListener("beforeUpdate",this.beforeUpdate)}beforeUpdate(){const{player:e}=o.a.scene;if(this.activate(r.a.viewID===this.viewID&&r.a.preloader.hidden),this.material.uniforms.colorIndex.value=e.colorIndex,this.onMinimap){this.rotation.x=-this.parent.rotation.x;const{x:t,z:n}=e.position;this.anchor.x=t/o.a.park.size.x*2,this.anchor.y=.15-n/o.a.park.size.z}else this.lookAt(o.a.camera.position);const t=Math.sin(10*o.a.time.elapsedTime);this.scale.setScalar(this.scaleFactor+.01*t*this.scaleFactor),this.position.copy(this.anchor),this.position.y+=.01*t,this.visible=this.scaleFactor>.01}activate(e){if(this.active===e)return;this.active=e;const{player:t}=o.a.scene;this.active&&!this.onMinimap&&this.anchor.copy(t.position);const n=e?1:1e-4,i=e?1.5:0,s=e?"elastic.out":"expo.out",r=e?1:.5;a.a.killTweensOf(this),a.a.to(this,r,{scaleFactor:n,ease:s,delay:i})}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return r}));var i=n(7),s=n(0),a=n(14);class r extends i.a{constructor(){super(),e(this),this.started=!1}initialize(){this.initialized||(this.initialized=!0,this.player=s.a.scene.player,this.addEventListeners())}destroy(){this.initialized&&(this.initialized=!1,this.removeEventListeners())}addEventListeners(){s.a.addEventListener("beforeUpdate",this.beforeUpdate)}removeEventListeners(){s.a.addEventListener("beforeUpdate",this.beforeUpdate)}reset(){this.score=0,this.timer=61,this.started=!1,this.setTime(),this.dispatchEvent({type:"scoreUpdate",score:this.score})}restart(){this.start()}start(){this.started||(this.started=!0,this.dispatchEvent({type:"start"}))}stop(e={}){if(!this.started)return;this.started=!1;const{bestScore:t}=a.a[this.gameID];t&&this.score>t&&a.a.setTrophy("better-beats-best"),a.a[this.gameID].games++,a.a[this.gameID].bestScore=Math.max(t,this.score);const n=a.a.soccer.games+a.a.cycling.games;n>=1&&a.a.setAchievement("all-steps-count"),n>=5&&a.a.setAchievement("better-today"),this.dispatchEvent({type:"stop",bestScore:a.a[this.gameID].bestScore,score:this.score,exit:e.exit})}beforeUpdate(){this.started}getFormattedTime(e){const t=e=>("0"+e).slice(-2),n=parseFloat(e).toFixed(3),i=Math.floor(n/60)%60,s=Math.floor(n-60*i);return t(i)+":"+t(s)}setTime(){if(0===this.timer||!this.started)return;this.timer-=s.a.time.deltaTime,this.timer<0&&(this.timer=0,this.stop());const e=this.getFormattedTime(this.timer);this.dispatchEvent({type:"timeUpdate",time:e,timer:this.timer})}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return l}));var i=n(18),s=n(51),a=n(3),r=n(0),o=n(213);class l extends i.a{constructor(t=new s.a,n=new o.a){super(t,n),e(this),this.size=new a.a(1,1),this.renderOrder=1e6,this.frustumCulled=!1,r.a.addEventListener("ready",this.initialize)}initialize(){this.reset(),this.addEventListeners()}reset(){}addEventListeners(){}setSize(e,t){this.size.x===e&&this.size.y===t||(this.geometry.scale(1/this.size.x,1/this.size.y,1),this.size.set(e,t),this.geometry.scale(e,t,1))}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return l}));var i=n(18),s=n(33),a=n(16),r=n(0),o=n(43);class l extends i.a{constructor(t=1){const{materials:n,geometries:i}=r.a.assets;if(i.Exclamation||(i.Exclamation=i["Park.glb/Circle"].clone(),i.Exclamation.scale(.25,.25,.25)),!n.Exclamation){const e=r.a.assets.svgs["canvas.pack/Exclamation.svg"],t=new o.a(e);n.Exclamation=new s.a({map:t}),t.rasterize()}super(i.Exclamation,n.Exclamation),e(this),this.scaleFactor=t,r.a.addEventListener("beforeUpdate",this.beforeUpdate)}activate(e){if(this.active===e)return;this.active=e;const t=e?this.scaleFactor:0;a.a.to(this,.5,{scaleFactor:t,ease:"expo.out"})}beforeUpdate(){const{elapsedTime:e}=r.a.time;this.scale.setScalar(1+.05*Math.sin(10*e)).multiplyScalar(this.scaleFactor)}}}).call(this,n(6).default)},,function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c}));var i=n(18),s=n(16),a=n(0),r=n(14),o=n(250),l=n(106);class c extends i.a{constructor(t){const{geometries:n,textures:i}=a.a.assets,s=i.Icons,r=new o.a({map:s}),c=n["Park.glb/SpeechBubble"];switch(t.characterID){case"GameCycling":r.uniforms.icon.value.set(1,0);break;case"VideoBrandFilm":case"VideoApp":r.uniforms.icon.value.set(2,0);break;case"Injured":r.uniforms.icon.value.set(3,0);break;case"VideoItw1":case"VideoItw2":case"VideoItw3":r.uniforms.icon.value.set(4,0);break;case"GameSoccer":r.uniforms.icon.value.set(5,0);break;default:r.uniforms.icon.value.set(0,0)}super(c,r),e(this),this.character=t,this.offsetY=t.isInjured?2.4:2.15,this.scaleFactor=0,this.hoverFactor=0,this.visible=!1,t.isInjured||(this.exclamation=new l.a(1.2),this.exclamation.position.set(.35,.85,.05),this.add(this.exclamation)),a.a.addEventListener("beforeUpdate",this.beforeUpdate)}beforeUpdate(){this.setTransform(),this.setVisible();const{isTalking:e,isNearby:t}=this.character,{cycling:n}=a.a.scene,i=this.character.isInjured?n.started:t&&!e;this.setHover(this.character.isHovered),this.character.isInjured||this.setActive(i)}setTransform(){this.scale.copy(this.character.scale).multiplyScalar(this.scaleFactor+this.hoverFactor),this.quaternion.copy(a.a.camera.quaternion),this.position.copy(this.character.position),this.position.y+=this.offsetY+.05*Math.sin(2.5*a.a.time.elapsedTime)}setVisible(){const{canSpeak:e,visible:t,characterID:n}=this.character;this.visible=e&&t&&this.scaleFactor>.05,r.a.characters[n]&&this.exclamation&&this.exclamation.activate(!1)}setActive(e){if(this.active===e)return;this.active=e;const t=e?this.character.isInjured?1.5:.8:1e-4;s.a.to(this,1,{scaleFactor:t,ease:"expo.out"})}setHover(e){if(this.isHovered===e)return;this.isHovered=e;const{colorA:t,colorB:n}=this.material.uniforms,i=this.character.isInjured?"#ffffff":"#1c228c",a=this.character.isInjured?"#ff1616":"#ffffff";t.value.set(e?i:a),n.value.set(e?a:i);const r=e?.15:0;s.a.killTweensOf(this,"hoverFactor"),s.a.to(this,1.5,{hoverFactor:r,ease:"elastic.out"})}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o}));var i=n(18),s=n(51),a=n(2),r=n(0);class o extends i.a{constructor(t){super(new s.a(1.5,3)),e(this),this.character=t,this.visible=!1,this.offset=new a.a(0,1.5,0),r.a.addEventListener("beforeUpdate",this.beforeUpdate)}beforeUpdate(){this.position.copy(this.character.position).add(this.offset),this.lookAt(r.a.camera.position)}}}).call(this,n(6).default)},,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n(71),s=n(41),a=n(2),r=n(3),o=n(16),l=n(4),c=n(0),h=n(63),d=n(77);class u extends d.a{constructor(e,t){super();const{materials:n,textures:r}=c.a.assets;n.NonPlayableCharacter||(n.NonPlayableCharacter=new h.a({envMap:r.EnvMap,aoMap:r["canvas.pack/ao_maps/Other.png"],skinning:!0,roughness:.95,metalness:.15})),this.camera=e,this.characterID=t,this.material=n.NonPlayableCharacter,this.raycaster=new i.a,this.plane=new s.a(new a.a(0,0,1)),this.isStaff=!0,this.offsetY=1,this.scaleFactor="Dialog"===this.characterID?2:1.5,this.scale.setScalar(this.scaleFactor)}initialize(){this.initialized||(this.initialized=!0,super.initialize(),this.setPosition(),this.onResize())}addEventListeners(){super.addEventListeners(),this.camera.addEventListener("resize",this.onResize),c.a.viewport.addEventListener("resize",this.onResize)}update(){super.update(),this.setPosition(),this.setMouth(),this.body.disabled=!0}setAnimationMixer(){super.setAnimationMixer(["HappyIdle","Waving"])}setProperties(){super.setProperties(),this.currentAnimation="Dialog"===this.characterID?"HappyIdle":"Waving"}setPosition(){this.object.position.y=.25*-this.size.y,this.object.position.y-=this.size.y*this.offsetY}setVisible(){this.visible=this.offsetY<.95}activate(e,t,n){if(this.active===e)return;this.active=e,e&&"Dialog"!==this.characterID&&c.a.audio.play("Notification"),this.characterID.match(/(Achievements|Collectables)/g)&&(e?l.a.notification.show(this.characterID,t,n):l.a.notification.hide()),e?(c.a.lastSpeakTime=c.a.time.elapsedTime,this.isTalking=!0):this.isTalking=!1;const i=e?0:1,s=e?"expo.out":"expo.in";o.a.to(this,1,{offsetY:i,ease:s})}onResize(){if(!this.parent)return;const e=r.a.get(),t=a.a.get();this.camera.updateMatrixWorld(),"Dialog"!==this.characterID?(e.set(-1,-.25),this.rotation.z=.2*-Math.PI):e.set(.6,-.95),this.raycaster.setFromCamera(e,this.camera),this.raycaster.ray.intersectPlane(this.plane,t),this.position.set(t.x,t.y,0),r.a.release(e),a.a.release(t)}}},function(e,t,n){"use strict";var i=n(263),s=n.n(i),a=n(264),r=n.n(a),o=n(269),l=n.n(o),c=n(267),h=n.n(c),d=n(265),u=n.n(d),p=n(266),m=n.n(p),f=n(268),g=n.n(f),v=n(270),y=n.n(v),b=n(271),_=n.n(b),x=n(272),w=n.n(x),S=n(273),L=n.n(S),T=n(274),E=n.n(T),A=n(275),M=n.n(A);t.a={locale:"",views:[{id:"home",expression:".",module:s.a,options:{silent:!1}},{id:"dashboard",expression:"dashboard",module:r.a,options:{silent:!0}},{id:"customization",expression:"customization",module:u.a,options:{silent:!0}},{id:"overview",expression:"overview",module:m.a,options:{silent:!0}},{id:"dialog",expression:"dialog/:id",module:h.a,options:{silent:!0}},{id:"game",expression:"game/:id",module:g.a,options:{silent:!0}},{id:"about",expression:"about",module:l.a,options:{silent:!0}},{id:"video",expression:"video/:id",module:y.a,options:{silent:!0}},{id:"trophy",expression:"trophy/:id",module:_.a,options:{silent:!0}},{id:"collectable",expression:"collectable/:id",module:w.a,options:{silent:!0}},{id:"code",expression:"code",module:L.a,options:{silent:!0}},{id:"no-code",expression:"no-code",module:E.a,options:{silent:!0}},{id:"subscription",expression:"subscription",module:M.a,options:{silent:!0}}]}},,,,function(e,t,n){"use strict";(function(e){const n=window.webkitAudioContext||window.AudioContext;t.a=class{constructor(t){e(this),this.files=t,this.DOMParser=document.createElement("div")}unpack(e,t){const n=this.files.manifest[e];if(n){const e=[];return this.files.cache.getFilesData(n,e),this._getFiles(t,e)}}getParseFunction(e){switch(e){case"application/json":return this.getAsJSON;case"text/plain":case"application/javascript":return this.getAsString;case"audio/mpeg":case"audio/mp4":case"audio/wav":return this.getAsAudioBuffer;case"image/png":case"image/jpeg":return this.getAsImage;case"image/svg+xml":return this.getAsSVG}}getAsURI(e,t){const n=new Blob([e],{type:t});return URL.createObjectURL(n)}getAsJSON(e){return new Promise(t=>{this.getAsString(e).then(e=>{t(JSON.parse(e))})})}getAsString(e){return new Promise(t=>{if(window.TextDecoder){const n=new Uint8Array(e),i=(new TextDecoder).decode(n);t(i)}else{const n=new Blob([e],{type:"application/octet-stream"}),i=new FileReader;i.onload=e=>t(e.target.result),i.readAsText(n)}})}getAsAudioBuffer(e){return this.audioContext=this.audioContext||new n,new Promise(t=>{this.audioContext.decodeAudioData(e,e=>{t(e)})})}getAsImage(e,t){return new Promise(n=>{const i=new Image,s=this.getAsURI(e,t.mime);i.onload=()=>n({node:i,source:s},t),i.src=s})}getAsSVG(e){return new Promise(t=>{this.getAsString(e).then(e=>{this.DOMParser.innerHTML=e;const n=this.DOMParser.querySelector("svg");t({node:n,string:e})})})}_slice(e,t){return e.slice(t.position,t.position+t.length)}_getFiles(e,t){const n=[];for(let i=0,s=t.length;i<s;i++){const s=t[i];n.push(this._getFile(e,s))}return Promise.all(n)}_getFile(e,t){const n=this._slice(e,t),i=this.getParseFunction(t.mime);return new Promise(e=>{i?i(n,t).then(n=>{this._cacheFile(n,t),e()}):(this._cacheFile(n,t),e())})}_cacheFile(e,t){const n=t.source.split("assets/").pop();this.files.cache.add(n,e,t.directoryID)}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return s}));var i=n(48);class s extends i.a{constructor(t){super(),e(this),this.files=t,this.log=!1,this.waitingList={}}load(e){const t=[],n={loadedData:{},totalData:{}};for(const i of e)t.push(this._waitlist(i,n));return Promise.all(t)}_waitlist(e,t){const n=e.path.match(/\/(.*)/)[1];if(this.files.cache.get(n))return;let i=this.waitingList[e.path];if(i)return i;if(e.path.match(/packs/g)){e.directoryID=n;const i=this.files.manifest[e.directoryID];if(!i)return;t.totalData[e.path]=i.size}return i=this._requestFile(e,t),this.waitingList[e.path]=i,i}_requestFile(e,t){return new Promise((n,i)=>{const s=new XMLHttpRequest;s.responseType=this._getFileResponseType(e);const a=e.external?e.path:`${this.files.path}/${e.path}`;s.open("GET",a),s.onprogress=n=>{this._getBatchProgress(n,e,t)},s.onload=()=>{const t=s.status>=200&&s.status<300,a=s.response;t?this._onFileLoaded(e,a).then(n):i(),delete this.waitingList[e.path]},s.onerror=()=>{i(),delete this.waitingList[e.path]},s.send()})}_getBatchProgress(e,t,n){let i=0,s=0;n.loadedData[t.path]=e.loaded;for(const e in n.loadedData)i+=n.loadedData[e],s+=n.totalData[e];const a=i/s;this.dispatchEvent({type:"progress",progress:a})}_getFileResponseType(e){let t="arraybuffer";switch(e.type){case"string":t="text";break;case"json":t="json"}return t}_onFileLoaded(e,t){return new Promise(n=>{e.directoryID?this.files.unpacker.unpack(e.directoryID,t).then(n):(this.files.cache.add(e.id,t),n())})}}}).call(this,n(6).default)},,,,,,,,,function(e,t,n){"use strict";var i=n(3),s=n(2),a=n(22),r=n(23),o=n(44),l=n(7),c=n(111),h=n(144),d=n(17),u=n(145),p=n(26),m=n(8),f=n(10);class g{static assign(e,t){e.pool=new g(e),e.pool.reset=t,e.get=function(){const t=e.pool.get();return t&&e.pool.reset&&e.pool.reset(t),t},e.release=function(){e.pool.release.apply(e.pool,arguments)},e.prototype.release=function(){return e.pool.release(this),this}}constructor(e,{maxLength:t=100}={}){this.prototype=e,this.maxLength=t,this.onMaxLengthReached=this._onMaxLengthReached,this.items=[],this.availables=[]}set(e=100,t=this._onMaxLengthReached){this.maxLength=e,this.onMaxLengthReached=t}clear(){this.items=[],this.availables=[]}reset(){for(let e=0,t=this.items.length;e<t;e++)this.items[e].release()}release(){for(let e=0;e<arguments.length;e++){const t=arguments[e];if(!t.isFromPool)throw new Error("The item is not from the pool");this.availables.push(t)}}get(){if(this.items.length>this.maxLength&&this.onMaxLengthReached(this),this.availables.length)return this.availables.pop();{const e=new this.prototype;return e.isFromPool=!0,this.items.push(e),e}}_onMaxLengthReached(){throw new Error(this.prototype.name+" pool exceed capacity")}}g.assign(i.a,e=>e.setScalar(0)),g.assign(s.a,e=>e.setScalar(0)),g.assign(a.a,e=>e.setScalar(0)),g.assign(r.a,e=>e.set(0,0,0,0)),g.assign(o.a),g.assign(l.a),g.assign(c.a),g.assign(h.a),g.assign(d.a),g.assign(u.a),g.assign(p.a),g.assign(m.a),Math.minAngleBetween=function(e,t){const n=2*Math.PI,i=(t-e)%n;return 2*i%n-i},Math.lerpAngle=function(e,t,n){return e+Math.minAngleBetween(e,t)*n},Math.randomSign=function(){return Math.random()<.5?-1:1},Math.lookAt=function(e,t,n){const i=s.a.get(),a=d.a.get(),o=r.a.get(),l=e.parent;e.updateMatrixWorld(!0,!1),i.setFromMatrixPosition(e.matrixWorld),a.lookAt(t,i,n),e.quaternion.setFromRotationMatrix(a),l&&(a.extractRotation(l.matrixWorld),o.setFromRotationMatrix(a),e.quaternion.premultiply(o.inverse())),s.a.release(i),d.a.release(a),r.a.release(o)},s.a.prototype.randomize=function(e=1){const t=2*Math.PI*Math.random(),n=Math.acos(2*Math.random()-1);return this.x=Math.sin(n)*Math.cos(t),this.y=Math.sin(n)*Math.sin(t),this.z=Math.cos(n),this.multiplyScalar(e)},Array.prototype.shuffle=function(){for(let e=this.length-1;e>0;e--){const t=Math.floor(Math.random()*(e+1));[this[e],this[t]]=[this[t],this[e]]}return this},Array.prototype.getLast=function(){return this[this.length-1]},Array.prototype.remove=function(e){const t=this.indexOf(e);-1!=e&&this.splice(t,1)},Array.ensure=function(e){return Array.isArray(e)?e:void 0!==e?[e]:[]};t.a=Object.assign(Math,f.a)},,,function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return g}));var i=n(93),s=n.n(i),a=n(287),r=n(135),o=n(4),l=n(138),c=n(48),h=n(141),d=n(142),u=n(143),p=n(140),m=n(139),f=n(0);class g extends c.a{constructor(t,n){super(),e(this),Object.assign(o.a.data,{localeExpression:s.a.compile(t.locale)(o.a.data.config.locale),routes:t.views,breakpoints:n}),Object.assign(o.a,{files:new a.a(o.a.data),router:new r.a(o.a.data.localeExpression),templateEngine:new l.a,viewport:new m.a,device:new p.a,logger:new h.a,tracker:new d.a,version:new u.a}),this.nodes={},this._getNodes(),o.a.router.add(o.a.data.routes),o.a.router.addEventListener("match",this._onRouteMatched),o.a.tracker.addEventListeners(this.nodes.main),o.a.version.detect()}_getNodes(){o.a.nodes=this.nodes,this.nodes.main=document.querySelector('[ref="app"]');o.a.templateEngine.getNodesFromDom(this.nodes.main,this.nodes,".app > *[ ref ], .app > *:not( main ) *[ ref ]")}_onRouteMatched(e){const t=e.route;t.module(n=>{const i=new n.default({id:t.id,parentNode:this.nodes.views,routeParams:e.routeParams,files:void 0===o.a.router.history.current?[]:this.files});i.addEventListener("loaded",this._onViewLoaded),o.a.files.load(i.files).then(f.a.initialize).then(i.render).then(i.initialize),this.dispatchEvent({type:"routeChanged",view:i})})}_onViewLoaded(){o.a.router.addEventListeners()}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return l}));var i=n(93),s=n.n(i),a=n(48),r=n(136),o=n(137);class l extends a.a{constructor(t){super(),e(this),this.locale=t,this.routes=[],this.redirectionRoute="",this.capture=new r.a(this),this.history=new o.a(this)}addEventListeners(){this.hasListeners||(this.hasListeners=!0,this.capture.addEventListeners(),this.history.addEventListeners())}add(e){if(Array.isArray(e)){for(let t=0,n=e.length;t<n;t++)this.add(e[t]);return}(!this.redirectionRoute&&"home"===e.id||"error"===e.id)&&(this.redirectionRoute=e.expression);const t=[];return e.regex=s()(e.expression,t),e.routeParams=t.map(e=>e.name),this.routes.push(e),this}start(e){const t=location.pathname;return e=e||t+(t===this.locale+"/"?".":""),this.navigate(e),this}navigate(e){const t=this._match(e);if(t){if(t.path===this.history.current||t.path+"/"===this.history.current)return;this.dispatchEvent(Object.assign({type:"match"},t)),this.history.replaceState(t.path,t.route.options.silent)}else this.navigate(this.redirectionRoute);return this}_match(e=""){e=e.replace(this.locale+"/","");for(const t of this.routes){const n=t.regex.exec(e);if(!n)continue;n.shift();const i={};return t.routeParams.forEach((e,t)=>i[e]=n[t]),{route:t,path:e,routeParams:i}}}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return i}));class i{constructor(t){e(this),this.router=t}addEventListeners(){addEventListener("click",this._onClick)}_onClick(e){if(e.metaKey||e.ctrlKey||e.shiftKey)return;const t=e.target;"internal"===t.getAttribute("rel")&&(e.preventDefault(),e.stopPropagation(),this.router.navigate(t.getAttribute("href")))}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return i}));class i{constructor(t){e(this),this.router=t,this.needsUpdate=!0}addEventListeners(){addEventListener("popstate",this._onPopState)}replaceState(e,t){!e.length&&(e="/"),this.previous=this.current,this.current=e,this.needsUpdate&&this._update(t),this.needsUpdate=!0}_onPopState(e){e.state&&(this.needsUpdate=!1,this.router.navigate(""+e.state.current))}_update(e){const t=this.previous?"pushState":"replaceState",n=`\n\t\t\t${this.router.locale}\n\t\t\t${this.current.startsWith("/")?"":"/"}\n\t\t\t${this.current}${location.search}`;history[t]({previous:this.previous,current:this.current},"",e?null:n)}}}).call(this,n(6).default)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));class i{constructor(){}render(e,t,n=!1){const i=e(t);return n?i:this._getNodes(i)}getNodesFromDom(e,t,n="*[ ref ]"){const i=e.querySelectorAll(n);for(let e=0,n=i.length;e<n;e++){const n=i[e];n.getAttribute("ref").split(", ").forEach(e=>{const i=t[e];Array.isArray(i)?t[e].push(n):t[e]=i?[i,n]:n})}return t}_getNodes(e){const t={},n=document.createElement("div");if(n.innerHTML=e,n.children.length,t.main=n.children[0],t.main)return this.getNodesFromDom(t.main,t),t}}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return r}));var i=n(3),s=n(4),a=n(48);class r extends a.a{constructor(){super(),this.log=!1,e(this),this.size=new i.a,this.breakpoints=s.a.data.breakpoints,addEventListener("visibilitychange",this._onVisibilityChange,!1),addEventListener("orientationchange",this._onOrientationChange,!1),addEventListener("resize",this._onResize,!1),this.addEventListener("orientationChange",this._log),this.addEventListener("resize",this._log),this.addEventListener("visibilityChange",this._log),this.update()}update(){this._update(),this.dispatchEvent({type:"orientationChange"}),this.dispatchEvent({type:"resize"})}isFullscreen(){return!this.orientation&&this.height===screen.height&&this.width===screen.width||this.orientation&&this.width===screen.height&&this.height===screen.width}matchMedia({from:e=!1,until:t=!1,mediaType:n="all"}={}){let i="";return e&&(i=` and (min-width: ${this.breakpoints[e]})`),t&&(i=`${i} and (max-width: ${t=parseInt(this.breakpoints[t])-1}px)`),matchMedia(n+i).matches}_update(){this.width=window.innerWidth,this.height=window.innerHeight,this.size.set(this.width,this.height),this.aspect=this.width/this.height,this.devicePixelRatio=window.devicePixelRatio||1,this.orientation=this.aspect>1?"landscape":"portrait",document.body.style.setProperty("--vh",this.height+"px")}_onOrientationChange(){this._update(),this.dispatchEvent({type:"orientationChange"})}_onResize(){this._update(),this.dispatchEvent({type:"resize"})}_onVisibilityChange(){this.visibilityState=document.visibilityState,this.hidden=document.hidden,this.dispatchEvent({type:"visibilityChange",hidden:this.hidden})}_log(e){this.log&&s.a.logger.log("Viewport: "+e.type)}}}).call(this,n(6).default)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));class i{constructor(){this.log=!1,this.detect()}detect(e){this.userAgent=e||navigator.userAgent.toLowerCase(),this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("experimental-webgl"),this.hasTouch="ontouchstart"in window,this.types=this.getType(),this.deviceType=this.getDeviceType(this.types),this.os=this.getOS(),this.browser=this.getBrowser(),this.browserVersion=this.getBrowserVersion(),this.supportedVideoFormats=this.getSupportedVideoFormats(),this.gpu=this.getGPU(),this.webGL=this.getWebGL(),this.isWebview=this.getWebview(),this._addClasses(),this.log}getType(){const e=this.hasTouch&&this._parse(["ios","iphone","ipad","windows","android","blackberry"]);let t,n;e&&(t=Math.max(screen.width,screen.height)>900,n=!t);return{phone:!!n,tablet:!!t,mobile:!!e,desktop:!!!e}}getDeviceType(e){for(const t in e)if(e.hasOwnProperty(t)&&e[t])return"device-"+t}getOS(){const e=this.types.desktop?[["mac os","macOS"],["windows nt 6.3","Windows-8.1"],["windows nt 6.2","Windows-8"],["windows nt 6.1","Windows-7"],["windows nt 6.0","Windows-Vista"],["windows nt 5.1","Windows-XP"],["windows","Windows"],["linux","Linux"]]:[[["ipad","iphone"],"iOS"],[["windows","iemobile"],"Windows"],[["android","kindle"],"Android"],["blackberry","Blackberry"]];for(const t of e)if(this._parse(t[0]))return t[1];return"Unknown"}getBrowser(){const e=[["chrome","Chrome"],["safari","Safari"],["firefox","Firefox"],[["msie","trident","rv:","edge"],"IE"]];for(const t of e)if(this._parse(t[0]))return t[1]}getBrowserVersion(){const e=e=>Number(this.userAgent.split(e)[1].split(".")[0]);switch(this.browser){case"Chrome":case"Firefox":return e(this.browser.toLowerCase()+"/");case"Safari":let t=this.userAgent.match(/version\/([.\d]+)/i);return null==t&&(t=this.userAgent.match(/CriOS\/([.\d]+)/i)),parseFloat(t[1]);case"IE":return this._parse("msie")?e("msie"):this._parse("rv:")?e("rv:"):e("edge/");default:return}}getSupportedVideoFormats(){const e=document.createElement("video");return{ogg:e.canPlayType('video/ogg; codecs="theora"'),h264:e.canPlayType('video/mp4; codecs="avc1.42E01E"'),webm:e.canPlayType('video/webm; codecs="vp8, vorbis"')}}getGPU(){const e=this.context.getExtension("WEBGL_debug_renderer_info"),t=e?this.context.getParameter(e.UNMASKED_RENDERER_WEBGL):"",n=["Intel","NVIDIA","AMD","Adreno","Apple"];for(let e=0;e<n.length;e++){const i=n[e];if(t.indexOf(i)>-1){const e={type:i,model:null,series:null,generation:null,tier:null,revision:null};return e.model=t.replace(/NVIDIA GeForce |AMD Radeon |Apple | OpenGL Engine/g,""),e.series=e.type.match(/NVIDIA|AMD/g)?e.model.split(" ")[1]:e.model,e.series=e.series.replace(/\D/g,""),e.prefix=e.model.split(" ")[0],e.generation=e.series.substring(0,e.series.length-2),e.tier=e.series.slice(-2,-1),e.revision=e.series.slice(-1),"Apple"==e.type&&(e.generation=e.revision,e.tier=null,e.revision=null),e}}}getWebview(){return/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent)}getWebGL(){return{renderer:this.context.getParameter(this.context.RENDERER).toLowerCase(),version:this.context.getParameter(this.context.VERSION).toLowerCase(),glsl:this.context.getParameter(this.context.SHADING_LANGUAGE_VERSION).toLowerCase(),extensions:this.context.getSupportedExtensions()}}_parse(e){Array.isArray(e)||(e=[e]);for(let t=0;t<e.length;t++)if(this.userAgent.match(e[t]))return!0;return!1}_addClasses(){const e=[this.deviceType,this.os,this.browser,`${this.browser}-${this.browserVersion}`];for(let t=0,n=e.length;t<n;t++){const n=e[t];void 0!==n&&0!==n.length&&document.documentElement.classList.add(n.toLowerCase())}this.isWebview&&document.documentElement.classList.add("is-webview");for(const e in i.type)i.type[e]&&document.documentElement.classList.add(e)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));class i{constructor(){}log(e,{color:t="#fff",backgroundColor:n="#444444"}={}){}}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return s}));var i=n(4);class s{constructor(){e(this),this.log=!1,this.map={}}addEventListeners(e){const t=e.querySelectorAll("*[data-tracking]");for(let e=0,n=t.length;e<n;e++)t[e].addEventListener("click",this.event)}removeEventListeners(e){const t=e.querySelectorAll("*[data-tracking]");for(let e=0,n=t.length;e<n;e++)t[e].removeEventListener("click",this.event)}pageview(){const{current:e}=i.a.router.history,t=this.map[""+e]||e;this._log("pageview "+t),"undefined"!=typeof ga&&ga("send","pageview",t)}event(e){const t=e.currentTarget?e.currentTarget.getAttribute("data-tracking"):e,n=t.split(", ");n.length&&this._log("event - "+t),"undefined"!=typeof ga&&ga("send","event",...n)}_log(e){this.log&&i.a.logger.log("Tracker: "+e)}}}).call(this,n(6).default)},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(4);class s{constructor(){}detect(){this._canvas=document.createElement("canvas"),this._context=this._canvas.getContext("experimental-webgl"),this.types={},this.name=this.getOptimal(),delete this._canvas,delete this._context}getOptimal(){if(!i.a.device.gpu)return"Low";switch(i.a.device.gpu.type){case"NVIDIA":return i.a.device.gpu.prefix.match("GTX")||i.a.device.gpu.model.match("GTX")?"High":"Medium";case"AMD":return i.a.device.gpu.prefix.match("RX")||i.a.device.gpu.prefix.replace(/\D+/g,"")>7?"High":"Medium";case"Intel":return"Low";case"Adreno":return i.a.device.gpu.generation>4?"High":"Low";case"Apple":return i.a.device.gpu.generation>9?"High":i.a.device.gpu.generation>7?"Medium":"Low"}}}},,,function(e,t){const n=[{developement:{helpers:{visible:{value:!1,development:!0}},controls:{development:!0,enabled:{value:!1},target:{value:"Scene",options:["Scene","Player"]}}},character:{camera:{value:"Rotate",options:["Rotate","Fixed"]},controls:{value:"Screen",options:["Joystick","Screen"]}},controls:{speed:{value:2,min:0,max:10,step:.1},radius:{value:120,min:0,max:250,step:.1},friction:{value:.1,min:0,max:1,step:.01},height:{value:75,min:0,max:250,step:.1},scrollSpeed:{value:.5,min:0,max:2,step:.1},offsetX:{value:-54,min:-100,max:100,step:.1},offsetZ:{value:-22,min:-100,max:100,step:.1},radiusX:{value:1.15,min:-5,max:5,step:.01},heightX:{value:0,min:-100,max:100,step:.1},center:{x:{value:0,min:-75,max:75,step:.1},y:{value:0,min:-75,max:75,step:.1},z:{value:0,min:-75,max:75,step:.1}}},visibility:{npcs:{value:!0},areas:{value:!0},collectables:{value:!0}},clouds:[{x:{value:150,min:-150,max:150,step:.1},y:{value:36,min:-150,max:150,step:.1},z:{value:125,min:-150,max:150,step:.1}},{x:{value:14,min:-150,max:150,step:.1},y:{value:90,min:-150,max:150,step:.1},z:{value:60,min:-150,max:150,step:.1}},{x:{value:120,min:-150,max:150,step:.1},y:{value:30,min:-150,max:150,step:.1},z:{value:-75,min:-150,max:150,step:.1}},{x:{value:-40,min:-150,max:150,step:.1},y:{value:90,min:-150,max:150,step:.1},z:{value:-80,min:-150,max:150,step:.1}},{x:{value:-60,min:-150,max:150,step:.1},y:{value:35,min:-150,max:150,step:.1},z:{value:95,min:-150,max:150,step:.1}},{x:{value:-130,min:-150,max:150,step:.1},y:{value:80,min:-150,max:150,step:.1},z:{value:-15,min:-150,max:150,step:.1}},{x:{value:95,min:-150,max:150,step:.1},y:{value:100,min:-150,max:150,step:.1},z:{value:30,min:-150,max:150,step:.1}}],renderer:{development:!0,quality:{value:1.5,min:.5,max:2,step:.25},antialias:{value:!1,disabled:!0}},physics:{development:!0,timeScale:{value:1,min:.01,max:2,step:.01,development:!0},gravity:{value:50,min:50,max:100,step:.1}},fog:{development:!0,density:{value:0,min:0,max:.1,step:.001},color:{value:"#000000"}},camera:{development:!0,fov:{value:55,min:10,max:80,step:1,development:!0},near:{value:1,min:.1,max:5,step:.1,development:!0},far:{value:500,min:10,max:1e3,step:10,development:!0}},sky:{topColor:{value:"#6bb78c"},bottomColor:{value:"#5fa2e4"}},lighting:{development:!0,ambientLight:{color:{value:"#ffffff"},intensity:{value:.4,min:0,max:1,step:.001}},hemisphereLight:{development:!0,intensity:{value:.85,min:0,max:1,step:.001},skyColor:{value:"#ffebd6"},groundColor:{value:"#99cfff"}},keyLight:{development:!0,color:{value:"#ffffff"},intensity:{value:.2,min:0,max:1,step:.001},castShadow:{value:!0},shadowMapSize:{value:2048,options:[512,1024,2048,4096],development:!0},position:{x:{value:10,min:-50,max:50,step:.1},y:{value:30,min:-50,max:50,step:.1},z:{value:-10,min:-50,max:50,step:.1}}},rimLight:{enabled:{value:!0},power:{value:1.5,min:0,max:20,step:.1},intensity:{value:.125,min:0,max:1,step:.01}},matCap:{enabled:{value:!0},intensity:{value:.1,min:0,max:1,step:.1}},ambientOcclusion:{enabled:{value:!0},intensity:{value:.5,min:0,max:1,step:.01}}},vignette:{enabled:{value:!0},strength:{value:.1,min:0,max:5,step:.05},color:{value:"#000000"}},postProcessing:{development:!0,enabled:{value:!1},titlShift:{enabled:{value:!0},strength:{value:2.5,min:0,max:5,step:.05},height:{value:.4,min:0,max:5,step:.05}},bloom:{enabled:{value:!1},strength:{value:.35,min:0,max:5,step:.05},radius:{value:.25,min:0,max:5,step:.05},threshold:{value:.99,min:0,max:1,step:.01}}}}];e.exports=n.length<=1?n[0]:n},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return a}));var i=n(4),s=n(0);class a{constructor(){e(this),this.types={},this.gpu=this.getGPU(),this.quality=this.getOptimal(),s.a.addEventListener("ready",this.initialize)}initialize(){}getOptimal(){if(!i.a.device.gpu)return"Low";switch(i.a.device.gpu.type){case"NVIDIA":return i.a.device.gpu.prefix.match("GTX")||i.a.device.gpu.model.match("GTX")?"High":"Medium";case"AMD":return i.a.device.gpu.prefix.match("RX")||i.a.device.gpu.prefix.replace(/\D+/g,"")>7?"High":"Medium";case"Intel":return"Low";case"Adreno":return i.a.device.gpu.generation>4?"High":"Low";case"Apple":return i.a.device.gpu.generation>9?"High":(i.a.device.gpu.generation,"Low")}}getGPU(){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("experimental-webgl");const e=this.context.getExtension("WEBGL_debug_renderer_info"),t=e?this.context.getParameter(e.UNMASKED_RENDERER_WEBGL):"",n=["Intel","NVIDIA","AMD","Adreno","Apple"];for(let e=0;e<n.length;e++){const i=n[e];if(t.indexOf(i)>-1){const e={type:i,model:null,series:null,generation:null,tier:null,revision:null};return e.model=t.replace(/NVIDIA GeForce |AMD Radeon |Apple | OpenGL Engine/g,""),e.series=e.type.match(/NVIDIA|AMD/g)?e.model.split(" ")[1]:e.model,e.series=e.series.replace(/\D/g,""),e.prefix=e.model.split(" ")[0],e.generation=e.series.substring(0,e.series.length-2),e.tier=e.series.slice(-2,-1),e.revision=e.series.slice(-1),"Apple"==e.type&&(e.generation=e.revision,e.tier=null,e.revision=null),e}}}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return s}));var i=n(38);class s extends i.a{constructor(){super(),e(this),this.startTime=0,this.previousTime=0,this.newTime=0,this.deltaTime=0,this.elapsedTime=0,this.started=!1,this.requestID=null,this.animate(),Object.assign(window,{delay:this.delay,clearDelay:this.clearDelay,repeat:this.repeat,clearRepeat:this.clearRepeat})}start(){this.started||(this.started=!0,this.startTime=.001*performance.now(),this.previousTime=this.startTime)}stop(){this.started&&(this.started=!1)}animate(){this.update(),this.requestID=requestAnimationFrame(this.animate)}update(){this.newTime=.001*performance.now(),this.deltaTime=this.newTime-this.previousTime,this.previousTime=this.newTime,this.elapsedTime+=this.deltaTime,this.dispatchEvent({type:"update"})}repeat(e,t){let n=this.elapsedTime;const i=new Object,s=()=>{this.elapsedTime-n>=t&&(e.call(),n=this.elapsedTime),i.requestID=requestAnimationFrame(s)};return i.requestID=requestAnimationFrame(s),i}clearRepeat(e){e&&cancelAnimationFrame(e.requestID)}delay(e,t){const n=this.elapsedTime,i=new Object,s=()=>{this.elapsedTime-n>=t?e.call():i.requestID=requestAnimationFrame(s)};return i.requestID=requestAnimationFrame(s),i}clearDelay(e){e&&cancelAnimationFrame(e.requestID)}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return s}));var i=n(38);class s extends i.a{constructor(){super(),e(this),this.keys={}}isDown(e){return this.keys[e]}_onKeyDown(e){this.keys[e.code]=!0,this.dispatchEvent({type:"keyDown",originalEvent:e,key:e.key,code:e.code})}_onKeyUp(e){delete this.keys[e.code],this.dispatchEvent({type:"keyUp",originalEvent:e,key:e.key,code:e.code})}addEventListeners(){this.hasListeners||(this.hasListeners=!0,addEventListener("keyup",this._onKeyUp),addEventListener("keydown",this._onKeyDown))}removeEventListeners(){this.hasListeners&&(this.hasListeners=!1,removeEventListener("keyup",this._onKeyUp),removeEventListener("keydown",this._onKeyDown))}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return a}));var i=n(3),s=n(38);class a extends s.a{constructor(){super(),e(this),this.buttons=["left",null,"right"],this.enabled=!0,this.currentPosition=new i.a,this.startPosition=new i.a,this.deltaPosition=new i.a,this.normalizedPosition=new i.a,this.normalizedDeltaPosition=new i.a}getPosition(){return this.currentPosition}getDeltaPosition(){return this.deltaPosition.copy(this.currentPosition).sub(this.startPosition),this.deltaPosition}getNormalizedDeltaPosition(e){return this.getDeltaPosition(),this.normalizedDeltaPosition.copy(this.deltaPosition).divide(e)}getNormalizedPosition(e){return this.normalizedPosition.set(Math.mapLinear(this.currentPosition.x,0,e.x,-1,1),Math.mapLinear(this.currentPosition.y,0,e.y,1,-1)),this.normalizedPosition}getDeltaTime(){return.001*performance.now()-this.startTime}reset(){this.startTime=null,this.startPosition.set(0,0),this.deltaPosition.set(0,0);const{innerWidth:e,innerHeight:t}=window;this.currentPosition.set(e,t).multiplyScalar(.5)}addEventListeners(e=document){this.hasListeners||(this.hasListeners=!0,this.node=e,addEventListener("mousedown",this._onDown,!1),addEventListener("mousemove",this._onMove,!1),addEventListener("mouseup",this._onUp,!1),addEventListener("mouseleave",this._onUp,!1),addEventListener("click",this._onClick,!1),addEventListener("dblclick",this._onDoubleClick,!1),addEventListener("contextmenu",this._preventDefault,!1),this.reset())}removeEventListeners(){this.hasListeners&&(this.hasListeners=!1,this.node.removeEventListener("mousedown",this._onDown,!1),this.node.removeEventListener("mousemove",this._onMove,!1),this.node.removeEventListener("mouseup",this._onUp,!1),this.node.removeEventListener("mouseleave",this._onUp,!1),this.node.removeEventListener("click",this._onClick,!1),this.node.removeEventListener("dblclick",this._onDoubleClick,!1))}_onDown(e){this.enabled&&(this.isDown=!0,this.button=this.buttons[e.button],this.startTime=.001*performance.now(),this.startPosition.set(e.clientX,e.clientY),this.currentPosition.set(e.clientX,e.clientY),this.deltaPosition.set(0,0),this.dispatchEvent({type:"down"}))}_onMove(e){this.enabled&&(this.isMoving=!0,this.timeout=setTimeout(()=>this.isMoving=!1,250),this.currentPosition.set(e.clientX,e.clientY),this.dispatchEvent({type:"move"}))}_onUp(){this.enabled&&(this.isDown=!1,this.dispatchEvent({type:"up"}))}_onDoubleClick(){this.dispatchEvent({type:"doubleClick"})}_onClick(){this.dispatchEvent({type:"click"})}_preventDefault(e){e.preventDefault()}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return a}));var i=n(3),s=n(38);class a extends s.a{constructor(){super(),e(this),this.enabled=!0,this.preventDefault=!1,this.reset()}reset(){this.touchList={}}addEventListeners(){this.hasListeners||(this.hasListeners=!0,addEventListener("touchstart",this._onStart,{passive:!1}),addEventListener("touchmove",this._onMove,{passive:!1}),addEventListener("touchend",this._onEnd,{passive:!1}),addEventListener("gesturestart",this._preventDefault,{passive:!1}),addEventListener("gesturestart",this._preventGesture,{passive:!1}))}removeEventListeners(){this.hasListeners&&(this.hasListeners=!1,removeEventListener("touchstart",this._onStart),removeEventListener("touchmove",this._onMove),removeEventListener("touchend",this._onEnd),removeEventListener("gesturestart",this._preventDefault),removeEventListener("gesturestart",this._preventGesture))}getTouch(e){const t=Object.keys(this.touchList);return!!t.length&&this.touchList[t[e]||t.pop()]}getTouches(){return Object.values(this.touchList)}_onStart(e){if(this.enabled){this._preventDefault(e);for(let t=0,n=e.touches.length;t<n;t++){const n=e.touches[t];if(this.touchList[n.identifier])continue;const i=new r;i.startPosition.set(n.clientX,n.clientY),i.currentPosition.set(n.clientX,n.clientY),i.deltaPosition.set(0,0),this.touchList[n.identifier]=i}this.isActive=!0,this.dispatchEvent({type:"touchStart"})}}_onMove(e){if(this.enabled){this._preventDefault(e);for(let t=0,n=e.touches.length;t<n;t++){const n=e.touches[t],i=this.touchList[n.identifier];i.dispatchEvent({type:"touchMove"}),i.currentPosition.set(n.clientX,n.clientY)}this.dispatchEvent({type:"touchMove",touches:e.touches})}}_onEnd(e){this._preventDefault(e);for(let t=0,n=e.changedTouches.length;t<n;t++){const n=e.changedTouches[t];this.touchList[n.identifier].dispatchEvent({type:"touchEnd"}),delete this.touchList[n.identifier]}this.isActive=!!this.touchList.length,this.dispatchEvent({type:"touchEnd",touches:e.touches})}_preventDefault(e){"CANVAS"===e.target.tagName&&e.preventDefault()}_preventGesture(e){e.preventDefault()}}class r extends s.a{constructor(){super(),this.isTouch=!0,this.startPosition=new i.a,this.currentPosition=new i.a,this.deltaPosition=new i.a,this.startTime=.001*performance.now(),this.normalizedPosition=new i.a,this.normalizedDeltaPosition=new i.a}getPosition(){return this.currentPosition}getDeltaPosition(){return this.deltaPosition.copy(this.currentPosition).sub(this.startPosition),this.deltaPosition}getNormalizedDeltaPosition(e){return this.getDeltaPosition(),this.normalizedDeltaPosition.copy(this.deltaPosition).divide(e).multiplyScalar(2),this.normalizedDeltaPosition}getNormalizedPosition(e){return this.normalizedPosition.set(Math.mapLinear(this.currentPosition.x,0,e.x,-1,1),Math.mapLinear(this.currentPosition.y,0,e.y,1,-1)),this.normalizedPosition}getDeltaTime(){return.001*performance.now()-this.startTime}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return a}));var i=n(3),s=n(38);class a extends s.a{constructor(){super(),e(this),this.preventWheel=!1,this.preventScroll=!1,this.wheelDelta=new i.a}addEventListeners(){this.hasListeners||(this.hasListeners=!0,addEventListener("mousewheel",this._onWheel,{passive:!1}),addEventListener("touchmove",this._preventScroll,{passive:!1}))}removeEventListeners(){this.hasListeners&&(this.hasListeners=!1,removeEventListener("mousewheel",this._onWheel,{passive:!1}),removeEventListener("touchmove",this._preventScroll,{passive:!1}))}_preventScroll(e){this.preventScroll&&e.preventDefault()}_onWheel(e){this.preventWheel&&(e.preventDefault(),e.stopPropagation()),this.wheelDelta.set(e.deltaX,e.deltaY),this.dispatchEvent({type:"wheel",wheelDelta:this.wheelDelta})}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return a}));var i=n(0),s=n(38);class a{constructor(){e(this),this.initial=JSON.parse(JSON.stringify(i.a.settings)),this.traverse(i.a.settings,(e,t)=>{const n=e[t],i=new s.a;n._value=n.value,n._initial=n.value,e[t]=Object.assign(i,n)}),i.a.addEventListener("beforePhysics",this.update)}reset(){this.traverse(i.a.settings,(e,t)=>{const n=e[t];n.value=n._initial})}export(){const e=JSON.parse(JSON.stringify(i.a.settings));return this.traverse(e,(e,t)=>{const n=e[t];delete n._value,delete n.listeners,delete n._initial,delete n._gsap}),e}traverse(e,t){for(const n in e){const i=e[n];void 0!==i.value?t(e,n):this.traverse(i,t)}}update(){this.traverse(i.a.settings,(e,t)=>{const n=e[t];n._value!==n.value&&(n._value=n.value,n.dispatchEvent({type:"change"}))})}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o}));var i=n(3),s=n(0),a=n(38),r=n(4);class o extends a.a{constructor(){super(),e(this),this.size=new i.a,this.beforeUpdate(),s.a.addEventListener("ready",this.initialize),s.a.addEventListener("beforeUpdate",this.beforeUpdate)}initialize(){}beforeUpdate(){const e=void 0!==this.width;let t=this.width&&this.width!==window.innerWidth||this.height&&this.height!==window.innerHeight;"device-desktop"!==r.a.device.deviceType&&(t=this.width!==window.innerWidth),this.width=window.innerWidth,this.height=window.innerHeight,this.size.set(this.width,this.height),this.aspect=this.width/this.height,this.devicePixelRatio=window.devicePixelRatio||1,this.orientation=this.aspect>1?"landscape":"portrait",t&&(this.dispatchEvent({type:"resize"}),e&&(document.body.classList.add("resizing"),clearTimeout(this.timeout),this.timeout=setTimeout(()=>document.body.classList.remove("resizing"),750)))}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return s}));var i=n(156);class s{constructor(){e(this),this.objects={},this.animations={},this.geometries={},this.materials={},this.textures={},this.svgs={},this.data={},this.audioBuffers={},this.parser=new i.a}register(e){if(!this.registered)return this.registered=!0,new Promise(t=>{this.parser.preload().then(()=>{const n=[];for(const t in e){const i=this.add(t,e[t]);i&&n.push(i)}return Promise.all(n).then(t)})})}add(e,t){if(e.match(/(json)/g))this.data[e]=t;else{if(e.match(/(m4a)/g))return this.audioBuffers[e]=t;if(e.match(/(svg)/g))return this.svgs[e]=t.node;if(e.match(/(jpg|png)/g))return this.parser.getTexture(t).then(t=>this.textures[e]=t);if(e.match(/(basis)/g))return this.parser.getBasis(t).then(t=>this.textures[e]=t);if(e.match(/glb/g)){const n=e.split("/").pop()+"/";return this.parser.getModels(t,n).then(({objects:e,geometries:t,animations:n})=>{Object.assign(this.objects,e),Object.assign(this.geometries,t),Object.assign(this.animations,n)})}}}clone(e,t){const n={lookup:new Map,clone:new Map};return t.copy(e.clone()),function e(t,n,i){i(t,n);for(let s=0;s<t.children.length;s++)e(t.children[s],n.children[s],i)}(e,t,(e,t)=>{n.lookup.set(t,e),n.clone.set(e,t)}),t.traverse((function(e){if(!e.isSkinnedMesh)return;const t=e,i=n.lookup.get(e),s=i.skeleton.bones;t.skeleton=i.skeleton.clone(),t.bindMatrix.copy(i.bindMatrix),t.skeleton.bones=s.map(e=>n.clone.get(e)),t.bind(t.skeleton,t.bindMatrix)})),t}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){var i=n(30),s=n(1),a=n(157),r=n(158);const o=window.webkitAudioContext||window.AudioContext;t.a=class{constructor(){e(this),this.DOMParser=document.createElement("div"),this.GLTFloader=new a.a,this.DRACOLoader=new r.a,this.DRACOLoader.setDecoderPath(config.paths.assets+"/static/canvas/draco/"),this.GLTFloader.setDRACOLoader(this.DRACOLoader)}preload(){return this.DRACOLoader._initDecoder()}getURI(e){const t=new Blob([e]);return URL.createObjectURL(t)}getJSON(e){return new Promise(t=>{this.getString(e).then(e=>{t(JSON.parse(e))})})}getString(e){return new Promise(t=>{let n="";const i=new Uint8Array(e);for(const e of Array.from(i))n+=String.fromCharCode(e);t(n)})}getAudioBuffer(e){return this.audioContext||(this.audioContext=new o),new Promise(t=>{this.audioContext.decodeAudioData(e,e=>{t(e)})})}getImage(e){return new Promise(t=>{const n=new Image;n.onload=()=>t(n),n.src=this.getURI(e)})}getSVG(e){return new Promise(t=>{const n=e=>{this.DOMParser.innerHTML=e,t(this.DOMParser.querySelector("svg"))};"string"==typeof e?n(e):this.getString(e).then(n)})}getTexture(e){return new Promise(t=>{const n=new i.a(e.node);Object.assign(n,{minFilter:s.W,magFilter:s.V,generateMipmaps:!0,needsUpdate:!0,flipY:!1}),t(n)})}getBasis(e){return new Promise(t=>{this.basisLoader._createTexture(e,"").then(e=>t(e)).catch(e=>{})})}getModels(e,t=""){const n=[],i=[],s=[];return new Promise(a=>{this.GLTFloader.parse(e,"",e=>a((e=>{e.scene.traverse(e=>{n[t+e.name]=e,e.geometry&&(i[t+e.name]=e.geometry)});for(let n=0,i=e.animations.length;n<i;n++){const i=e.animations[n];s[t+i.name]=i}return{objects:n,geometries:i,animations:s}})(e)))})}}}).call(this,n(6).default)},function(e,t,n){"use strict";var i=n(25),s=n(70),a=n(55),r=n(8),o=n(133),l=n(306),c=n(307),h=n(10),d=n(33),u=n(46),p=n(24),m=n(19),f=n(45),g=n(1),v=n(35),y=n(123),b=n(68),_=n(83),x=n(5),w=n(69),S=n(20),L=n(37),T=n(303),E=n(3),A=n(26),M=n(2),C=n(40),D=n(15),P=n(127),I=n(18),k=n(42),R=n(58),z=n(296),O=n(113),U=n(73),F=n(27),N=n(112),B=n(84),H=n(120),j=n(85),G=n(119),V=n(297),W=n(7),q=n(129),Y=n(17),X=n(126),K=n(72);const Z=function(){function e(e){i.a.call(this,e),this.dracoLoader=null,this.ddsLoader=null}function t(){let e={};return{get:function(t){return e[t]},add:function(t,n){e[t]=n},remove:function(t){delete e[t]},removeAll:function(){e={}}}}e.prototype=Object.assign(Object.create(i.a.prototype),{constructor:e,load:function(e,t,n,i){const r=this;let o;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:s.a.extractUrlBase(e),r.manager.itemStart(e);const l=function(t){i&&i(t),r.manager.itemError(e),r.manager.itemEnd(e)},c=new a.a(r.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),"use-credentials"===r.crossOrigin&&c.setWithCredentials(!0),c.load(e,(function(n){try{r.parse(n,o,(function(n){t(n),r.manager.itemEnd(e)}),l)}catch(e){l(e)}}),n,l)},setDRACOLoader:function(e){return this.dracoLoader=e,this},setDDSLoader:function(e){return this.ddsLoader=e,this},parse:function(e,t,i,a){let r;const o={};if("string"==typeof e)r=e;else{if(s.a.decodeText(new Uint8Array(e,0,4))===J){try{o[n.KHR_BINARY_GLTF]=new ne(e)}catch(e){return void(a&&a(e))}r=o[n.KHR_BINARY_GLTF].content}else r=s.a.decodeText(new Uint8Array(e))}const l=JSON.parse(r);if(void 0===l.asset||l.asset.version[0]<2)return void(a&&a(new Error("GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));if(l.extensionsUsed)for(let e=0;e<l.extensionsUsed.length;++e){const t=l.extensionsUsed[e],i=l.extensionsRequired||[];switch(t){case n.KHR_LIGHTS_PUNCTUAL:o[t]=new $(l);break;case n.KHR_MATERIALS_UNLIT:o[t]=new Q;break;case n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:o[t]=new ae;break;case n.KHR_DRACO_MESH_COMPRESSION:o[t]=new ie(l,this.dracoLoader);break;case n.MSFT_TEXTURE_DDS:o[t]=new Z(this.ddsLoader);break;case n.KHR_TEXTURE_TRANSFORM:o[t]=new se;break;case n.KHR_MESH_QUANTIZATION:o[t]=new re;break;default:i.indexOf(t)}}new Ie(l,o,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager}).parse(i,a)}});var n={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function Z(e){if(!e)throw new Error("GLTFLoader: Attempting to load .dds texture without importing DDSLoader");this.name=n.MSFT_TEXTURE_DDS,this.ddsLoader=e}function $(e){this.name=n.KHR_LIGHTS_PUNCTUAL;const t=e.extensions&&e.extensions[n.KHR_LIGHTS_PUNCTUAL]||{};this.lightDefs=t.lights||[]}function Q(){this.name=n.KHR_MATERIALS_UNLIT}$.prototype.loadLight=function(e){const t=this.lightDefs[e];let n;const i=new r.a(16777215);void 0!==t.color&&i.fromArray(t.color);const s=void 0!==t.range?t.range:0;switch(t.type){case"directional":n=new o.a(i),n.target.position.set(0,0,-1),n.add(n.target);break;case"point":n=new l.a(i),n.distance=s;break;case"spot":n=new c.a(i),n.distance=s,t.spot=t.spot||{},t.spot.innerConeAngle=void 0!==t.spot.innerConeAngle?t.spot.innerConeAngle:0,t.spot.outerConeAngle=void 0!==t.spot.outerConeAngle?t.spot.outerConeAngle:h.a.PI/4,n.angle=t.spot.outerConeAngle,n.penumbra=1-t.spot.innerConeAngle/t.spot.outerConeAngle,n.target.position.set(0,0,-1),n.add(n.target);break;default:throw new Error('GLTFLoader: Unexpected light type, "'+t.type+'".')}return n.position.set(0,0,0),n.decay=2,void 0!==t.intensity&&(n.intensity=t.intensity),n.name=t.name||"light_"+e,Promise.resolve(n)},Q.prototype.getMaterialType=function(){return d.a},Q.prototype.extendParams=function(e,t,n){const i=[];e.color=new r.a(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const t=s.baseColorFactor;e.color.fromArray(t),e.opacity=t[3]}void 0!==s.baseColorTexture&&i.push(n.assignTexture(e,"map",s.baseColorTexture))}return Promise.all(i)};var J="glTF";const ee=1313821514,te=5130562;function ne(e){this.name=n.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12);if(this.header={magic:s.a.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==J)throw new Error("GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("GLTFLoader: Legacy binary file detected.");const i=new DataView(e,12);let a=0;for(;a<i.byteLength;){const t=i.getUint32(a,!0);a+=4;const n=i.getUint32(a,!0);if(a+=4,n===ee){const n=new Uint8Array(e,12+a,t);this.content=s.a.decodeText(n)}else if(n===te){const n=12+a;this.body=e.slice(n,n+t)}a+=t}if(null===this.content)throw new Error("GLTFLoader: JSON content not found.")}function ie(e,t){if(!t)throw new Error("GLTFLoader: No DRACOLoader instance provided.");this.name=n.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}function se(){this.name=n.KHR_TEXTURE_TRANSFORM}function ae(){return{name:n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return u.a},extendParams:function(e,t,n){const i=t.extensions[this.name],s=p.a.standard,a=m.a.clone(s.uniforms),o=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),l=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),c=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),h=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),d=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),u=s.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",o).replace("#include <metalnessmap_pars_fragment>",l).replace("#include <roughnessmap_fragment>",c).replace("#include <metalnessmap_fragment>",h).replace("#include <lights_physical_fragment>",d);delete a.roughness,delete a.metalness,delete a.roughnessMap,delete a.metalnessMap,a.specular={value:(new r.a).setHex(1118481)},a.glossiness={value:.5},a.specularMap={value:null},a.glossinessMap={value:null},e.vertexShader=s.vertexShader,e.fragmentShader=u,e.uniforms=a,e.defines={STANDARD:""},e.color=new r.a(1,1,1),e.opacity=1;const f=[];if(Array.isArray(i.diffuseFactor)){const t=i.diffuseFactor;e.color.fromArray(t),e.opacity=t[3]}if(void 0!==i.diffuseTexture&&f.push(n.assignTexture(e,"map",i.diffuseTexture)),e.emissive=new r.a(0,0,0),e.glossiness=void 0!==i.glossinessFactor?i.glossinessFactor:1,e.specular=new r.a(1,1,1),Array.isArray(i.specularFactor)&&e.specular.fromArray(i.specularFactor),void 0!==i.specularGlossinessTexture){const t=i.specularGlossinessTexture;f.push(n.assignTexture(e,"glossinessMap",t)),f.push(n.assignTexture(e,"specularMap",t))}return Promise.all(f)},createMaterial:function(e){const t=new u.a({defines:e.defines,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,fog:!0,lights:!0,opacity:e.opacity,transparent:e.transparent});return t.isGLTFSpecularGlossinessMaterial=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t.extensions.derivatives=!0,t},cloneMaterial:function(e){const t=e.clone();t.isGLTFSpecularGlossinessMaterial=!0;const n=this.specularGlossinessParams;for(let i=0,s=n.length;i<s;i++){const s=e[n[i]];t[n[i]]=s&&s.isColor?s.clone():s}return t},refreshUniforms:function(e,t,n,i,s){if(!0!==s.isGLTFSpecularGlossinessMaterial)return;const a=s.uniforms,r=s.defines;let o;a.opacity.value=s.opacity,a.diffuse.value.copy(s.color),a.emissive.value.copy(s.emissive).multiplyScalar(s.emissiveIntensity),a.map.value=s.map,a.specularMap.value=s.specularMap,a.alphaMap.value=s.alphaMap,a.lightMap.value=s.lightMap,a.lightMapIntensity.value=s.lightMapIntensity,a.aoMap.value=s.aoMap,a.aoMapIntensity.value=s.aoMapIntensity,s.map?o=s.map:s.specularMap?o=s.specularMap:s.displacementMap?o=s.displacementMap:s.normalMap?o=s.normalMap:s.bumpMap?o=s.bumpMap:s.glossinessMap?o=s.glossinessMap:s.alphaMap?o=s.alphaMap:s.emissiveMap&&(o=s.emissiveMap),void 0!==o&&(o.isWebGLRenderTarget&&(o=o.texture),!0===o.matrixAutoUpdate&&o.updateMatrix(),a.uvTransform.value.copy(o.matrix)),s.envMap&&(a.envMap.value=s.envMap,a.envMapIntensity.value=s.envMapIntensity,a.flipEnvMap.value=s.envMap.isCubeTexture?-1:1,a.reflectivity.value=s.reflectivity,a.refractionRatio.value=s.refractionRatio,a.maxMipLevel.value=e.properties.get(s.envMap).__maxMipLevel),a.specular.value.copy(s.specular),a.glossiness.value=s.glossiness,a.glossinessMap.value=s.glossinessMap,a.emissiveMap.value=s.emissiveMap,a.bumpMap.value=s.bumpMap,a.normalMap.value=s.normalMap,a.displacementMap.value=s.displacementMap,a.displacementScale.value=s.displacementScale,a.displacementBias.value=s.displacementBias,null!==a.glossinessMap.value&&void 0===r.USE_GLOSSINESSMAP&&(r.USE_GLOSSINESSMAP="",r.USE_ROUGHNESSMAP=""),null===a.glossinessMap.value&&void 0!==r.USE_GLOSSINESSMAP&&(delete r.USE_GLOSSINESSMAP,delete r.USE_ROUGHNESSMAP)}}}function re(){this.name=n.KHR_MESH_QUANTIZATION}function oe(e,t,n,i){f.a.call(this,e,t,n,i)}ie.prototype.decodePrimitive=function(e,t){const n=this.json,i=this.dracoLoader,s=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,r={},o={},l={};for(var c in a){var h=be[c]||c.toLowerCase();r[h]=a[c]}for(c in e.attributes){h=be[c]||c.toLowerCase();if(void 0!==a[c]){const t=n.accessors[e.attributes[c]],i=fe[t.componentType];l[h]=i,o[h]=!0===t.normalized}}return t.getDependency("bufferView",s).then((function(e){return new Promise((function(t){i.decodeDracoFile(e,(function(e){for(const t in e.attributes){const n=e.attributes[t],i=o[t];void 0!==i&&(n.normalized=i)}t(e)}),r,l)}))}))},se.prototype.extendTexture=function(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),t.texCoord,e.needsUpdate=!0,e},oe.prototype=Object.create(f.a.prototype),oe.prototype.constructor=oe,oe.prototype.copySampleValue_=function(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,s=e*i*3+i;for(let e=0;e!==i;e++)t[e]=n[s+e];return t},oe.prototype.beforeStart_=oe.prototype.copySampleValue_,oe.prototype.afterEnd_=oe.prototype.copySampleValue_,oe.prototype.interpolate_=function(e,t,n,i){const s=this.resultBuffer,a=this.sampleValues,r=this.valueSize,o=2*r,l=3*r,c=i-t,h=(n-t)/c,d=h*h,u=d*h,p=e*l,m=p-l,f=-2*u+3*d,g=u-d,v=1-f,y=g-d+h;for(let e=0;e!==r;e++){const t=a[m+e+r],n=a[m+e+o]*c,i=a[p+e+r],l=a[p+e]*c;s[e]=v*t+y*n+f*i+g*l}return s};const le=0,ce=1,he=2,de=3,ue=4,pe=5,me=6;var fe={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};const ge={9728:g.nb,9729:g.V,9984:g.pb,9985:g.Y,9986:g.ob,9987:g.X},ve={33071:g.m,33648:g.jb,10497:g.sc},ye={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};var be={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"};const _e={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},xe={CUBICSPLINE:void 0,LINEAR:g.P,STEP:g.O},we="OPAQUE",Se="MASK",Le="BLEND",Te={"image/png":g.Fb,"image/jpeg":g.ec};function Ee(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}function Ae(e,t,n){for(const i in n.extensions)void 0===e[i]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[i]=n.extensions[i])}function Me(e,t){void 0!==t.extras&&"object"==typeof t.extras&&Object.assign(e.userData,t.extras)}function Ce(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var n=0,i=t.weights.length;n<i;n++)e.morphTargetInfluences[n]=t.weights[n];if(t.extras&&Array.isArray(t.extras.targetNames)){const s=t.extras.targetNames;if(e.morphTargetInfluences.length===s.length){e.morphTargetDictionary={};for(n=0,i=s.length;n<i;n++)e.morphTargetDictionary[s[n]]=n}}}function De(e){const t=e.extensions&&e.extensions[n.KHR_DRACO_MESH_COMPRESSION];let i;return i=t?"draco:"+t.bufferView+":"+t.indices+":"+Pe(t.attributes):e.indices+":"+Pe(e.attributes)+":"+e.mode,i}function Pe(e){let t="";const n=Object.keys(e).sort();for(let i=0,s=n.length;i<s;i++)t+=n[i]+":"+e[n[i]]+";";return t}function Ie(e,n,i){this.json=e||{},this.extensions=n||{},this.options=i||{},this.cache=new t,this.primitiveCache={},this.textureLoader=new y.a(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new a.a(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}function ke(e,t,n){const i=t.attributes,s=[];function a(t,i){return n.getDependency("accessor",t).then((function(t){e.setAttribute(i,t)}))}for(const t in i){const n=be[t]||t.toLowerCase();n in e.attributes||s.push(a(i[t],n))}if(void 0!==t.indices&&!e.index){const i=n.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));s.push(i)}return Me(e,t),function(e,t,n){const i=t.attributes,s=new A.a;if(void 0===i.POSITION)return;var a=(l=n.json.accessors[i.POSITION]).min,r=l.max;if(void 0===a||void 0===r)return;s.set(new M.a(a[0],a[1],a[2]),new M.a(r[0],r[1],r[2]));const o=t.targets;if(void 0!==o){const e=new M.a;for(let t=0,i=o.length;t<i;t++){const i=o[t];if(void 0!==i.POSITION){var l;a=(l=n.json.accessors[i.POSITION]).min,r=l.max;void 0!==a&&void 0!==r&&(e.setX(h.a.max(h.a.abs(a[0]),h.a.abs(r[0]))),e.setY(h.a.max(h.a.abs(a[1]),h.a.abs(r[1]))),e.setZ(h.a.max(h.a.abs(a[2]),h.a.abs(r[2]))),s.expandByVector(e))}}}e.boundingBox=s;const c=new C.a;s.getCenter(c.center),c.radius=s.min.distanceTo(s.max)/2,e.boundingSphere=c}(e,t,n),Promise.all(s).then((function(){return void 0!==t.targets?function(e,t,n){let i=!1,s=!1;for(var a=0,r=t.length;a<r;a++){if(void 0!==(c=t[a]).POSITION&&(i=!0),void 0!==c.NORMAL&&(s=!0),i&&s)break}if(!i&&!s)return Promise.resolve(e);const o=[],l=[];for(a=0,r=t.length;a<r;a++){var c=t[a];if(i){var h=void 0!==c.POSITION?n.getDependency("accessor",c.POSITION):e.attributes.position;o.push(h)}if(s){h=void 0!==c.NORMAL?n.getDependency("accessor",c.NORMAL):e.attributes.normal;l.push(h)}}return Promise.all([Promise.all(o),Promise.all(l)]).then((function(t){const n=t[0],a=t[1];return i&&(e.morphAttributes.position=n),s&&(e.morphAttributes.normal=a),e.morphTargetsRelative=!0,e}))}(e,t.targets,n):e}))}function Re(e,t){let n=e.getIndex();if(null===n){const t=[],s=e.getAttribute("position");if(void 0===s)return e;for(var i=0;i<s.count;i++)t.push(i);e.setIndex(t),n=e.getIndex()}const s=n.count-2,a=[];if(t===g.Rc)for(i=1;i<=s;i++)a.push(n.getX(0)),a.push(n.getX(i)),a.push(n.getX(i+1));else for(i=0;i<s;i++)i%2==0?(a.push(n.getX(i)),a.push(n.getX(i+1)),a.push(n.getX(i+2))):(a.push(n.getX(i+2)),a.push(n.getX(i+1)),a.push(n.getX(i)));a.length;const r=e.clone();return r.setIndex(a),r}return Ie.prototype.parse=function(e,t){const n=this,i=this.json,s=this.extensions;this.cache.removeAll(),this.markDefs(),Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then((function(t){const a={scene:t[0][i.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:i.asset,parser:n,userData:{}};Ae(s,a,i),Me(a,i),e(a)})).catch(t)},Ie.prototype.markDefs=function(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[],i={},s={};for(let n=0,i=t.length;n<i;n++){const i=t[n].joints;for(let t=0,n=i.length;t<n;t++)e[i[t]].isBone=!0}for(let t=0,a=e.length;t<a;t++){const a=e[t];void 0!==a.mesh&&(void 0===i[a.mesh]&&(i[a.mesh]=s[a.mesh]=0),i[a.mesh]++,void 0!==a.skin&&(n[a.mesh].isSkinnedMesh=!0))}this.json.meshReferences=i,this.json.meshUses=s},Ie.prototype.getDependency=function(e,t){const i=e+":"+t;let s=this.cache.get(i);if(!s){switch(e){case"scene":s=this.loadScene(t);break;case"node":s=this.loadNode(t);break;case"mesh":s=this.loadMesh(t);break;case"accessor":s=this.loadAccessor(t);break;case"bufferView":s=this.loadBufferView(t);break;case"buffer":s=this.loadBuffer(t);break;case"material":s=this.loadMaterial(t);break;case"texture":s=this.loadTexture(t);break;case"skin":s=this.loadSkin(t);break;case"animation":s=this.loadAnimation(t);break;case"camera":s=this.loadCamera(t);break;case"light":s=this.extensions[n.KHR_LIGHTS_PUNCTUAL].loadLight(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(i,s)}return s},Ie.prototype.getDependencies=function(e){let t=this.cache.get(e);if(!t){const n=this,i=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(i.map((function(t,i){return n.getDependency(e,i)}))),this.cache.add(e,t)}return t},Ie.prototype.loadBuffer=function(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[n.KHR_BINARY_GLTF].body);const s=this.options;return new Promise((function(e,n){i.load(Ee(t.uri,s.path),e,void 0,(function(){n(new Error('GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))},Ie.prototype.loadBufferView=function(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){const n=t.byteLength||0,i=t.byteOffset||0;return e.slice(i,i+n)}))},Ie.prototype.loadAccessor=function(e){const t=this,n=this.json,i=this.json.accessors[e];if(void 0===i.bufferView&&void 0===i.sparse)return Promise.resolve(null);const s=[];return void 0!==i.bufferView?s.push(this.getDependency("bufferView",i.bufferView)):s.push(null),void 0!==i.sparse&&(s.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(s).then((function(e){const s=e[0],a=ye[i.type],r=fe[i.componentType],o=r.BYTES_PER_ELEMENT,l=o*a,c=i.byteOffset||0,d=void 0!==i.bufferView?n.bufferViews[i.bufferView].byteStride:void 0,u=!0===i.normalized;let p,m;if(d&&d!==l){const e=h.a.floor(c/d),n="InterleavedBuffer:"+i.bufferView+":"+i.componentType+":"+e+":"+i.count;let l=t.cache.get(n);l||(p=new r(s,e*d,i.count*d/o),l=new b.a(p,d/o),t.cache.add(n,l)),m=new _.a(l,a,c%d/o,u)}else p=null===s?new r(i.count*a):new r(s,c,i.count*a),m=new x.a(p,a,u);if(void 0!==i.sparse){const t=ye.SCALAR,n=fe[i.sparse.indices.componentType],o=i.sparse.indices.byteOffset||0,l=i.sparse.values.byteOffset||0,c=new n(e[1],o,i.sparse.count*t),h=new r(e[2],l,i.sparse.count*a);null!==s&&(m=new x.a(m.array.slice(),m.itemSize,m.normalized));for(let e=0,t=c.length;e<t;e++){const t=c[e];if(m.setX(t,h[e*a]),a>=2&&m.setY(t,h[e*a+1]),a>=3&&m.setZ(t,h[e*a+2]),a>=4&&m.setW(t,h[e*a+3]),a>=5)throw new Error("GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return m}))},Ie.prototype.loadTexture=function(e){const t=this,i=this.json,s=this.options,a=this.textureLoader,r=window.URL||window.webkitURL,o=i.textures[e],l=o.extensions||{};let c;c=l[n.MSFT_TEXTURE_DDS]?i.images[l[n.MSFT_TEXTURE_DDS].source]:i.images[o.source];let h=c.uri,d=!1;return void 0!==c.bufferView&&(h=t.getDependency("bufferView",c.bufferView).then((function(e){d=!0;const t=new Blob([e],{type:c.mimeType});return h=r.createObjectURL(t),h}))),Promise.resolve(h).then((function(e){let i=s.manager.getHandler(e);return i||(i=l[n.MSFT_TEXTURE_DDS]?t.extensions[n.MSFT_TEXTURE_DDS].ddsLoader:a),new Promise((function(t,n){i.load(Ee(e,s.path),t,void 0,n)}))})).then((function(e){!0===d&&r.revokeObjectURL(h),e.flipY=!1,void 0!==o.name&&(e.name=o.name),c.mimeType in Te&&(e.format=Te[c.mimeType]);const t=(i.samplers||{})[o.sampler]||{};return e.magFilter=ge[t.magFilter]||g.V,e.minFilter=ge[t.minFilter]||g.X,e.wrapS=ve[t.wrapS]||g.sc,e.wrapT=ve[t.wrapT]||g.sc,e}))},Ie.prototype.assignTexture=function(e,t,i){const s=this;return this.getDependency("texture",i.index).then((function(a){if(!a.isCompressedTexture)switch(t){case"aoMap":case"emissiveMap":case"metalnessMap":case"normalMap":case"roughnessMap":a.format=g.ec}if(void 0!==i.texCoord&&0!=i.texCoord&&("aoMap"!==t||i.texCoord),s.extensions[n.KHR_TEXTURE_TRANSFORM]){const e=void 0!==i.extensions?i.extensions[n.KHR_TEXTURE_TRANSFORM]:void 0;e&&(a=s.extensions[n.KHR_TEXTURE_TRANSFORM].extendTexture(a,e))}e[t]=a}))},Ie.prototype.assignFinalMaterial=function(e){const t=e.geometry;let i=e.material;const s=this.extensions,a=void 0!==t.attributes.tangent,r=void 0!==t.attributes.color,o=void 0===t.attributes.normal,l=!0===e.isSkinnedMesh,c=Object.keys(t.morphAttributes).length>0,h=c&&void 0!==t.morphAttributes.normal;if(e.isPoints){var d="PointsMaterial:"+i.uuid;let e=this.cache.get(d);e||(e=new w.a,S.a.prototype.copy.call(e,i),e.color.copy(i.color),e.map=i.map,e.sizeAttenuation=!1,this.cache.add(d,e)),i=e}else if(e.isLine){d="LineBasicMaterial:"+i.uuid;let e=this.cache.get(d);e||(e=new L.a,S.a.prototype.copy.call(e,i),e.color.copy(i.color),this.cache.add(d,e)),i=e}if(a||r||o||l||c){d="ClonedMaterial:"+i.uuid+":";i.isGLTFSpecularGlossinessMaterial&&(d+="specular-glossiness:"),l&&(d+="skinning:"),a&&(d+="vertex-tangents:"),r&&(d+="vertex-colors:"),o&&(d+="flat-shading:"),c&&(d+="morph-targets:"),h&&(d+="morph-normals:");let e=this.cache.get(d);e||(e=i.isGLTFSpecularGlossinessMaterial?s[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].cloneMaterial(i):i.clone(),l&&(e.skinning=!0),a&&(e.vertexTangents=!0),r&&(e.vertexColors=T.a),o&&(e.flatShading=!0),c&&(e.morphTargets=!0),h&&(e.morphNormals=!0),this.cache.add(d,e)),i=e}i.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",new x.a(t.attributes.uv.array,2)),i.isGLTFSpecularGlossinessMaterial&&(e.onBeforeRender=s[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].refreshUniforms),i.normalScale&&!a&&(i.normalScale.y=-i.normalScale.y),e.material=i},Ie.prototype.loadMaterial=function(e){const t=this,i=this.json,s=this.extensions,a=i.materials[e];let o;const l={},c=a.extensions||{},h=[];if(c[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){const e=s[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];o=e.getMaterialType(),h.push(e.extendParams(l,a,t))}else if(c[n.KHR_MATERIALS_UNLIT]){const e=s[n.KHR_MATERIALS_UNLIT];o=e.getMaterialType(),h.push(e.extendParams(l,a,t))}else{o=v.a;const e=a.pbrMetallicRoughness||{};if(l.color=new r.a(1,1,1),l.opacity=1,Array.isArray(e.baseColorFactor)){const t=e.baseColorFactor;l.color.fromArray(t),l.opacity=t[3]}void 0!==e.baseColorTexture&&h.push(t.assignTexture(l,"map",e.baseColorTexture)),l.metalness=void 0!==e.metallicFactor?e.metallicFactor:1,l.roughness=void 0!==e.roughnessFactor?e.roughnessFactor:1,void 0!==e.metallicRoughnessTexture&&(h.push(t.assignTexture(l,"metalnessMap",e.metallicRoughnessTexture)),h.push(t.assignTexture(l,"roughnessMap",e.metallicRoughnessTexture)))}!0===a.doubleSided&&(l.side=g.y);const p=a.alphaMode||we;return p===Le?l.transparent=!0:(l.transparent=!1,p===Se&&(l.alphaTest=void 0!==a.alphaCutoff?a.alphaCutoff:.5)),void 0!==a.normalTexture&&o!==d.a&&(h.push(t.assignTexture(l,"normalMap",a.normalTexture)),l.normalScale=new E.a(1,1),void 0!==a.normalTexture.scale&&l.normalScale.set(a.normalTexture.scale,a.normalTexture.scale)),void 0!==a.occlusionTexture&&o!==d.a&&(h.push(t.assignTexture(l,"aoMap",a.occlusionTexture)),void 0!==a.occlusionTexture.strength&&(l.aoMapIntensity=a.occlusionTexture.strength)),void 0!==a.emissiveFactor&&o!==d.a&&(l.emissive=(new r.a).fromArray(a.emissiveFactor)),void 0!==a.emissiveTexture&&o!==d.a&&h.push(t.assignTexture(l,"emissiveMap",a.emissiveTexture)),Promise.all(h).then((function(){let e;return e=o===u.a?s[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(l):new o(l),void 0!==a.name&&(e.name=a.name),e.map&&(e.map.encoding=g.hd),e.emissiveMap&&(e.emissiveMap.encoding=g.hd),e.specularMap&&(e.specularMap.encoding=g.hd),Me(e,a),a.extensions&&Ae(s,e,a),e}))},Ie.prototype.loadGeometries=function(e){const t=this,i=this.extensions,s=this.primitiveCache;function a(e){return i[n.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(n){return ke(n,e,t)}))}const r=[];for(let i=0,l=e.length;i<l;i++){const l=e[i],c=De(l),h=s[c];var o;if(h)r.push(h.promise);else o=l.extensions&&l.extensions[n.KHR_DRACO_MESH_COMPRESSION]?a(l):ke(new D.a,l,t),s[c]={primitive:l,promise:o},r.push(o)}return Promise.all(r)},Ie.prototype.loadMesh=function(e){const t=this,n=this.json.meshes[e],i=n.primitives,s=[];for(let e=0,t=i.length;e<t;e++){const t=void 0===i[e].material?(void 0===(a=this.cache).DefaultMaterial&&(a.DefaultMaterial=new v.a({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:g.H})),a.DefaultMaterial):this.getDependency("material",i[e].material);s.push(t)}var a;return s.push(t.loadGeometries(i)),Promise.all(s).then((function(s){const a=s.slice(0,s.length-1),r=s[s.length-1],o=[];for(var l=0,c=r.length;l<c;l++){const s=r[l],c=i[l];var h;const d=a[l];if(c.mode===ue||c.mode===pe||c.mode===me||void 0===c.mode)!0!==(h=!0===n.isSkinnedMesh?new P.a(s,d):new I.a(s,d)).isSkinnedMesh||h.geometry.attributes.skinWeight.normalized||h.normalizeSkinWeights(),c.mode===pe?h.geometry=Re(h.geometry,g.Sc):c.mode===me&&(h.geometry=Re(h.geometry,g.Rc));else if(c.mode===ce)h=new k.a(s,d);else if(c.mode===de)h=new R.a(s,d);else if(c.mode===he)h=new z.a(s,d);else{if(c.mode!==le)throw new Error("GLTFLoader: Primitive mode unsupported: "+c.mode);h=new O.a(s,d)}Object.keys(h.geometry.morphAttributes).length>0&&Ce(h,n),h.name=n.name||"mesh_"+e,r.length>1&&(h.name+="_"+l),Me(h,n),t.assignFinalMaterial(h),o.push(h)}if(1===o.length)return o[0];const d=new U.a;for(l=0,c=o.length;l<c;l++)d.add(o[l]);return d}))},Ie.prototype.loadCamera=function(e){let t;const n=this.json.cameras[e],i=n[n.type];if(i)return"perspective"===n.type?t=new F.a(h.a.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):"orthographic"===n.type&&(t=new N.a(i.xmag/-2,i.xmag/2,i.ymag/2,i.ymag/-2,i.znear,i.zfar)),void 0!==n.name&&(t.name=n.name),Me(t,n),Promise.resolve(t)},Ie.prototype.loadSkin=function(e){const t=this.json.skins[e],n={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(n):this.getDependency("accessor",t.inverseBindMatrices).then((function(e){return n.inverseBindMatrices=e,n}))},Ie.prototype.loadAnimation=function(e){const t=this.json.animations[e],n=[],i=[],s=[],a=[],r=[];for(let e=0,o=t.channels.length;e<o;e++){const o=t.channels[e],l=t.samplers[o.sampler],c=o.target,h=void 0!==c.node?c.node:c.id,d=void 0!==t.parameters?t.parameters[l.input]:l.input,u=void 0!==t.parameters?t.parameters[l.output]:l.output;n.push(this.getDependency("node",h)),i.push(this.getDependency("accessor",d)),s.push(this.getDependency("accessor",u)),a.push(l),r.push(c)}return Promise.all([Promise.all(n),Promise.all(i),Promise.all(s),Promise.all(a),Promise.all(r)]).then((function(n){const i=n[0],s=n[1],a=n[2],r=n[3],o=n[4],l=[];for(let e=0,t=i.length;e<t;e++){const t=i[e],n=s[e],m=a[e],f=r[e],v=o[e];if(void 0===t)continue;var c;switch(t.updateMatrix(),t.matrixAutoUpdate=!0,_e[v.path]){case _e.weights:c=B.a;break;case _e.rotation:c=H.a;break;case _e.position:case _e.scale:default:c=j.a}const y=t.name?t.name:t.uuid,b=void 0!==f.interpolation?xe[f.interpolation]:g.P;var h=[];_e[v.path]===_e.weights?t.traverse((function(e){!0===e.isMesh&&e.morphTargetInfluences&&h.push(e.name?e.name:e.uuid)})):h.push(y);let _=m.array;if(m.normalized){var d;if(_.constructor===Int8Array)d=1/127;else if(_.constructor===Uint8Array)d=1/255;else if(_.constructor==Int16Array)d=1/32767;else{if(_.constructor!==Uint16Array)throw new Error("GLTFLoader: Unsupported output accessor component type.");d=1/65535}const e=new Float32Array(_.length);for(var u=0,p=_.length;u<p;u++)e[u]=_[u]*d;_=e}for(u=0,p=h.length;u<p;u++){const e=new c(h[u]+"."+_e[v.path],n.array,_,b);"CUBICSPLINE"===f.interpolation&&(e.createInterpolant=function(e){return new oe(this.times,this.values,this.getValueSize()/3,e)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),l.push(e)}}const m=void 0!==t.name?t.name:"animation_"+e;return new G.a(m,void 0,l)}))},Ie.prototype.loadNode=function(e){const t=this.json,i=this.extensions,s=this,a=t.meshReferences,r=t.meshUses,o=t.nodes[e];return function(){const e=[];return void 0!==o.mesh&&e.push(s.getDependency("mesh",o.mesh).then((function(e){let t;if(a[o.mesh]>1){const n=r[o.mesh]++;t=e.clone(),t.name+="_instance_"+n,t.onBeforeRender=e.onBeforeRender;for(let i=0,s=t.children.length;i<s;i++)t.children[i].name+="_instance_"+n,t.children[i].onBeforeRender=e.children[i].onBeforeRender}else t=e;return void 0!==o.weights&&t.traverse((function(e){if(e.isMesh)for(let t=0,n=o.weights.length;t<n;t++)e.morphTargetInfluences[t]=o.weights[t]})),t}))),void 0!==o.camera&&e.push(s.getDependency("camera",o.camera)),o.extensions&&o.extensions[n.KHR_LIGHTS_PUNCTUAL]&&void 0!==o.extensions[n.KHR_LIGHTS_PUNCTUAL].light&&e.push(s.getDependency("light",o.extensions[n.KHR_LIGHTS_PUNCTUAL].light)),Promise.all(e)}().then((function(e){let t;if(t=!0===o.isBone?new V.a:e.length>1?new U.a:1===e.length?e[0]:new W.a,t!==e[0])for(let n=0,i=e.length;n<i;n++)t.add(e[n]);if(void 0!==o.name&&(t.userData.name=o.name,t.name=q.a.sanitizeNodeName(o.name)),Me(t,o),o.extensions&&Ae(i,t,o),void 0!==o.matrix){const e=new Y.a;e.fromArray(o.matrix),t.applyMatrix(e)}else void 0!==o.translation&&t.position.fromArray(o.translation),void 0!==o.rotation&&t.quaternion.fromArray(o.rotation),void 0!==o.scale&&t.scale.fromArray(o.scale);return t}))},Ie.prototype.loadScene=function(){function e(t,n,i,s){const a=i.nodes[t];return s.getDependency("node",t).then((function(e){if(void 0===a.skin)return e;let t;return s.getDependency("skin",a.skin).then((function(e){t=e;const n=[];for(let e=0,i=t.joints.length;e<i;e++)n.push(s.getDependency("node",t.joints[e]));return Promise.all(n)})).then((function(n){return e.traverse((function(e){if(!e.isMesh)return;const i=[],s=[];for(let e=0,a=n.length;e<a;e++){const a=n[e];if(a){i.push(a);const n=new Y.a;void 0!==t.inverseBindMatrices&&n.fromArray(t.inverseBindMatrices.array,16*e),s.push(n)}}e.bind(new X.a(i,s),e.matrixWorld)})),e}))})).then((function(t){n.add(t);const r=[];if(a.children){const n=a.children;for(let a=0,o=n.length;a<o;a++){const o=n[a];r.push(e(o,t,i,s))}}return Promise.all(r)}))}return function(t){const n=this.json,i=this.extensions,s=this.json.scenes[t],a=this,r=new K.a;void 0!==s.name&&(r.name=s.name),Me(r,s),s.extensions&&Ae(i,r,s);const o=s.nodes||[],l=[];for(let t=0,i=o.length;t<i;t++)l.push(e(o[t],r,n,a));return Promise.all(l).then((function(){return r}))}}(),e}();t.a=Z},function(e,t,n){"use strict";var i=n(25),s=n(55),a=n(15),r=n(5);const o=function(e){i.a.call(this,e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}};o.prototype=Object.assign(Object.create(i.a.prototype),{constructor:o,setDecoderPath:function(e){return this.decoderPath=e,this},setDecoderConfig:function(e){return this.decoderConfig=e,this},setWorkerLimit:function(e){return this.workerLimit=e,this},setVerbosity:function(){},setDrawMode:function(){},setSkipDequantization:function(){},load:function(e,t,n,i){const a=new s.a(this.manager);a.setPath(this.path),a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),"use-credentials"===this.crossOrigin&&a.setWithCredentials(!0),a.load(e,e=>{const n={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(e,n).then(t).catch(i)},n,i)},decodeDracoFile:function(e,t,n,i){const s={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:i||this.defaultAttributeTypes,useUniqueIDs:!!n};this.decodeGeometry(e,s).then(t)},decodeGeometry:function(e,t){for(const e in t.attributeTypes){const n=t.attributeTypes[e];void 0!==n.BYTES_PER_ELEMENT&&(t.attributeTypes[e]=n.name)}const n=JSON.stringify(t);if(o.taskCache.has(e)){const t=o.taskCache.get(e);if(t.key===n)return t.promise;if(0===e.byteLength)throw new Error("DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let i;const s=this.workerNextTaskID++,a=e.byteLength,r=this._getWorker(s,a).then(n=>(i=n,new Promise((n,a)=>{i._callbacks[s]={resolve:n,reject:a},i.postMessage({type:"decode",id:s,taskConfig:t,buffer:e},[e])}))).then(e=>this._createGeometry(e.geometry));return r.catch(()=>!0).then(()=>{i&&s&&this._releaseTask(i,s)}),o.taskCache.set(e,{key:n,promise:r}),r},_createGeometry:function(e){const t=new a.a;e.index&&t.setIndex(new r.a(e.index.array,1));for(let n=0;n<e.attributes.length;n++){const i=e.attributes[n],s=i.name,a=i.array,o=i.itemSize;t.setAttribute(s,new r.a(a,o))}return t},_loadLibrary:function(e,t){const n=new s.a(this.manager);return n.setPath(this.decoderPath),n.setResponseType(t),new Promise((t,i)=>{n.load(e,t,void 0,i)})},preload:function(){return this._initDecoder(),this},_initDecoder:function(){if(this.decoderPending)return this.decoderPending;const e="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(t=>{const n=t[0];e||(this.decoderConfig.wasmBinary=t[1]);const i=o.DRACOWorker.toString(),s=["/* draco decoder */",n,"","/* worker */",i.substring(i.indexOf("{")+1,i.lastIndexOf("}"))].join("\n");this.workerSourceURL=URL.createObjectURL(new Blob([s]))}),this.decoderPending},_getWorker:function(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const e=new Worker(this.workerSourceURL);e._callbacks={},e._taskCosts={},e._taskLoad=0,e.postMessage({type:"init",decoderConfig:this.decoderConfig}),e.onmessage=function(t){const n=t.data;switch(n.type){case"decode":e._callbacks[n.id].resolve(n);break;case"error":e._callbacks[n.id].reject(n)}},this.workerPool.push(e)}else this.workerPool.sort((function(e,t){return e._taskLoad>t._taskLoad?-1:1}));const n=this.workerPool[this.workerPool.length-1];return n._taskCosts[e]=t,n._taskLoad+=t,n})},_releaseTask:function(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]},debug:function(){},dispose:function(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}),o.DRACOWorker=function(){let e,t;function n(e,t,n,i,s,a){const r=a.num_components(),o=n.num_points()*r;let l,c;switch(s){case Float32Array:l=new e.DracoFloat32Array,t.GetAttributeFloatForAllPoints(n,a,l),c=new Float32Array(o);break;case Int8Array:l=new e.DracoInt8Array,t.GetAttributeInt8ForAllPoints(n,a,l),c=new Int8Array(o);break;case Int16Array:l=new e.DracoInt16Array,t.GetAttributeInt16ForAllPoints(n,a,l),c=new Int16Array(o);break;case Int32Array:l=new e.DracoInt32Array,t.GetAttributeInt32ForAllPoints(n,a,l),c=new Int32Array(o);break;case Uint8Array:l=new e.DracoUInt8Array,t.GetAttributeUInt8ForAllPoints(n,a,l),c=new Uint8Array(o);break;case Uint16Array:l=new e.DracoUInt16Array,t.GetAttributeUInt16ForAllPoints(n,a,l),c=new Uint16Array(o);break;case Uint32Array:l=new e.DracoUInt32Array,t.GetAttributeUInt32ForAllPoints(n,a,l),c=new Uint32Array(o);break;default:throw new Error("DRACOLoader: Unexpected attribute type.")}for(let e=0;e<o;e++)c[e]=l.GetValue(e);return e.destroy(l),{name:i,array:c,itemSize:r}}onmessage=function(i){const s=i.data;switch(s.type){case"init":e=s.decoderConfig,t=new Promise((function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)}));break;case"decode":const i=s.buffer,a=s.taskConfig;t.then(e=>{const t=e.draco,r=new t.Decoder,o=new t.DecoderBuffer;o.Init(new Int8Array(i),i.byteLength);try{const e=function(e,t,i,s){const a=s.attributeIDs,r=s.attributeTypes;let o,l;const c=t.GetEncodedGeometryType(i);if(c===e.TRIANGULAR_MESH)o=new e.Mesh,l=t.DecodeBufferToMesh(i,o);else{if(c!==e.POINT_CLOUD)throw new Error("DRACOLoader: Unexpected geometry type.");o=new e.PointCloud,l=t.DecodeBufferToPointCloud(i,o)}if(!l.ok()||0===o.ptr)throw new Error("DRACOLoader: Decoding failed: "+l.error_msg());const h={index:null,attributes:[]};for(const i in a){const l=self[r[i]];let c,d;if(s.useUniqueIDs)d=a[i],c=t.GetAttributeByUniqueId(o,d);else{if(d=t.GetAttributeId(o,e[a[i]]),-1===d)continue;c=t.GetAttribute(o,d)}h.attributes.push(n(e,t,o,i,l,c))}if(c===e.TRIANGULAR_MESH){const n=o.num_faces(),i=new Uint32Array(3*n),s=new e.DracoInt32Array;for(let e=0;e<n;++e){t.GetFaceFromMesh(o,e,s);for(let t=0;t<3;++t)i[3*e+t]=s.GetValue(t)}h.index={array:i,itemSize:1},e.destroy(s)}return e.destroy(o),h}(t,r,o,a),i=e.attributes.map(e=>e.array.buffer);e.index&&i.push(e.index.array.buffer),self.postMessage({type:"decode",id:s.id,geometry:e},i)}catch(e){self.postMessage({type:"error",id:s.id,error:e.message})}finally{t.destroy(o),t.destroy(r)}})}}},o.taskCache=new WeakMap,o.setDecoderPath=function(){},o.setDecoderConfig=function(){},o.releaseDecoderModule=function(){},o.getDecoderModule=function(){},t.a=o},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return a}));var i=n(26),s=n(0);class a{constructor(){e(this),this.cells=[],this.boundingBoxes=[],s.a.addEventListener("ready",this.initialize)}initialize(){s.a.addEventListener("physics",this.onPhysics)}add(e){const{position:t,boundingBox:n}=e,s=this.getCell(t);this.cells[s]||(this.cells[s]=[]),this.boundingBoxes[s]||(this.boundingBoxes[s]=new i.a),this.cells[s].push(e),this.boundingBoxes[s].union(n)}containsPoint(e,t){return!(t.x<e.min.x)&&(!(t.x>e.max.x)&&(!(t.z<e.min.z)&&!(t.z>e.max.z)))}getCell(e){const{size:t}=s.a.park;return 5*Math.round(4*(.5*t.x+e.x)/t.x)+Math.round(4*(.5*t.z+e.z)/t.z)}onPhysics(){const{player:e}=s.a.scene;for(let t=0,n=this.boundingBoxes.length;t<n;t++){const n=this.boundingBoxes[t];if(!n)continue;const i=!s.a.cycling.initialized&&this.containsPoint(n,e.body.position);this.setBodies(this.cells[t],i)}}setBodies(e,t){const{player:n}=s.a.scene;for(let i=0,a=e.length;i<a;i++){const{position:a,object:r,collider:o,callback:l,minDistance:c=5}=e[i];if(t){const e=Math.abs(a.x-n.position.x);if(e>c)continue;const t=Math.abs(a.z-n.position.z);if(t>c)continue;const i=Math.sqrt(e*e+t*t);if(i<c&&!r.body&&(r.body=l(r,o)),r.body){const{player:e}=s.a.scene;r.body.disabled=i>c,r.body.collisionResponse=e.inSensor&&r.isBridge||!e.inSensor&&!r.isBridge}}else r.body&&(r.body.disabled=!0)}}}}).call(this,n(6).default)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));class i{constructor(){}render(e,t={},n=!1){t.env="PROD";const i=e(t);return n?i:this._getNodes(i)}getNodesFromDOM(e,t={},n="*[ ref ]"){const i=e.querySelectorAll(n);for(let e=0,n=i.length;e<n;e++){const n=i[e];n.getAttribute("ref").split(", ").forEach(e=>{const i=t[e];Array.isArray(i)?t[e].push(n):t[e]=i?[i,n]:n})}return t}_getNodes(e){const t={},n=document.createElement("div");if(n.innerHTML=e,n.children.length,t.main=n.children[0],t.main)return this.getNodesFromDOM(t.main,t),t}}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o}));var i=n(26),s=n(2),a=n(12),r=n(0);class o extends a.World{constructor(){super(),e(this),this.nodes=[],this.timeScale=1,this.allowSleep=!1,this.solver.iterations=10,this.solver.tolerance=1e-4,Object.assign(this.defaultContactMaterial,{contactEquationStiffness:1e6,contactEquationRegularizationTime:1}),this.settings={Ball:new a.Material,CollisionBox:new a.Material,Ground:new a.Material,Character:new a.Material},this.groups={Default:1,Ball:2,OnlyBall:4};const t=[new a.ContactMaterial(this.settings.CollisionBox,this.settings.Ball,{friction:0,restitution:.5}),new a.ContactMaterial(this.settings.Ground,this.settings.Ball,{friction:.35,restitution:.5}),new a.ContactMaterial(this.settings.Ground,this.settings.Character,{friction:0,restitution:1})];Object.assign(this.defaultContactMaterial,{friction:0,restitution:0});for(const e in this.settings)this.addMaterial(this.settings[e]);for(let e=0,n=t.length;e<n;e++)this.addContactMaterial(t[e]);r.a.addEventListener("ready",this.initialize)}initialize(){this.addEventListeners()}addEventListeners(){r.a.addEventListener("physics",this.update)}add(e){this.nodes.push(e)}getHalfExtents(e){const t=new i.a;e.isMesh||e.isObject3D?t.setFromObject(e):t.setFromArray(e.attributes.position.array);const n=t.getSize(new s.a),r=t.getCenter(new s.a),o=(new s.a).copy(n).multiplyScalar(.5);return{size:n,center:r,halfExtents:(new a.Vec3).copy(o)}}update(){for(let e=0,t=this.nodes.length;e<t;e++){const t=this.nodes[e];this[t.disabled?"removeBody":"addBody"](t)}const{timeScale:e,gravity:t}=r.a.settings.physics;this.timeScale=e.value,this.gravity.set(0,-t.value,0),this.step(1/60*this.timeScale)}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return l}));var i=n(118),s=n(72),a=n(3),r=n(163),o=n(0);n(284).a;class l extends i.a{constructor(){const{antialias:t}=o.a.settings.renderer;super({antialias:t.value,powerPreference:"high-performance",logarithmicDepthBuffer:!1,alpha:!0}),e(this),this.scene=new s.a,this.resolution=new a.a,this.shadowMap.enabled=!0,this.info.autoReset=!1,this.needsUpdate=!0,o.a.postProcessing=new r.a(this),document.body.appendChild(this.domElement),o.a.addEventListener("render",this._render)}setResolution(){const{width:e,height:t,size:n}=o.a.viewport;this.setSize(e,t),this.resolution.copy(n).multiplyScalar(this.pixelRatio)}prerender(e){const t=e.parent;this.scene.add(e),this._setObjectsCulling(e,!1);const n=o.a.overrideCamera||o.a.camera;this.render(this.scene,n),this._setObjectsCulling(e,!0),t&&t.add(e)}_render(){if(!this.needsUpdate)return;const{quality:e}=o.a.settings.renderer,{devicePixelRatio:t}=o.a.viewport;this.pixelRatio=Math.clamp(e.value,.5,t),this.autoClear=!1,this.clear(),this.setResolution(),this.setClearColor(0,1),this.setPixelRatio(this.pixelRatio),this.info.reset();const n=o.a.overrideCamera||o.a.camera,{enabled:i}=o.a.settings.postProcessing;i.value?o.a.postProcessing.render():this.render(o.a.scene,n)}_setObjectsCulling(e,t){e.traverse(e=>this._setObjectCulling(e,t))}_setObjectCulling(e,t){e.isMesh&&(t||(e._frustumCulled=e.frustumCulled,e._visible=e.visible),e.frustumCulled=t?e._frustumCulled:t,e.visible=!t||e._visible,t&&(delete e._frustumCulled,delete e._visible))}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c}));var i=n(0),s=n(165),a=n(164),r=n(283),o=n(286),l=n(285);class c{constructor(t){e(this),this.renderPass=new a.a,this.bloomPass=new r.a(.5,1,.5),this.vignettePass=new o.a,this.titlShiftPass=new l.a,this.composer=new s.a(t),this.composer.addPass(this.renderPass),this.composer.addPass(this.bloomPass),this.composer.addPass(this.titlShiftPass)}render(){const e=i.a.overrideCamera||i.a.camera,{bloom:t,titlShift:n}=i.a.settings.postProcessing,{resolution:s}=i.a.renderer;Object.assign(this.bloomPass,{enabled:t.enabled.value,strength:t.strength.value,radius:t.radius.value,threshold:t.threshold.value}),this.titlShiftPass.enabled=n.enabled.value,this.titlShiftPass.uniforms.v.value=n.strength.value/s.y,this.titlShiftPass.uniforms.r.value=n.height.value,this.renderPass.camera=e,this.renderPass.scene=i.a.scene,this.composer.setSize(s.x,s.y),this.composer.render()}}}).call(this,n(6).default)},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var i=n(75);class s extends i.a{constructor(e,t,n=null,i,s){super(),this.scene=e,this.camera=t,this.overrideMaterial=n,this.clearColor=i,this.clearAlpha=void 0!==s?s:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1}render(e,t,n){const i=e.autoClear;let s,a;e.autoClear=!1,this.scene.overrideMaterial=this.overrideMaterial,this.clearColor&&(s=e.getClearColor().getHex(),a=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:n),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(s,a),this.scene.overrideMaterial=null,e.autoClear=i}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n(1),s=n(3),a=n(59),r=n(82),o=n(76);class l{constructor(e,t){if(this.renderer=e,!t){const n={minFilter:i.V,magFilter:i.V,format:i.Fb,stencilBuffer:!1},r=s.a.get();s.a.release(r),e.getSize(r),(t=new a.a(r.width,r.height,n)).texture.name="EffectComposer.renderTargetA"}this.renderTargetA=t,this.renderTargetB=t.clone(),this.renderTargetB.texture.name="EffectComposer.renderTargetB",this.writeBuffer=this.renderTargetA,this.readBuffer=this.renderTargetB,this.passes=[],this.renderToScreen=!0,this.copyPass=new o.a(r.a)}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e);const t=s.a.get();this.renderer.getSize(t),e.setSize(t.width,t.height),s.a.release(t)}insertPass(e,t){this.passes.splice(t,0,e)}getLastPass(){let e,t=this.passes.length;for(;t--&&void 0===e;)this.passes[t].enabled&&(e=this.passes[t]);return e}render(e){this.renderToScreen&&(this.getLastPass().renderToScreen=!0);for(let t=0,n=this.passes.length;t<n;t++){const n=this.passes[t];!1!==n.enabled&&(n.render(this.renderer,this.writeBuffer,this.readBuffer,e,!1),n.needsSwap&&this.swapBuffers())}}reset(e){if(void 0===e){const t=this.renderer.getSize();(e=this.renderTargetA.clone()).setSize(t.width,t.height)}this.renderTargetA.dispose(),this.renderTargetB.dispose(),this.renderTargetA=e,this.renderTargetB=e.clone(),this.writeBuffer=this.renderTargetA,this.readBuffer=this.renderTargetB}setSize(e,t){this.renderTargetA.setSize(e,t),this.renderTargetB.setSize(e,t);for(let n=0;n<this.passes.length;n++)this.passes[n].setSize(e,t)}}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return p}));var i=n(27),s=n(2),a=n(60),r=n(111),o=n(23),l=n(17),c=n(16),h=n(4),d=n(0),u=n(167);class p extends i.a{constructor(){super(45,1,1,400),e(this),this.name="MainCamera",this.offset=new s.a,this.focus=new s.a,this.target=new s.a;const{fov:t,near:n,far:i}=d.a.settings.camera;this.fov=t.value,this.near=n.value,this.far=i.value,this.frustum=new a.a,this.direction=new s.a,this.angle=0,this.offsetTop=0,this.scrollTop=0,this.fovOffset=0,this.responsive=new s.a(1.65,.5,0),this.controls=new u.a,this.add(this.controls),d.a.addEventListener("ready",this.initialize)}initialize(){setTimeout(()=>{this.reset(),this.addEventListeners(),this.setMode("Default",0),this.onResize()},0)}reset(){}addEventListeners(){d.a.addEventListener("applySettings",this.applySettings),d.a.addEventListener("beforeRender",this.beforeRender),d.a.viewport.addEventListener("resize",this.onResize)}applySettings(){const{fov:e,near:t,far:n}=d.a.settings.camera;this.fov=e.value,this.near=t.value,this.far=n.value}beforeRender(){this.computeFrustum(),this.setModeFromView();const{player:e}=d.a.scene,{aspect:t}=d.a.viewport;this.angle=Math.lerpAngle(this.angle,e.rotation.y,.01),this.offsetTop=Math.lerp(this.offsetTop,this.scrollTop,.1);const n=r.a.get().set(0,this.angle,0),i=o.a.get().setFromEuler(n),a=Math.mapLinear(t,.5,1.5,1.5,1),l=s.a.get().copy(this.offset).multiplyScalar(a).applyQuaternion(i).add(this.target).add(this.controls.position),{elapsedTime:c}=d.a.time;l.x+=.25*Math.sin(.25*(c+0)),l.z+=.25*Math.cos(.275*(c+.25)),l.y+=.25*Math.sin(.225*(c-.25)),l.y+=this.offsetTop,this.position.copy(l);const h=s.a.get().copy(this.focus).applyQuaternion(i).add(this.target);h.y+=this.offsetTop,this.lookAt(h),r.a.release(n),o.a.release(i),s.a.release(l,h),this.fov+=this.fovOffset,this.aspect=d.a.viewport.aspect,this.updateProjectionMatrix()}setModeFromView(e){const{player:t}=d.a.scene;if(t.isTalking)return this.setMode("Dialog");const{viewID:n}=h.a,i="home"===n?"Default":n.charAt(0).toUpperCase()+n.slice(1);this.setMode(i,e)}setMode(e,t,n=3){if(e===this.mode&&!t)return;this.mode=e;const i=new s.a,a=new s.a;switch(e){case"Dialog":const e=5*Math.randomSign();document.body.classList.toggle("dialog--inverse-tail",e>0),i.set(e,4,-2),a.set(0,2,0);const{current:s}=h.a.router.history;s.match("intro")&&(i.set(0,2,-4),a.set(0,1,0));break;case"Customization":i.set(0,2,-4),a.set(0,.8,0);break;case"Dashboard":n=t?0:n,i.set(0,2,-4),a.set(0,.5,0),this.hasSmallWidth||(i.add(this.responsive),a.add(this.responsive));break;case"Game":n=0,i.set(0,5.5,-7.5),a.set(0,2.5,0);break;case"Code":i.set(1,7.5,-20),a.set(0,2,0);break;default:"device-desktop"===h.a.device.deviceType?(i.set(1,7.5,-10),a.set(0,2,0)):(i.set(1,8,-7.5),a.set(0,5,0))}c.a.killTweensOf(this.focus),c.a.killTweensOf(this.offset),c.a.to(this.focus,n,{...a,ease:"expo.out"}),c.a.to(this.offset,n,{...i,ease:"expo.out"})}computeFrustum(){const e=l.a.get().multiplyMatrices(this.projectionMatrix,this.matrixWorldInverse);this.frustum.setFromProjectionMatrix(e),l.a.release(e)}onResize(){const{width:e}=d.a.viewport,t=e<1200;t!==this.hasSmallWidth&&(this.hasSmallWidth=t,this.setModeFromView(!0))}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return l}));var i=n(7),s=n(2),a=n(16),r=n(4),o=n(0);class l extends i.a{constructor(){super(),e(this),o.a.addEventListener("ready",this.initialize)}initialize(){this.friction=.05;const{current:e}=r.a.router.history,t=e.match("intro");this.startAngle=0,this.currentAngle=t?.75:1.35*Math.PI,this.lerpAngle=t?.75:1.35*Math.PI,this.offsetAngle=0,this.autoRotate=0,this.radiusFactor=e.match(/(.|dialog\/intro)/g)?1:0,this.targetFactor=1,this.offsetFactor=0,this.target=new s.a,this.center=new s.a,this.offset=new s.a,this.setAngle(this.currentAngle),this.addEventListeners()}addEventListeners(){o.a.mouse.addEventListener("down",this.onMouseDown),o.a.mouse.addEventListener("move",this.onMouseMove),o.a.multiTouch.addEventListener("touchStart",this.onMouseDown),o.a.multiTouch.addEventListener("touchMove",this.onMouseMove),o.a.scroll.addEventListener("wheel",this.onWheel),o.a.addEventListener("applySettings",this.applySettings),o.a.addEventListener("beforeUpdate",this.beforeUpdate)}applySettings(){const{radius:e}=o.a.settings.controls;this.radius=e.value}beforeUpdate(){const{friction:e,height:t}=o.a.settings.controls,{radiusX:n,offsetX:i,heightX:s,offsetZ:a}=o.a.settings.controls;if(this.setCameraTarget(),r.a.preloader.hidden||"about"===r.a.viewID){const t="about"===r.a.viewID?1.5:1,n=!!r.a.viewID.match(/(overview|about)/g);this.activate(n,t),this.lerpAngle=Math.lerp(this.lerpAngle,this.currentAngle,e.value),"overview"===r.a.viewID&&(this.autoRotate+=.001)}const l=this.getAngle(),c=Math.sin(l),h=Math.lerp(1,n.value,this.offsetFactor),d=c>0?.2*c*this.offsetFactor:0,u=Math.abs(c)*Math.lerp(0,s.value,this.offsetFactor),p=c>0?30*c*this.offsetFactor:0,m=c*this.radius*(h-d),f=t.value+u-p,g=Math.cos(l)*this.radius;"overview"===r.a.viewID&&(this.center.x=-c*i.value*this.offsetFactor,this.center.z=-c*a.value*this.offsetFactor),this.position.set(m,f,g).add(o.a.camera.target).multiplyScalar(this.radiusFactor)}getAngle(){return this.lerpAngle-this.autoRotate-Math.PI-this.offsetAngle}setAngle(e){const{player:t}=o.a.scene;t.angle=e,t.rotation.y=e,o.a.camera.angle=e}setCameraTarget(e){const{player:t,lighting:n}=o.a.scene;if(e)this.target.copy(e),o.a.camera.target.copy(this.target);else{const e=s.a.get().copy(t.position);o.a.speakingCharacter&&e.sub(o.a.speakingCharacter.position).multiplyScalar(o.a.speakingCharacter.isIntro?0:.25).add(o.a.speakingCharacter.position),this.target.copy(e).lerp(this.center,this.targetFactor),o.a.camera.target.lerp(this.target,.05),s.a.release(e)}const i=o.a.camera.position.distanceTo(o.a.player.position),a=Math.mapLinear(i,5,200,20,250);n.shadowCameraSize=a,n.target.copy(this.target),o.a.camera.near=Math.lerp(.1,5,this.radiusFactor),o.a.camera.far=Math.lerp(250,500,this.radiusFactor)}onMouseDown(){this.active&&(this.startAngle=this.currentAngle)}onMouseMove(){if("overview"!==r.a.viewID)return;if(!(o.a.mouse.isDown||o.a.multiTouch.isActive)||!this.active)return;const{speed:e}=o.a.settings.controls,t=o.a.multiTouch.getTouch()||o.a.mouse,n=t.getNormalizedDeltaPosition(o.a.viewport.size),i=e.value*(t.isTouch?.5:1);this.currentAngle=this.startAngle-n.x*i}onWheel(e){if("overview"!==r.a.viewID)return;const{scrollSpeed:t}=o.a.settings.controls;this.currentAngle+=.001*e.wheelDelta.y*-t.value}activate(e,t){if(this.active===e)return;this.active=e;const{camera:n}=o.a,{player:i}=o.a.scene;e?(this.lerpAngle=n.angle,this.currentAngle=n.angle,this.autoRotate=0,o.a.audio.play("OverviewOpen",{volume:.75})):(i.angle=this.getAngle()+Math.PI,i.direction.z=-Math.cos(i.angle),i.direction.x=-Math.sin(i.angle),o.a.audio.play("OverviewClose",{volume:.75}));const l=e?t:0,c=e?1:0;if(a.a.to(this,2,{targetFactor:c,ease:e?"expo.inOut":"expo.out"}),a.a.to(this,2,{radiusFactor:l,ease:"expo.inOut"}),e&&"about"===r.a.viewID){const e="expo.inOut",t=new s.a(-7,4.5,-40),n=this.offsetAngle+Math.minAngleBetween(this.offsetAngle,-2.6+this.lerpAngle);a.a.to(this.center,2,{...t,ease:e}),a.a.to(this,2,{offsetAngle:n,ease:e})}else if(e&&"overview"===r.a.viewID)a.a.to(this,2,{offsetFactor:1,ease:"expo.inOut"});else{const e="expo.out",t=new s.a,n=Math.abs(this.offsetAngle)>Math.abs(this.offsetAngle-2*Math.PI)?2*Math.PI:0;a.a.to(this.center,2,{...t,ease:e}),a.a.to(this,2,{offsetAngle:n,ease:e}),a.a.to(this,2,{offsetFactor:0,ease:e})}}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return R}));var i=n(72),s=n(301),a=n(2),r=n(0),o=n(43),l=n(4),c=n(187),h=n(188),d=n(212),u=n(169),p=n(170),m=n(186),f=n(189),g=n(237),v=n(196),y=n(232),b=n(233),_=n(242),x=n(103),w=n(219),S=n(235),L=n(234),T=n(236),E=n(174),A=n(79),M=n(92),C=n(253),D=n(201),P=n(202),I=n(246),k=n(249);class R extends i.a{constructor(){super(),e(this);const{textures:t,svgs:n}=r.a.assets;t.Colors=new o.a(n["canvas.pack/Colors.svg"],{width:2048,height:2048}),t.Colors.rasterize(),t.Icons=new o.a(n["canvas.pack/Icons.svg"],{width:1024,height:256}),t.Icons.rasterize(),t.Character=new o.a(n["canvas.pack/Character.svg"],{width:2048,height:1024}),t.Character.rasterize(),this.add(r.a.camera),this.lighting=new u.a,this.add(this.lighting),this.sky=new p.a,this.add(this.sky),this.player=new E.a,this.add(this.player),this.park=new m.a,this.add(this.park),this.navigation=new c.a,this.ground=new h.a,this.pin=new x.a,this.add(this.pin),this.butterflies=new f.a,this.add(this.butterflies),this.wind=new v.a,this.add(this.wind),this.cycling=new D.a,this.add(this.cycling),this.soccer=new P.a,this.add(this.soccer),this.overlay=new d.a,this.add(this.overlay),this.parse(),r.a.addEventListener("ready",this.initialize)}parse(){this.areas=[],this.points={},this.npcs=[],this.clouds=[],this.waters=[],this.stars=[],this.trees=[],this.bottles=[],this.terrains=[],this.cards=[];const{objects:e}=r.a.assets,t=/(Characters|Areas|Stars|Bottles|Cards|Start|Terrains)/g;e["Park.glb/Scene"].traverse(e=>{const{name:n}=e;if(!n.match(t)){if(n.match("Area")){const t=new w.a(e);this.areas.push(t),this.add(t)}if(n.match("Clouds")&&(this.clouds=new y.a(e),this.add(this.clouds)),n.match("Waters")&&(this.waters=new b.a(e),this.add(this.waters)),n.match("Star")){const t=new L.a(e);this.stars.push(t),this.add(t)}if(n.match("Bottle")){const t=new S.a(e);this.bottles.push(t),this.add(t)}if(n.match("Card")){const t=new T.a(e);this.cards.push(t),this.add(t)}if(n.match("Terrain")){const t=new g.a(e);this.terrains.push(t),this.add(t)}n.match("Character")&&this.setCharacter(e)}}),this.merge=new _.a(e["Park.glb/Instances"]),this.add(this.merge)}initialize(){this.helpers=new I.a,this.add(this.helpers),this.addEventListeners()}addEventListeners(){r.a.addEventListener("applySettings",this.applySettings),r.a.addEventListener("beforeUpdate",this.beforeUpdate)}applySettings(){const{color:e,density:t}=r.a.settings.fog;this.fog=new s.a(e.value,t.value)}beforeUpdate(){this.hasHover=!1;for(let e=0,t=this.npcs.length;e<t;e++)this.npcs[e].isHovered&&(this.hasHover=!0);for(let e=0,t=this.areas.length;e<t;e++)this.areas[e].isHovered&&(this.hasHover=!0);const e="overview"===l.a.viewID,t=r.a.mouse.isDown;document.body.classList.toggle("pointer",this.hasHover),document.body.classList.toggle("grab",e&&!t),document.body.classList.toggle("grabbing",e&&t)}setCharacter(e){r.a.characters=r.a.characters||{};const t=e.name.split("-")[1],n=t&&t.match(/(\()/g),i=t&&!n?t:void 0,s=n?t.replace(/[()]/g,""):void 0,a=r.a.assets.data["canvas.pack/Characters.json"][e.name],o={characterID:i,animationID:s,points:a},l="Injured"===i?k.a:i?M.a:a?C.a:A.a;if((!e.name.match(/Character_046/g)||e.name.match(/Injured/g))&&l){const t=new l(e,o);this.npcs.push(t),this.add(t)}}getPlayerDistance(e){const t=a.a.get(),n=a.a.get();return t.copy(e).setY(0),n.copy(this.player.body.position).setY(0),a.a.release(t,n),t.distanceTo(n)}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return h}));var i=n(7),s=n(2),a=n(288),r=n(289),o=n(133),l=n(67),c=n(0);class h extends i.a{constructor(t=!0){super(),e(this),this.castShadow=t;const{textures:n}=c.a.assets;this.target=new s.a,n.MatCap=n["canvas.pack/MatCap.jpg"],this.ambientLight=new a.a(16777215,.25),this.add(this.ambientLight),this.hemisphereLight=new r.a(3892113,10137529,.85),this.add(this.hemisphereLight),this.keyLight=new o.a(16777215,.85),this.keyLight.direction=new s.a(0,15,5),this.keyLight.shadow.camera.far=100,this.keyLight.castShadow=!0,this.add(this.keyLight),this.add(this.keyLight.target),this.setEnvMap(),this.shadowCameraSize=25,c.a.addEventListener("applySettings",this.applySettings),c.a.addEventListener("beforeUpdate",this.beforeUpdate)}setEnvMap(){const e=["px","nx","py","ny","pz","nz"];for(let t=0;t<e.length;t++){const n=`canvas.pack/env_map/${e[t]}.jpg`;e[t]=c.a.assets.textures[n].image}const t=new l.a(e);t.needsUpdate=!0,c.a.assets.textures.EnvMap=t}applySettings(){const{ambientLight:e,hemisphereLight:t,keyLight:n}=c.a.settings.lighting;this.ambientLight.intensity=e.intensity.value,this.ambientLight.color.set(e.color.value),this.hemisphereLight.intensity=t.intensity.value,this.hemisphereLight.color.set(t.skyColor.value),this.hemisphereLight.groundColor.set(t.groundColor.value),this.castShadow&&(this.keyLight.castShadow=n.castShadow.value),this.keyLight.intensity=n.intensity.value,this.keyLight.color.set(n.color.value),this.keyLight.direction.x=n.position.x.value,this.keyLight.direction.y=n.position.y.value,this.keyLight.direction.z=n.position.z.value;const i=parseInt(n.shadowMapSize.value);if(this.mapSize!==i){this.mapSize=i;const e=(c.a.version.quality,1);this.keyLight.shadow.mapSize.width=i*e,this.keyLight.shadow.mapSize.height=i*e,this.keyLight.shadow.map&&(this.keyLight.shadow.map.dispose(),this.keyLight.shadow.map=null)}}beforeUpdate(){const e=s.a.get().copy(c.a.camera.target||this.target);this.keyLight.target.position.copy(e),this.keyLight.position.copy(e).add(this.keyLight.direction),s.a.release(e)}get shadowCameraSize(){return this.keyLight.shadow.camera.top}set shadowCameraSize(e){this.keyLight.shadow.camera.top=e,this.keyLight.shadow.camera.right=e,this.keyLight.shadow.camera.bottom=-e,this.keyLight.shadow.camera.left=-e,this.keyLight.shadow.camera.updateProjectionMatrix()}}}).call(this,n(6).default)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(18),s=n(51),a=n(171);class r extends i.a{constructor(){super(new s.a(2,2),new a.a),this.frustumCulled=!1,this.name="Sky",this.renderOrder=-100,this.material.depthTest=!1}}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return h}));var i=n(35),s=n(8),a=n(19),r=n(24),o=n(0),l=n(172),c=n(173);class h extends i.a{constructor(){super(),e(this),this.type="StandardMaterial",this.vertexShader=l.a,this.fragmentShader=c.a,this.uniforms=Object.assign({topColor:{value:new s.a},bottomColor:{value:new s.a}},a.a.clone(r.a.standard.uniforms)),o.a.addEventListener("applySettings",this.applySettings)}applySettings(){const{topColor:e,bottomColor:t}=o.a.settings.sky;this.uniforms.topColor.value.set(e.value),this.uniforms.bottomColor.value.set(t.value)}}}).call(this,n(6).default)},function(e,t,n){"use strict";t.a="varying vec2 vUv;\n\nvoid main() {\n\n\tvUv = uv;\n\n\tgl_Position = vec4( position, 1. );\n\n}\n"},function(e,t,n){"use strict";t.a="varying vec2 vUv;\nuniform vec3 topColor;\nuniform vec3 bottomColor;\n\nvoid main() {\n\n\tfloat ratio = vUv.y * vUv.x;\n\tvec3 color = mix( bottomColor, topColor, ratio );\n\n\tgl_FragColor = vec4( color, 1. );\n\n}\n"},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return f}));var i=n(2),s=n(41),a=n(1),r=n(4),o=n(0),l=n(14),c=n(63),h=n(181),d=n(77),u=n(179),p=n(102),m=n(180);class f extends d.a{constructor(){super(),e(this);const{textures:t}=o.a.assets;this.isPlayer=!0,this.name="Player",this.material=new c.a({envMap:t.EnvMap,aoMap:t["canvas.pack/ao_maps/Other.png"],skinning:!0,roughness:.95,metalness:.15}),this.direction=new i.a,this.height=0,o.a.player=this,o.a.addEventListener("ready",this.initialize)}initialize(){if(this.initialized)return;this.initialized=!0,super.initialize();const{objects:e}=o.a.assets,t=e["Park.glb/Start"];this.body.position.copy(t.position)}addEventListeners(){super.addEventListeners(),o.a.addEventListener("beforePhysics",this.beforePhysics),o.a.mouse.addEventListener("move",this.onMouseMove)}beforePhysics(){this.inSensor=!1}update(){super.update(),this.onMouseDown(),this.setScale(),this.setPosition(),this.setRotation(),this.setHeight(),this.setAudio(),this.setMedal(),this.lookAtPointer(),this.body.collisionResponse=!o.a.cycling.started}setProperties(){super.setProperties(),this.pointer=new i.a,this.mouse=new i.a,this.speed=0,this.angle=0,this.velocity=new i.a,this.acceleration=new i.a,this.previousPosition=new i.a,this.point=new i.a,this.target=new i.a}setObjects(){super.setObjects(),this.bike=new p.a,this.bike.visible=!1,this.add(this.bike),this.particles=new u.a,o.a.scene.add(this.particles),this.marker=new m.a,o.a.scene.add(this.marker),this.effect=new h.a,o.a.scene.add(this.effect)}setGeometries(){super.setGeometries(),this.neck=this.getObjectByName("mixamorigNeck"),this.spine=this.getObjectByName("mixamorigSpine"),this.hips=this.getObjectByName("mixamorigHips"),this.rightFoot=this.getObjectByName("mixamorigRightFoot")}setVisible(){this.visible=this.scale.length()>.01}setHeight(){const e=this.position.y;this.position.copy(this.body.position),this.body.position.y=this.radius;const t=this.inSensor||o.a.cycling.initialized,n=o.a.navigation.raycast(this.position,e,t),i=o.a.cycling.started&&Math.abs(e-n.y)>1;this.position.y=n&&!i?n.y:e,this.height=Math.lerp(this.height,this.position.y,.2),this.object.position.y=this.height-this.position.y}setAudio(){if(!o.a.audio.started)return;const e=i.a.get().copy(this.position).sub(this.previousPosition),t=5*e.length();if(!this.hasAudio){this.hasAudio=!0;const e={volume:1,loop:!0};this.wind=o.a.audio.play("Wind",e),this.cycling=o.a.audio.play("Cycling",e),this.walk=o.a.audio.play("Walk",e)}{const e=Math.clamp(t,0,1),n="home"===r.a.viewID?e:0;this.walk.weight=Math.lerp(this.walk.weight,n,.1),this.walk.setPlaybackRate(2*this.walk.weight),this.walk.setVolume(1.5*this.walk.weight)}{const{started:e,acceleration:t}=o.a.cycling,n=Math.clamp(t/2.5,0,1.25),i=e?n:0;this.wind.weight=Math.lerp(this.wind.weight,i,.1),this.wind.setVolume(this.wind.weight),this.cycling.setVolume(this.wind.weight),this.cycling.setPlaybackRate(this.wind.weight)}this.previousPosition.copy(this.position),i.a.release(e)}setScale(){const{radiusFactor:e}=o.a.camera.controls,t=(1-e)*this.scaleFactor;this.scale.setScalar(t)}setAnimationMixer(){super.setAnimationMixer(["Cycling","HappyIdle","RightTurn","Running","SoccerPenaltyKick","Walking"])}setAnimation(){const e=!!o.a.cycling.initialized;if(e!==this.isOnBike&&(this.isOnBike=e,this.currentAnimation=e?"Cycling":void 0,this.bike.visible=e),"RightTurn"===this.currentAnimation){const e=this.animations[this.currentAnimation],t=e.time/e._clip.duration;this.object.rotation.y=this.startRotation+t*-Math.PI,e.time>.999*e._clip.duration&&this.onTurnEnd()}const{acceleration:t}=o.a.cycling;this.animations.Cycling.timeScale=Math.clamp(.25*t||0,0,1.25),super.setAnimation()}setAnimationFromSpeed(){let e="Running";const t=this.body.velocity.length();return t<1?e="HappyIdle":t<5&&(e="Walking"),e}onMouseDown(){const{raycaster:e}=o.a.navigation,{camera:t,mouse:n,multiTouch:a,viewport:l,scene:c}=o.a;if(!(n.isDown||a.isActive)||"home"!==r.a.viewID||c.hasHover)return;const h=a.getTouch()||o.a.mouse,{x:d,y:u}=h.currentPosition;if(!o.a.isOverCanvas(d,u))return;void 0===this.startTime&&(this.startTime=o.a.time.elapsedTime);const p=h.getNormalizedPosition(l.size);e.setFromCamera(p,t);const m=new s.a(new i.a(0,1,0));e.ray.intersectPlane(m,this.marker.position),this.marker.initialize()}setPosition(){const{controls:e}=o.a.settings.developement;if(e.enabled.value)return;const t=i.a.get(),n=this.setKeyboard(t)||this.setPointAndClick(t);if(this.direction.lerp(t,.1),this.speed=Math.lerp(this.speed,n,.1),i.a.release(t),"home"===r.a.viewID){const e=Math.atan2(-this.direction.x,-this.direction.z);this.angle=Math.lerpAngle(this.angle,e,.1)}this.velocity.copy(this.direction).negate().multiplyScalar(this.speed),l.a.player.distance+=this.velocity.length(),l.a.player.distance>5e4&&l.a.setAchievement("tireless"),this.body.velocity.copy(this.velocity)}setPointAndClick(e){this.marker.initialized&&e.copy(this.position).sub(this.marker.position).normalize();const{multiTouch:t,mouse:n,time:i}=o.a,s=t.isActive||n.isDown,a=void 0!==this.startTime,l=i.elapsedTime-this.startTime;!s&&a&&l>.2&&this.marker.destroy(),s||(this.startTime=void 0);const c=o.a.scene.getPlayerDistance(this.marker.position);return"home"===r.a.viewID&&!this.isTalking&&c>.5&&this.marker.initialized?c>4?7.5:Math.mapLinear(c,0,4,0,8):0}setKeyboard(e){const{keyboard:t}=o.a;let n;return t.isDown("ArrowUp")&&(e.z=-1),t.isDown("ArrowLeft")&&(e.x=-1),t.isDown("ArrowRight")&&(e.x=1),e.length()>0&&(e.applyQuaternion(this.quaternion),n=5,this.marker.destroy()),n}setRotation(){if(!r.a.viewID.match(/(game|overview|dashboard|customization)/g)){if(o.a.speakingCharacter){const e=i.a.get().copy(o.a.speakingCharacter.position).sub(this.position).setY(0).normalize(),t=Math.atan2(-e.z,e.x)+.5*Math.PI;i.a.release(e),this.angle=Math.lerpAngle(this.angle,t,.1)}this.rotation.y=Math.lerpAngle(this.rotation.y,this.angle,1)}}onMouseMove(){const{size:e}=o.a.viewport,t=r.a.viewID.match(/(dashboard|customization)/g)?1:-1;this.mouse.copy(o.a.mouse.getNormalizedPosition(e));const n=i.a.get().copy(this.position).project(o.a.camera);Number.isNaN(n.x)||(this.mouse.x-=n.x,this.mouse.x*=t,this.mouse.y=Math.clamp(-(this.mouse.y-.5),-.5,1),this.mouse.x=Math.clamp(this.mouse.x,-.75,.75),this.mouse.y=Math.clamp(this.mouse.y,-.75,t>0?.75:.25),i.a.release(n),clearTimeout(this.lookAtTimeout),this.lookAtTimeout=setTimeout(()=>this.lookAtTimeout=null,5e3))}lookAtPointer(){if(r.a.device.hasTouch)return;const e=r.a.viewID.match(/(home|dashboard|customization)/g);!this.isTalking&&e&&this.lookAtTimeout||this.mouse.setScalar(0),this.pointer.lerp(this.mouse,.1),this.setBoneRotation(this.neck.rotation,50,this.pointer),this.setBoneRotation(this.spine.rotation,30,this.pointer)}setBoneRotation(e,t,n){e.y=Math.lerp(e.y,Math.degToRad(n.x*t),1),e.x=Math.lerp(e.x,Math.degToRad(n.y*t),1)}shoot(){if(this.animationAction)return;const e=o.a.assets.animations["Character.glb/SoccerPenaltyKick"].clone();this.animationAction=this.animationMixer.clipAction(e),Object.assign(this.animationAction,{loop:a.bb,clampWhenFinished:!0,weight:1}),this.animationAction.reset(),this.animationAction.play(),this.animationAction.timeScale=1.5;for(const e in this.animations)this.animations[e].stop();this.animationMixer.addEventListener("finished",this.onShootEnd)}onShootEnd(){if(this.animationAction){this.animationAction.stop(),this.animationAction.weight=0,this.animationMixer.uncacheClip(this.animationAction),this.animationAction=null;for(const e in this.animations)this.animations[e].play();this.dispatchEvent({type:"shootEnd"})}}turnAround(){this.previousAnimationName=this.currentAnimation,this.currentAnimation="RightTurn";const e=this.animations[this.currentAnimation];this.startRotation=this.object.rotation.y,Object.assign(e,{timeScale:2,loop:a.bb}),e.reset(),e.play()}onTurnEnd(){"RightTurn"===this.currentAnimation&&(this.currentAnimation=this.previousAnimationName,this.isTurned=!this.isTurned)}setMouthState(e=1){this.material.uniforms.mouthState.value=e}setMedal(){this.material.uniforms.hasMedal.value=!1}}}).call(this,n(6).default)},function(e,t,n){"use strict";t.a="#define STANDARD\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nattribute float shape;\n\nuniform float elapsedTime;\nuniform float mouthState;\nuniform float hasMedal;\nvarying vec3 vEye;\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal = normalize( transformedNormal );\n\n\t#ifdef USE_TANGENT\n\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\n\t#endif\n\n#endif\n\n\t#include <begin_vertex>\n\n\tif (\n\n\t\t( shape > .0 && shape < 4. && shape != mouthState ) ||\n\t\t( shape > 3. && hasMedal < 1. )\n\n\t) {\n\n\t\ttransformed *= 0.;\n\t\ttransformed -= 100000.;\n\n\t}\n\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n\tvEye = normalize( vec3( mvPosition ) );\n\n}\n"},function(e,t,n){"use strict";t.a="#define STANDARD\n\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSMISSION\n#endif\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n\n#ifdef TRANSMISSION\n\tuniform float transmission;\n#endif\n\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <transmissionmap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nuniform float rimPower;\nuniform float rimStrength;\nuniform sampler2D matCap;\nuniform float matCapStrength;\nuniform float colorIndex;\nuniform vec3 mainColor[ 5 ];\nuniform vec3 secondaryColor[ 5 ];\n\nvarying vec3 vEye;\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#ifdef TRANSMISSION\n\t\tfloat totalTransmission = transmission;\n\t#endif\n\n\t#include <logdepthbuf_fragment>\n\n\t#ifdef USE_MAP\n\n\tvec2 coordinates = vUv;\n\n\tcoordinates.x *= .5;\n\tvec4 texelColor = texture2D( map, coordinates );\n\n\tcoordinates.x += .5;\n\tvec4 selection = texture2D( map, coordinates );\n\n\ttexelColor = mapTexelToLinear( texelColor );\n\n\tvec3 main;\n\tvec3 secondary;\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < 5; i ++ ) {\n\n\t\tif ( int( colorIndex ) == UNROLLED_LOOP_INDEX  ) {\n\n\t\t\tmain = mainColor[ i ];\n\t\t\tsecondary = secondaryColor[ i ];\n\n\t\t}\n\n\t}\n\t#pragma unroll_loop_end\n\n\tdiffuseColor.rgb *= selection.r *  main + selection.g * secondary + selection.b * texelColor.rgb;\n\n\t#endif\n\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <transmissionmap_fragment>\n\n\t// accumulation\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n\t// #ifdef USE_MATCAP\n\n\tvec3 viewDirection = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDirection.z, 0.0, - viewDirection.x ) );\n\tvec3 y = cross( viewDirection, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * .495 + 0.5;\n\n\tvec4 matCapColor = texture2D( matCap, uv );\n\toutgoingLight.rgb *= 1. - matCapStrength + matCapColor.rgb * matCapStrength;\n\n\t// #endif\n\n\t// this is a stub for the transmission model\n\t#ifdef TRANSMISSION\n\t\tdiffuseColor.a *= saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n\tfloat rimLight = rimPower * abs( dot( vNormal, normalize( vEye ) ) );\n\trimLight = 1. - smoothstep( .0, 1., rimLight );\n\tgl_FragColor.rgb += vec3( rimLight * rimStrength );\n\n}\n"},function(e,t,n){"use strict";t.a="#define STANDARD\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nuniform float elapsedTime;\nvarying vec3 vEye;\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal = normalize( transformedNormal );\n\n\t#ifdef USE_TANGENT\n\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\n\t#endif\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n\tvEye = normalize( vec3( mvPosition ) );\n\n}\n"},function(e,t,n){"use strict";t.a="#define STANDARD\n\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSMISSION\n#endif\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n\n#ifdef TRANSMISSION\n\tuniform float transmission;\n#endif\n\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <transmissionmap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nuniform float rimPower;\nuniform float rimStrength;\nuniform sampler2D matCap;\nuniform float matCapStrength;\n\nvarying vec3 vEye;\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#ifdef TRANSMISSION\n\t\tfloat totalTransmission = transmission;\n\t#endif\n\n\t#include <logdepthbuf_fragment>\n\n\t#ifdef USE_MAP\n\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n\n\t#endif\n\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <transmissionmap_fragment>\n\n\t// accumulation\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n\t// #ifdef USE_MATCAP\n\n\tvec3 viewDirection = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDirection.z, 0.0, - viewDirection.x ) );\n\tvec3 y = cross( viewDirection, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * .495 + 0.5;\n\n\tvec4 matCapColor = texture2D( matCap, uv );\n\toutgoingLight.rgb *= 1. - matCapStrength + matCapColor.rgb * matCapStrength;\n\n\t// #endif\n\n\t// this is a stub for the transmission model\n\t#ifdef TRANSMISSION\n\t\tdiffuseColor.a *= saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n\tfloat rimLight = rimPower * abs( dot( vNormal, normalize( vEye ) ) );\n\trimLight = 1. - smoothstep( .0, 1., rimLight );\n\tgl_FragColor.rgb += vec3( rimLight * rimStrength );\n\n}\n"},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return d}));var i=n(87),s=n(86),a=n(33),r=n(1),o=n(7),l=n(2),c=n(16),h=n(0);class d extends i.a{constructor(){super(new s.a(.25),new a.a({transparent:!0,opacity:.1,color:"#666666",blending:r.e}),50),e(this),this.instances=[],this.castShadow=!0;for(let e=0,t=50;e<t;e++){const t=new o.a;this.instances.push(t),this.setMatrixAt(e,t.matrixWorld)}this.initialize()}initialize(){this.reset(),this.addEventListeners(),this.instances.forEach((e,t)=>{const n=.35*Math.random(),i=t/this.instances.length*n;e.delay=i,e.duration=n,this.setTween(e,i)})}setTween(e){if(!this.visible)return;const{player:t}=h.a.scene,{delay:n,duration:i}=e;e.position.setX(Math.randFloat(-.2,.2)).setY(.2*Math.random()).setZ(-.1).applyQuaternion(t.quaternion).add(t.position),e.scale.setScalar(Math.random()*t.speed*.05);const s=new l.a;c.a.to(e.scale,i,{...s,delay:n,onComplete:()=>this.setTween(e)})}reset(){}addEventListeners(){h.a.addEventListener("beforeUpdate",this.beforeUpdate)}beforeUpdate(){this.instances.forEach((e,t)=>{e.updateMatrixWorld(),this.setMatrixAt(t,e.matrixWorld)}),this.instanceMatrix.needsUpdate=!0}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c}));var i=n(18),s=n(290),a=n(33),r=n(16),o=n(4),l=n(0);class c extends i.a{constructor(){super(new s.a(.05,.1,16),new a.a({depthTest:!1})),e(this),this.renderOrder=1e5,this.scaleFactor=0,this.visible=!1,l.a.addEventListener("update",this.update)}initialize(){this.initialized||(this.initialized=!0)}destroy(){this.initialized&&(this.initialized=!1)}update(){"home"!==o.a.viewID&&this.destroy(),this.visible="home"===o.a.viewID,this.quaternion.copy(l.a.camera.quaternion);const e=l.a.scene.getPlayerDistance(this.position);this.setActive(this.initialized&&e>2),this.scale.setScalar(this.scaleFactor)}setActive(e){if(this.active===e)return;this.active=e;const t=e?1:0,n=e?"elastic.out":"expo.out",i=e?1:.25;r.a.killTweensOf(this),r.a.to(this,i,{scaleFactor:t,ease:n})}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return f}));var i=n(7),s=n(130),a=n(35),r=n(1),o=n(18),l=n(86),c=n(8),h=n(2),d=n(16),u=n(0),p=n(182),m=n(185);class f extends i.a{constructor(){super(),e(this),this.cylinders=[];for(let e=0,t=4;e<t;e++){const t=.6,n=.6,i=.5+Math.random(-.1,.1),l=32,c=1,h=!0,d=new s.a(t,n,i,l,c,h),u=new a.a({side:r.y}),p=new o.a(d,u);p.rotation.x=.15*(e%2*2-1),p.rotation.order="YXZ",p.scaleFactor=1+.15*e,p.castShadow=!0,p.receiveShadow=!0,this.cylinders.push(p),this.add(p)}const t=new l.a(1,12,12),n=new p.a({transparent:!0});this.sphere=new o.a(t,n),this.add(this.sphere),this.particles=new m.a,this.add(this.particles),u.a.renderer.prerender(this),this.addEventListeners()}addEventListeners(){u.a.addEventListener("update",this.update),u.a.addEventListener("afterRender",this.afterRender)}emit(e="eco-friendly",t){this.scaleFactor=0;const n=u.a.player.position.y+1,i={"eco-friendly":["#ffffff","#783f9a","#fe1779"],accessible:["#ffffff","#274ba0","#d65f24"],connected:["#ffffff","#fed81d","#d6b32d"]}[e];for(let e=0,s=this.cylinders.length;e<s;e++){const s=this.cylinders[e],a=i[e%3];s.material.color.set(a),s.rotation.y=Math.random()*Math.PI*.2,s.position.copy(t).setY(n+Math.randFloat(-.5,.5))}const s=i.map(e=>new c.a(e));this.particles.setPosition(t,s,n),d.a.killTweensOf(this),d.a.to(this,2,{scaleFactor:1,ease:"expo.out"})}update(){const e=h.a.get();e.copy(u.a.player.position),e.y+=1;for(let t=0,n=this.cylinders.length;t<n;t++){const n=this.cylinders[t];n.scale.setScalar(n.scaleFactor*this.scaleFactor).setY(Math.clamp(1-1.05*this.scaleFactor,0,1)),n.rotation.y=this.scaleFactor*Math.PI*2,n.position.lerp(e,.5)}this.sphere.position.copy(e),this.sphere.scale.setScalar(1.05*this.scaleFactor),this.sphere.material.opacity=1-1.05*this.scaleFactor,h.a.release(e)}afterRender(){this.visible=this.scaleFactor>.01}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c}));var i=n(35),s=n(19),a=n(24),r=n(0),o=n(183),l=n(184);class c extends i.a{constructor(t){super(t),e(this),this.type="StandardMaterial",this.vertexShader=o.a,this.fragmentShader=l.a,this.uniforms=Object.assign({rimPower:{value:1},rimStrength:{value:.5}},s.a.clone(a.a.standard.uniforms)),r.a.time.addEventListener("beforeRender",this.beforeRender)}beforeRender(){const{nightVision:e,thermalVision:t,game:n}=r.a.settings;this.uniforms.nightVisionColor.value.set(e.color.value),this.uniforms.thermalVisionColor.value.set(t.color.value),this.uniforms.visionMode.value="ThermalVision"===n.visionMode.value?2:"NightVision"===n.visionMode.value?1:0}}}).call(this,n(6).default)},function(e,t,n){"use strict";t.a="#define STANDARD\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvarying vec3 vEye;\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal = normalize( transformedNormal );\n\n\t#ifdef USE_TANGENT\n\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\n\t#endif\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\tvEye = normalize( vec3( modelViewMatrix * vec4( position, 1. ) ) );\n\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n}\n"},function(e,t,n){"use strict";t.a="#define STANDARD\n\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSMISSION\n#endif\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n\n#ifdef TRANSMISSION\n\tuniform float transmission;\n#endif\n\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <transmissionmap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nuniform float rimPower;\nuniform float rimStrength;\nvarying vec3 vEye;\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#ifdef TRANSMISSION\n\t\tfloat totalTransmission = transmission;\n\t#endif\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <transmissionmap_fragment>\n\n\t// accumulation\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n\t// this is a stub for the transmission model\n\t#ifdef TRANSMISSION\n\t\tdiffuseColor.a *= saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\n\tfloat rimLight = rimPower * abs( dot( vNormal, normalize( vEye ) ) );\n\trimLight = 1. - smoothstep( .0, 1., rimLight );\n\tgl_FragColor.rgb += vec3( rimLight * rimStrength );\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a * rimLight );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n"},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c}));var i=n(87),s=n(86),a=n(35),r=n(7),o=n(2),l=n(0);class c extends i.a{constructor(){super(new s.a(.15),new a.a,25),e(this),this.instances=[],this.receiveShadow=!0,this.castShadow=!0;for(let e=0,t=25;e<t;e++){const t=new r.a;t.position.initial=new o.a,this.instances.push(t),this.setMatrixAt(e,t.matrixWorld)}this.addEventListeners()}addEventListeners(){l.a.addEventListener("beforeUpdate",this.beforeUpdate)}setPosition(e,t,n){const i=o.a.get();for(let s=0,a=this.instances.length;s<a;s++){const a=this.instances[s];a.position.copy(e).setY(n).add(i.randomize(.75*Math.random())),a.position.initial.copy(a.position),a.scaleFactor=Math.randFloat(.25,1),this.setColorAt(s,t[s%3])}this.instanceColor.needsUpdate=!0,o.a.release(i)}beforeUpdate(){if(!this.parent.visible)return;const e=1-this.parent.scaleFactor,t=o.a.get();t.copy(l.a.player.position),t.y+=1;for(let n=0,i=this.instances.length;n<i;n++){const i=this.instances[n];i.position.copy(i.position.initial).lerp(t,this.parent.scaleFactor),i.scale.setScalar(i.scaleFactor*e),i.updateMatrixWorld(),this.setMatrixAt(n,i.matrixWorld)}this.instanceMatrix.needsUpdate=!0,o.a.release(t)}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return h}));var i=n(7),s=n(26),a=n(2),r=n(47),o=n(12),l=n(0),c=n(54);class h extends i.a{constructor(){super(),e(this),this.bodies=[];const{objects:t,textures:n}=l.a.assets,i=t["Park.glb/Blocks"].clone();this.add(i),this.traverse(e=>{if(!e.isMesh)return;const t=e.name.split("_")[1].replace(".png",""),i=n[`canvas.pack/ao_maps/Blocks_${t<5?"001-004":"005-008"}.png`],s=e.geometry.attributes.uv2,a=(t-1)%4,r=a%2,o=Math.floor(a/2);for(let e=0,t=.5*s.array.length;e<t;e++){const t=s.getX(e),n=s.getY(e);s.setX(e,.5*t+.5*r),s.setY(e,.5*n+.5*o)}s.needsUpdate=!0,e.castShadow="Low"!==l.a.version.quality,e.receiveShadow=!0,e.material=new c.a({map:n.Colors,envMap:n.EnvMap,roughness:.95,metalness:.15,aoMap:i})}),this.boundingBox=(new s.a).setFromObject(this),this.size=this.boundingBox.getSize(new a.a),l.a.park=this,l.a.addEventListener("ready",this.initialize)}initialize(){this.setCurve()}setBody(e,t){const n=new o.Body;n.addShape(t),n.position.copy(e);const{Default:i}=l.a.physics.groups;return n.collisionFilterGroup=i,n.collisionFilterMask=i,l.a.physics.add(n),n}setCurve(){const e=l.a.assets.data["canvas.pack/Characters.json"];this.data=e.CollisionCurve_001;const t=this.data.map(e=>(new a.a).fromArray(e));this.curve=new r.a(t,!0),this.points=this.curve.getSpacedPoints(1e3);for(let e=0,t=this.points.length;e<t;e++){const t=this.points[e],n=t,i=this.setBody,a=new o.Sphere,r=(new s.a).expandByScalar(1).translate(n);l.a.broadphase.add({boundingBox:r,collider:a,object:t,position:n,callback:i})}}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c}));var i=n(7),s=n(71),a=n(34),r=n(2),o=n(26),l=n(0);class c extends i.a{constructor(){const{objects:t}=l.a.assets;super(),e(this),this.raycaster=new s.a,this.cells=[],this.boundingBoxes=[],t["Park.glb/Navmesh"].traverse(e=>{if(!e.isMesh)return;e.updateMatrixWorld();const t=(new a.a).fromBufferGeometry(e.geometry).applyMatrix4(e.matrixWorld);this.computeFaceCentroids(t)}),l.a.navigation=this}containsPoint(e,t){return!(t.x<e.min.x)&&(!(t.x>e.max.x)&&(!(t.z<e.min.z)&&!(t.z>e.max.z)))}raycast(e,t,n){let i=[];for(let t=0,n=this.cells.length;t<n;t++){const n=this.boundingBoxes[t],s=this.cells[t];if(!n||!this.containsPoint(n,e))continue;const a=this.intersectsCell(e,s);for(let e=0,t=a.length;e<t;e++)i.push(a[e])}return i.length>1&&void 0!==t&&(i=i.sort((e,t)=>t.y-e.y)),n&&(i=i.reverse()),!!i.length&&i[0]}intersectsCell(e,t){const{ray:n}=this.raycaster,{origin:i,direction:s}=n;i.copy(e).setY(5),s.set(0,-1,0);const a=r.a.get(),o=r.a.get(),l=r.a.get(),c=r.a.get(),h=r.a.get(),d=[];for(let i=0,s=t.length;i<s;i++){const s=t[i];a.copy(s.centroid);const r=Math.abs(e.x-a.x);if(r>10)continue;const u=Math.abs(e.z-a.z);if(u>10)continue;if(Math.sqrt(r*r+u*u)<10){o.copy(s.vertices[0]),l.copy(s.vertices[1]),c.copy(s.vertices[2]);n.intersectTriangle(o,l,c,!1,h)&&d.push(h.clone())}}return r.a.release(a,o,l,c,h),d}computeFaceCentroids(e){for(let t=0,n=e.faces.length;t<n;t++){const n=e.faces[t];n.centroid=new r.a(0,0,0),n.vertices=[],n.centroid.add(e.vertices[n.a]),n.centroid.add(e.vertices[n.b]),n.centroid.add(e.vertices[n.c]),n.centroid.divideScalar(3),n.vertices.push(e.vertices[n.a]),n.vertices.push(e.vertices[n.b]),n.vertices.push(e.vertices[n.c]);const i=this.getCell(n.centroid);this.cells[i]||(this.cells[i]=[]),this.boundingBoxes[i]||(this.boundingBoxes[i]=new o.a),this.cells[i].push(n),this.boundingBoxes[i].expandByPoint(n.vertices[0]),this.boundingBoxes[i].expandByPoint(n.vertices[1]),this.boundingBoxes[i].expandByPoint(n.vertices[2])}return e.faces}getCell(e){const{size:t}=l.a.park;return 10*Math.round(9*(.5*t.x+e.x)/t.x)+Math.round(9*(.5*t.z+e.z)/t.z)}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return a}));var i=n(12),s=n(0);class a{constructor(){e(this),this.body=new i.Body,this.body.mesh=this,this.body.quaternion.setFromAxisAngle(new i.Vec3(1,0,0),.5*-Math.PI),this.body.material=s.a.physics.settings.Ground;const{Default:t,Ball:n}=s.a.physics.groups;this.body.collisionFilterGroup=t,this.body.collisionFilterMask=t|n,this.shape=new i.Plane,this.body.addShape(this.shape),s.a.physics.add(this.body)}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return p}));var i=n(87),s=n(1),a=n(8),r=n(7),o=n(2),l=n(132),c=n(0),h=n(43),d=n(190),u=n(193);class p extends i.a{constructor(){const t=c.a.assets.svgs["canvas.pack/Butterfly.svg"],n=new h.a(t,{flipY:!0}),i=c.a.assets.geometries["Park.glb/Butterfly"],l=new d.a({map:n,transparent:!0,side:s.y});n.rasterize(),super(i,l,5),e(this),this.instances=[],this.colors=[];const p=new a.a,m=["#39CACB","#30cc8d","#f1cc60","#f87c6e"];for(let e=0,t=5;e<t;e++){const t=new r.a;t.scale.setScalar(.1);const n=m[e%m.length];p.set(n),this.colors.push(p.r,p.g,p.b),t.rotation.order="YXZ",t.rotation.x=.35*-Math.PI,t.rotation.y=Math.random()*Math.PI*2,t.velocity=new o.a,t.velocity.x=Math.sin(t.rotation.y),t.velocity.z=Math.cos(t.rotation.y),t.velocity.multiplyScalar(.05),Object.assign(t,{height:Math.randInt(3,5),heightA:Math.random(),heightB:Math.random(),speedA:Math.randFloat(.1,.5),speedB:Math.randFloat(1,2)}),this.instances.push(t)}this.castShadow=!0,this.customDepthMaterial=new u.a,this.setCustomAttributes(),c.a.addEventListener("ready",this.initialize)}setCustomAttributes(){if(!this.colors)return;const e=new l.a(new Float32Array(this.colors),3);this.geometry.setAttribute("color",e)}initialize(){this.reset(),this.addEventListeners(),this.instances.forEach(e=>this.setPosition(e,!0))}reset(){}addEventListeners(){c.a.addEventListener("beforeUpdate",this.beforeUpdate)}setPosition(e,t){const{player:n}=c.a.scene;e.position.copy(n.position);const i=Math.randFloat(t?0:15,25)*Math.randomSign(),s=Math.randFloat(t?0:15,25)*Math.randomSign();e.position.x+=i,e.position.z+=s}beforeUpdate(){this.visible&&(this.instances.forEach((e,t)=>{e.updateMatrixWorld(),e.position.add(e.velocity);const{elapsedTime:n}=c.a.time,{heightA:i,heightB:s,speedA:a,speedB:r}=e;e.position.y=e.height,e.position.y+=1*Math.sin(i+n*a),e.position.y+=.1*Math.sin(s+n*r);c.a.scene.getPlayerDistance(e.position)>25&&this.setPosition(e),this.setMatrixAt(t,e.matrixWorld)}),this.instanceMatrix.needsUpdate=!0)}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c}));var i=n(33),s=n(19),a=n(24),r=n(0),o=n(191),l=n(192);class c extends i.a{constructor(t={}){super(t),e(this),this.type="BasicMaterial",this.vertexShader=o.a,this.fragmentShader=l.a,this.uniforms=Object.assign({elapsedTime:{value:0},wingSpeed:{value:4}},s.a.clone(a.a.basic.uniforms)),r.a.addEventListener("beforeUpdate",this.beforeUpdate)}beforeUpdate(){this.uniforms.elapsedTime.value=r.a.time.elapsedTime}}}).call(this,n(6).default)},function(e,t,n){"use strict";t.a="#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nattribute vec3 color;\n\nuniform float elapsedTime;\nuniform float speed;\n\nvarying vec3 vColor;\n\nvoid main() {\n\n\tvColor = color;\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\n\t#ifdef USE_ENVMAP\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n\t#endif\n\n\t#include <begin_vertex>\n\n\tfloat direction = abs( transformed.x );\n\n\tif ( abs( transformed.x ) > .2 ) {\n\n\t\tfloat angle = ( 1. + sin( elapsedTime * 50. ) ) * .5 * PI * .5;\n\n\t\ttransformed.x = cos( angle ) * sign( transformed.x );\n\t\ttransformed.y = sin( angle ) * 1.;\n\n\t}\n\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n\n}\n"},function(e,t,n){"use strict";t.a="uniform vec3 diffuse;\nuniform float opacity;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvarying vec3 vColor;\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\n\t#ifdef USE_MAP\n\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\ttexelColor.rgb *= vColor;\n\tdiffuseColor *= texelColor;\n\n\t#endif\n\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\n\t// accumulation (baked indirect lighting only)\n\t#ifdef USE_LIGHTMAP\n\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\n\t#else\n\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\n\t#endif\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\n\t#include <envmap_fragment>\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n"},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c}));var i=n(128),s=n(19),a=n(24),r=n(0),o=n(194),l=n(195);class c extends i.a{constructor(t={}){super(t),e(this),this.type="DepthMaterial",this.vertexShader=o.a,this.fragmentShader=l.a,this.uniforms=Object.assign({elapsedTime:{value:0}},s.a.clone(a.a.depth.uniforms)),r.a.addEventListener("beforeUpdate",this.beforeUpdate)}beforeUpdate(){this.uniforms.elapsedTime.value=r.a.time.elapsedTime}}}).call(this,n(6).default)},function(e,t,n){"use strict";t.a="#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\n// This is used for computing an equivalent of gl_FragCoord.z that is as high precision as possible.\n// Some platforms compute gl_FragCoord at a lower precision which makes the manually computed value better for\n// depth-based postprocessing effects. Reproduced on iPad with A10 processor / iPadOS 13.3.1.\nvarying vec2 vHighPrecisionZW;\n\nuniform float elapsedTime;\nuniform float speed;\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\t#include <skinbase_vertex>\n\n\t#ifdef USE_DISPLACEMENTMAP\n\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\n\t#endif\n\n\t#include <begin_vertex>\n\n\tfloat direction = abs( transformed.x );\n\n\tif ( abs( transformed.x ) > .2 ) {\n\n\t\tfloat angle = ( 1. + sin( elapsedTime * 50. ) ) * .5 * PI * .5;\n\n\t\ttransformed.x = cos( angle ) * sign( transformed.x );\n\t\ttransformed.y = sin( angle ) * 1.;\n\n\t}\n\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvHighPrecisionZW = gl_Position.zw;\n\n}\n"},function(e,t,n){"use strict";t.a="// #if DEPTH_PACKING == 3200\n\n// \tuniform float opacity;\n\n// #endif\n\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvarying vec2 vHighPrecisionZW;\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( 1.0 );\n\n\t// #if DEPTH_PACKING == 3200\n\n\t// \tdiffuseColor.a = opacity;\n\n\t// #endif\n\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\n\t#include <logdepthbuf_fragment>\n\n\t// Higher precision equivalent of gl_FragCoord.z. This assumes depthRange has been left to its default values.\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\n\t// #if DEPTH_PACKING == 3200\n\n\t\t// gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\n\t// #elif DEPTH_PACKING == 3201\n\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\n\t// #endif\n\n}\n"},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return d}));var i=n(7),s=n(2),a=n(47),r=n(1),o=n(18),l=n(0),c=n(198),h=n(197);class d extends i.a{constructor(){super(),e(this);for(let e=0;e<2;e++){const e=[],t=5,n=35,i=n/t;for(let a=0,r=t;a<r;a++){const t=.5*-n+a*i,r=Math.randFloat(0,2.5),o=Math.randFloat(-2.5,2.5),l=new s.a(t,r,o);e.push(l)}const l=new a.a(e),d=new h.a(l.getPoints(500)),u=new c.a({lineWidth:.15,depthTest:!1,side:r.y,transparent:!0}),p=new o.a(d,u);p.position.x=Math.randFloat(-100,100),p.position.z=Math.randFloat(-100,100),p.timeOffset=Math.random(),p.speed=Math.randFloat(.45,.65),this.add(p)}l.a.addEventListener("ready",this.initialize)}initialize(){this.addEventListeners()}addEventListeners(){l.a.addEventListener("beforeUpdate",this.beforeUpdate)}beforeUpdate(){if(!this.visible)return;const{radiusFactor:e}=l.a.camera.controls,{elapsedTime:t}=l.a.time;this.children.forEach(n=>{const{position:i,material:s,timeOffset:a,speed:r}=n,o=Math.euclideanModulo((t+a)*r,1);s.opacity=.35*(1-e),s.uniforms.elapsedTime.value=o,o<.01&&(i.copy(l.a.scene.player.position),i.x+=Math.randFloat(-25,25),i.z+=Math.randFloat(-25,25))})}}}).call(this,n(6).default)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(15),s=n(5);class a extends i.a{constructor(e){super(),this.vertices=[],this.positions=[],this.previous=[],this.next=[],this.widths=[],this.sides=[],this.indices=[],this.uvs=[],this.counters=[],this.lineDistances=[],this.thicknesses=[];for(let t=0,n=e.length;t<n;t++){const n=t/e.length;this.vertices.push(e[t]),this.counters.push(n,n)}this.process(),this.update()}setWidth(e){const t=1/this.vertices.length;for(let n=0,i=this.vertices.length;n<i;n++)this.widths[2*n]=this.widths[2*n+1]=e(n*t)}update(){for(let e=0,t=this.vertices.length;e<t;e++){const t=this.vertices[e],n=this.vertices[e-1]||t,i=this.vertices[e+1]||t;this.positions[6*e+0]=this.positions[6*e+3]=t.x,this.positions[6*e+1]=this.positions[6*e+4]=t.y,this.positions[6*e+2]=this.positions[6*e+5]=t.z,this.previous[6*e+0]=this.previous[6*e+3]=n.x,this.previous[6*e+1]=this.previous[6*e+4]=n.y,this.previous[6*e+2]=this.previous[6*e+5]=n.z,this.next[6*e+0]=this.next[6*e+3]=i.x,this.next[6*e+1]=this.next[6*e+4]=i.y,this.next[6*e+2]=this.next[6*e+5]=i.z}this.attributes.position?(this.attributes.position.copyArray(this.positions),this.attributes.previous.copyArray(this.previous),this.attributes.next.copyArray(this.next),this.attributes.width.copyArray(this.widths),this.attributes.position.needsUpdate=!0,this.attributes.previous.needsUpdate=!0,this.attributes.next.needsUpdate=!0,this.attributes.width.needsUpdate=!0):(this.setAttribute("position",this.getBufferAttribute(this.positions,3)),this.setAttribute("previous",this.getBufferAttribute(this.previous,3)),this.setAttribute("next",this.getBufferAttribute(this.next,3)))}getTotalLineDistance(){return this.lineDistances[this.lineDistances.length-1]}getBufferAttribute(e,t){return new s.a(new Float32Array(e),t)}process(){const e=1/this.vertices.length;for(let t=0,n=this.vertices.length;t<n;t++)this.sides.push(1,-1),this.widths.push(1,1),this.uvs.push(t*e,0,t*e,1);for(let e=0;e<this.vertices.length-1;e++){const t=2*e;this.indices.push(t,t+1,t+2),this.indices.push(t+2,t+1,t+3)}this.setAttribute("side",this.getBufferAttribute(this.sides,1)),this.setAttribute("width",this.getBufferAttribute(this.widths,1)),this.setAttribute("uv",this.getBufferAttribute(this.uvs,2)),this.setAttribute("counters",this.getBufferAttribute(this.counters,1)),this.setIndex(new s.a(new Uint16Array(this.indices),1))}}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c}));var i=n(35),s=n(19),a=n(24),r=n(0),o=n(199),l=n(200);class c extends i.a{constructor(t={}){c.prototype.lineWidth=1,super(t),e(this),this.type="StandardMaterial",this.vertexShader=o.a,this.fragmentShader=l.a,this.uniforms=Object.assign({elapsedTime:{value:0},lineWidth:{value:t.lineWidth||1}},s.a.clone(a.a.standard.uniforms)),r.a.time.addEventListener("update",this.update)}update(){}}}).call(this,n(6).default)},function(e,t,n){"use strict";t.a="#define STANDARD\n\nvarying vec2 vUv;\n\nuniform mat3 uvTransform;\n\nattribute float count;\nattribute float progress;\nattribute float data;\n\nattribute vec3 previous;\nattribute vec3 next;\nattribute float side;\nattribute float counters;\n\nuniform float lineWidth;\nuniform float elapsedTime;\n\nvec3 getExtrusion() {\n\n\tvec3 T = normalize( next - position );\n\tvec3 B = normalize( cross( T, next + position ) );\n\tvec3 N = normalize( cross( B, T ) );\n\n\treturn normalize( B + N );\n\n}\nvoid main() {\n\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\n\t#include <begin_vertex>\n\n\tvec3 extrusion = vec3( .0, 1., .0 );\n\ttransformed += extrusion * lineWidth * .5 * side;\n\n\t#include <project_vertex>\n\n}\n"},function(e,t,n){"use strict";t.a="uniform float elapsedTime;\nuniform float opacity;\n\nvarying vec2 vUv;\nvarying float vData;\n\nvoid main() {\n\n\tfloat progress = elapsedTime;\n\tfloat alpha = 1. - clamp( abs( progress - vUv.x ) * 5., .0, 1. );\n\tfloat border = 1. - abs( vUv.x * 2. - 1. ) * 1.;\n\tgl_FragColor = vec4( vec3( 1. ), alpha * opacity * border );\n\n}\n"},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return l}));var i=n(2),s=n(47),a=n(0),r=n(14),o=n(104);class l extends o.a{constructor(){super(),e(this),this.gameID="cycling",a.a.cycling=this}addEventListeners(){super.addEventListeners(),a.a.mouse.addEventListener("down",this.onInput),a.a.multiTouch.addEventListener("touchStart",this.onInput),a.a.keyboard.addEventListener("keyDown",this.onInput)}removeEventListeners(){super.removeEventListeners(),a.a.mouse.removeEventListener("down",this.onInput),a.a.multiTouch.removeEventListener("touchStart",this.onInput),a.a.keyboard.removeEventListener("keyDown",this.onInput)}initialize(){this.setCurve(),this.reset(),super.initialize()}stop(e){this.score>=5&&r.a.setAchievement("yellow-jersey"),r.a.cycling.games++,r.a.cycling.best=Math.max(r.a.cycling.best,this.score),super.stop(e),a.a.camera.controls.friction=.05}reset(){super.reset(),this.progress=.2,this.lastTime=0,this.elapsedTime=0,this.acceleration=0,this.score=0,this.distance=0,this.setPosition(!0)}setCurve(){const e=a.a.assets.data["canvas.pack/Characters.json"];this.data=e.Cycling;const t=this.data.map(e=>(new i.a).fromArray(e));this.curve=new s.a(t,!0)}beforeUpdate(){super.beforeUpdate(),this.initialized&&(this.setPosition(),this.setPoint(),this.started&&(this.setTime(),this.setScore()))}setScore(){this.dispatchEvent({type:"scoreUpdate",score:this.score})}setPosition(e=!1){this.acceleration*=.999,this.acceleration=Math.clamp(this.acceleration,0,1/0),this.progress+=1e-4*this.acceleration*.6,this.distance+=1e-4*this.acceleration*.6,this.score=(1.2*this.distance).toFixed(1),this.progress=Math.euclideanModulo(this.progress,1);const{controls:t}=a.a.camera;t.friction=Math.mapLinear(this.acceleration,0,4,.05,.15),t.friction=Math.clamp(t.friction,.05,.15);const n=i.a.get(),s=i.a.get();this.curve.getPointAt(this.progress,n),a.a.player.body.position.set(n.x,0,n.z),this.curve.getTangentAt(this.progress,s);const r=Math.atan2(-s.z,s.x)+.5*Math.PI;a.a.player.rotation.y=Math.lerpAngle(a.a.player.rotation.y,r,.25),e&&(t.setCameraTarget(a.a.player.body.position),t.setAngle(r)),i.a.release(n,s)}setPoint(){this.elapsedTime+=a.a.time.deltaTime*(4+.5*this.acceleration),this.value=Math.sin(this.elapsedTime),this.dispatchEvent({type:"pointUpdate",value:this.value})}onInput(){if(!this.started)return;const e=Math.abs(this.value)>.35;this.acceleration+=e?-.15:.25,a.a.audio.play(e?"CyclingFailed":"CyclingSucceed",{volume:.5}),this.dispatchEvent({type:"input",failed:e})}}}).call(this,n(6).default)},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n(2),s=n(0),a=n(14),r=n(4),o=n(104),l=n(211),c=n(203),h=n(204);class d extends o.a{constructor(){super(),this.gameID="soccer",s.a.soccer=this,this.speed=2,this.maxAngle=.25,this.direction=new i.a,this.target=new c.a,this.add(this.target),this.helpers=new h.a,this.add(this.helpers),this.balls=Array.from({length:10},()=>{const e=new l.a;return e.visible=!1,this.add(e),e})}addEventListeners(){super.addEventListeners(),s.a.mouse.addEventListener("down",this.onInputDown),s.a.multiTouch.addEventListener("touchStart",this.onInputDown),s.a.keyboard.addEventListener("keyDown",this.onInputDown),s.a.mouse.addEventListener("up",this.onInputUp),s.a.multiTouch.addEventListener("touchEnd",this.onInputUp),s.a.keyboard.addEventListener("keyUp",this.onInputUp),this.player.addEventListener("shootEnd",this.onShootEnd),this.target.addEventListener("touched",this.onTargetTouched),this.target.addEventListener("change",this.onTargetChange)}removeEventListeners(){super.removeEventListeners(),s.a.mouse.removeEventListener("down",this.onInputDown),s.a.multiTouch.removeEventListener("touchStart",this.onInputDown),s.a.keyboard.removeEventListener("keyDown",this.onInputDown),s.a.mouse.removeEventListener("up",this.onInputUp),s.a.multiTouch.removeEventListener("touchEnd",this.onInputUp),s.a.keyboard.removeEventListener("keyUp",this.onInputUp),this.player.removeEventListener("shootEnd",this.onShootEnd),this.target.removeEventListener("touched",this.onTargetTouched),this.target.removeEventListener("change",this.onTargetChange)}initialize(){super.initialize(),this.reset()}start(){super.start(),this.target.show()}stop(e){this.score>=10&&a.a.setAchievement("like-christiano"),super.stop(e),this.target.hide()}reset(){super.reset(),this.strength=0,this.elapsedTime=0,this.isShooting=!1,this.isDown=!1,this.balls.forEach(e=>e.visible=!1),this.target.reset(),this.setPosition(),this.setNewBall()}beforeUpdate(){if(super.beforeUpdate(),!this.initialized)return;if(this.started){this.setTime();const e=i.a.get();this.player.rightFoot.getWorldPosition(e),e.sub(this.ball.body.position);e.length()<.75&&this.shoot(),i.a.release(e)}if(this.isShooting)return;const e=this.isDown?1:0,t=this.isDown?.025:.1;this.strength=Math.lerp(this.strength,e,t);const{deltaTime:n}=s.a.time;this.isDown||(this.elapsedTime+=n*this.speed,this.angle=Math.sin(this.elapsedTime)*this.maxAngle)}setPosition(){const{objects:e}=s.a.assets,t=e["Park.glb/Penalty"],n=e["Park.glb/Goal"];this.direction.copy(n.position).sub(t.position).normalize();const i=Math.atan2(-this.direction.z,this.direction.x)+.5*Math.PI;this.player.body.position.copy(t.position);const{controls:a}=s.a.camera;a.setCameraTarget(this.player.body.position),a.setAngle(i)}setNewBall(){const{objects:e}=s.a.assets,t=e["Park.glb/Ball"].position;this.ball=this.balls.getLast(),t.setY(this.player.position.y+this.ball.radius),this.ball.startTime=s.a.time.elapsedTime,this.ball.isActive=s.a.time.elapsedTime,this.ball.visible=!0,this.ball.body.velocity.set(0,0,0),this.ball.body.angularVelocity.set(0,0,0),this.ball.body.position.copy(t),this.balls.unshift(this.balls.pop())}onInputDown(){if(this.isShooting)return;if(!this.started)return;const e=s.a.multiTouch.getTouch()||s.a.mouse,{x:t,y:n}=e.currentPosition;s.a.isOverCanvas(t,n)&&(this.isDown=!0,this.strength+=.05)}onInputUp(){this.isShooting||this.started&&this.isDown&&(this.isDown=!1,this.isShooting=!0,this.shotStartTime=s.a.time.elapsedTime,this.player.shoot())}shoot(){if(this.ball.startTime>this.shotStartTime||"game"!==r.a.viewID)return;setTimeout(()=>this.isShooting=!1,500);const e=this.helpers.rotation.y+Math.PI+this.angle,t=i.a.get().setX(Math.sin(e)).setY(Math.sin(.5*this.strength)).setZ(Math.cos(e)).multiplyScalar(45);this.ball.body.velocity.copy(t),s.a.audio.play("SoccerShoot"),i.a.release(t)}onShootEnd(){setTimeout(()=>this.isShooting=!1,500),this.isDown=!1,this.setNewBall()}onTargetTouched(){this.score++,this.dispatchEvent({type:"scoreUpdate",score:this.score})}onTargetChange(){this.helpers.setPosition(this.target.position)}}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return h}));var i=n(18),s=n(35),a=n(2),r=n(12),o=n(16),l=n(0),c=n(43);class h extends i.a{constructor(){const{materials:t,textures:n,geometries:i}=l.a.assets;if(!t.Target){const e=l.a.assets.svgs["canvas.pack/Target.svg"],i=new c.a(e);i.rasterize(),t.Target=new s.a({map:i,envMap:n.EnvMap,roughness:.95,metalness:.05})}const o=i["Park.glb/Circle"];super(o,t.Target),e(this);const{halfExtents:h}=l.a.physics.getHalfExtents(o);this.halfExtents=h,this.halfExtents.z=.5,this.shape=new r.Box(h),this.name="Target",this.position.initial=new a.a,this.body=new r.Body,this.body.mesh=this,this.body.collisionResponse=!1,this.body.addShape(this.shape),l.a.physics.add(this.body);const{Default:d,Ball:u}=l.a.physics.groups;this.body.collisionFilterGroup=d,this.body.collisionFilterMask=u,this.castShadow=!0,this.receiveShadow=!0,l.a.addEventListener("ready",this.initialize)}initialize(){this.reset(),this.addEventListeners()}reset(){this.scaleFactor=1,this.scale.setScalar(.001)}show(){this.setPosition(),this.setShape()}hide(){const e=(new a.a).setScalar(.001);o.a.to(this.scale,1,{...e,ease:"expo.out"})}addEventListeners(){this.body.addEventListener("collide",this.onCollide),l.a.addEventListener("beforeUpdate",this.beforeUpdate)}beforeUpdate(){this.visible=this.scale.length()>.01,this.body.disabled=!this.visible,this.quaternion.copy(l.a.camera.quaternion),this.body.position.copy(this.position),this.body.quaternion.copy(this.quaternion)}setPosition(){const{objects:e,geometries:t}=l.a.assets,n=e["Park.glb/Goal"],i=t["Park.glb/Goal"];this.size||(this.size=new a.a,n.updateMatrixWorld(),i.computeBoundingBox(),i.boundingBox.getSize(this.size));const{min:s,max:r}=i.boundingBox;this.position.x=Math.lerp(s.x,r.x,Math.random()),this.position.y=Math.lerp(s.y,r.y,Math.random()),this.position.z=Math.lerp(s.z,r.z,Math.random()),this.position.applyMatrix4(n.matrixWorld),this.direction=Math.random()>.5?"x":"y",this.position.initial.copy(this.position);const c=(new a.a).setScalar(this.scaleFactor);o.a.to(this.scale,1,{...c,ease:"elastic.out"})}onCollide({body:e}){if("Ball"!==e.mesh.name||!e.mesh.isActive)return;const t=(new a.a).setScalar(.001);o.a.to(this.scale,.25,{...t,ease:"expo.out",onComplete:()=>{this.setPosition(),this.setShape()}}),this.dispatchEvent({type:"touched"}),this.scaleFactor-=.025,l.a.audio.play("SoccerTarget")}setShape(){this.scaleFactor=Math.clamp(this.scaleFactor,.15,1);const e=a.a.get().copy(this.halfExtents).multiplyScalar(this.scaleFactor);this.body.shapes=[],this.shape=new r.Box((new r.Vec3).copy(e)),this.body.addShape(this.shape),this.dispatchEvent({type:"change"}),a.a.release(e)}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c}));var i=n(7),s=n(2),a=n(0),r=n(205),o=n(209),l=n(210);class c extends i.a{constructor(){super(),e(this),this.object=new i.a,this.add(this.object),this.arrow=new r.a,this.object.add(this.arrow),this.ring=new o.a,this.add(this.ring),this.point=new l.a;const{objects:t}=a.a.assets;this.position.copy(t["Park.glb/Ball"].position),a.a.addEventListener("ready",this.initialize)}initialize(){this.addEventListeners()}addEventListeners(){a.a.addEventListener("update",this.update)}update(){this.visible=a.a.soccer.initialized;const{strength:e}=a.a.soccer;this.rotation.y=this.angle,this.object.rotation.x=.2*e}setPosition(e){const t=s.a.get().copy(e).setY(0).sub(this.position).normalize();this.angle=Math.atan2(-t.z,t.x)-.5*Math.PI,s.a.release(t)}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return l}));var i=n(18),s=n(1),a=n(0),r=n(43),o=n(206);class l extends i.a{constructor(){const{geometries:t,svgs:n,materials:i,textures:l}=a.a.assets,c=n["canvas.pack/Gradient.svg"],h=new r.a(c,{flipY:!1});h.rasterize();const d=new r.a(n["canvas.pack/Arrow.svg"]);d.rasterize(),i.Arrow=new o.a({map:d,gradientMap:h,transparent:!0,shadowSide:s.H,envMap:l.EnvMap,roughness:.95,metalness:.15});super(t["Park.glb/Arrow"],i.Arrow),e(this),this.castShadow=!0,this.receiveShadow=!0,a.a.addEventListener("ready",this.initialize)}initialize(){this.reset(),this.addEventListeners()}reset(){}addEventListeners(){a.a.addEventListener("beforeUpdate",this.beforeUpdate)}beforeUpdate(){const{strength:e,angle:t}=a.a.soccer;this.material.uniforms.strength.value=e,this.rotation.y=t}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c}));var i=n(35),s=n(19),a=n(24),r=n(0),o=n(207),l=n(208);class c extends i.a{constructor(t={}){c.prototype.gradientMap=null,super(t),e(this),this.type="StandardMaterial",this.vertexShader=o.a,this.fragmentShader=l.a,this.uniforms=Object.assign({elapsedTime:{value:0},gradientMap:{value:t.gradientMap},strength:{value:0}},s.a.clone(a.a.standard.uniforms)),r.a.addEventListener("beforeUpdate",this.beforeUpdate)}beforeUpdate(){this.uniforms.elapsedTime.value=r.a.time.elapsedTime}}}).call(this,n(6).default)},function(e,t,n){"use strict";t.a="#define STANDARD\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nuniform float elapsedTime;\nvarying vec2 vGradientUV;\n\nvoid main() {\n\n\tvGradientUV = uv;\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal = normalize( transformedNormal );\n\n\t#ifdef USE_TANGENT\n\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\n\t#endif\n\n#endif\n\n\t#include <begin_vertex>\n\n\tif ( transformed.z >= .0 ) transformed.x *= .95;\n\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n}\n"},function(e,t,n){"use strict";t.a="#define STANDARD\n\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSMISSION\n#endif\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n\n#ifdef TRANSMISSION\n\tuniform float transmission;\n#endif\n\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <transmissionmap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nuniform float strength;\nuniform sampler2D gradientMap;\nvarying vec2 vGradientUV;\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#ifdef TRANSMISSION\n\t\tfloat totalTransmission = transmission;\n\t#endif\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <transmissionmap_fragment>\n\n\t// accumulation\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n\t// this is a stub for the transmission model\n\t#ifdef TRANSMISSION\n\t\tdiffuseColor.a *= saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\n\tfloat alpha = clamp( vGradientUV.y, .75, 1. ) * diffuseColor.a;\n\n\tvec4 gradient = texture2D( gradientMap, vGradientUV );\n\toutgoingLight = 1. - vGradientUV.y > strength ? vec3( 1. ) : gradient.rgb;\n\tgl_FragColor = vec4( outgoingLight, alpha );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n"},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o}));var i=n(18),s=n(290),a=n(33),r=n(0);class o extends i.a{constructor(){const t=-r.a.soccer.maxAngle,n=2*r.a.soccer.maxAngle,i=new s.a(4.5,4.75,16,1,t,n),o=new a.a;i.rotateX(.5*-Math.PI),i.rotateY(.5*Math.PI),super(i,o),e(this),this.receiveShadow=!0}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return r}));var i=n(18),s=n(298),a=n(33);class r extends i.a{constructor(){const t=new s.a(.1,16),n=new a.a;t.rotateX(.5*-Math.PI),super(t,n),e(this),this.position.set(0,0,-4.75),this.receiveShadow=!0}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return l}));var i=n(18),s=n(2),a=n(12),r=n(0),o=n(54);class l extends i.a{constructor(){const{geometries:t,materials:n,textures:i}=r.a.assets;n.Ball||(n.Ball=new o.a({map:i.Colors,envMap:i.EnvMap,roughness:.95,metalness:.15}));super(t["Park.glb/BallSoccer_001"],n.Ball),e(this);const l=(new s.a).randomize(),c=Math.random()*Math.PI*2,h=new a.Sphere(.25);this.name="Ball",this.radius=.25,this.body=new a.Body({mass:.01}),this.body.mesh=this,this.body.quaternion.setFromAxisAngle(l,c),this.body.material=r.a.physics.settings.Ball,this.body.addShape(h),r.a.physics.add(this.body);const{Default:d,Ball:u,OnlyBall:p}=r.a.physics.groups;this.body.collisionFilterGroup=u,this.body.collisionFilterMask=d|u|p,this.castShadow=!0,this.receiveShadow=!0,r.a.addEventListener("ready",this.initialize)}initialize(){this.body.material=r.a.physics.settings.Ball,this.addEventListeners()}addEventListeners(){r.a.addEventListener("beforeUpdate",this.beforeUpdate)}beforeUpdate(){this.body.disabled=!this.visible,this.position.copy(this.body.position),this.quaternion.copy(this.body.quaternion)}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return l}));var i=n(51),s=n(16),a=n(0),r=n(216),o=n(105);class l extends o.a{constructor(){super(new i.a,new r.a),e(this),this.name="Overlay",this.renderOrder=1e9,this.progress=0,Object.assign(this.material,{depthTest:!1,depthWrite:!1,transparent:!0}),this.material.color.set("#ffffff"),a.a.addEventListener("beforeRender",this.beforeRender)}beforeRender(){if(this.progress>.99)return void(this.visible=!1);this.material.uniforms.progress.value=this.progress;const{width:e,height:t}=a.a.viewport;this.setSize(e,t)}hide(){s.a.to(this,1.5,{progress:1,ease:"expo.inOut"})}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c}));var i=n(33),s=n(19),a=n(24),r=n(0),o=n(214),l=n(215);class c extends i.a{constructor(t){super(t),e(this),this.type="StandardMaterial",this.vertexShader=o.a,this.fragmentShader=l.a,this.uniforms=Object.assign({pixelRatio:{value:r.a.renderer.pixelRatio},resolution:{value:r.a.viewport.size}},s.a.clone(a.a.standard.uniforms)),this.depthTest=!1,this.fog=!1,r.a.addEventListener("beforeRender",this.beforeRender)}beforeRender(){this.uniforms.pixelRatio.value=r.a.renderer.pixelRatio,this.uniforms.resolution.value=r.a.viewport.size}}}).call(this,n(6).default)},function(e,t,n){"use strict";t.a="uniform vec2 resolution;\n\nvoid main() {\n\n\tgl_Position = modelMatrix * vec4( position, 1. );\n\tgl_Position.xy /= resolution * .5;\n\n}\n"},function(e,t,n){"use strict";t.a="uniform vec3 diffuse;\nuniform float opacity;\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tgl_FragColor = diffuseColor;\n\n}\n"},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c}));var i=n(33),s=n(19),a=n(24),r=n(0),o=n(217),l=n(218);class c extends i.a{constructor(t){super(t),e(this),this.type="StandardMaterial",this.vertexShader=o.a,this.fragmentShader=l.a,this.uniforms=Object.assign({pixelRatio:{value:r.a.renderer.pixelRatio},resolution:{value:r.a.viewport.size},progress:{value:0}},s.a.clone(a.a.standard.uniforms)),this.depthTest=!1,r.a.addEventListener("beforeRender",this.beforeRender)}beforeRender(){this.uniforms.pixelRatio.value=r.a.renderer.pixelRatio,this.uniforms.resolution.value=r.a.viewport.size}}}).call(this,n(6).default)},function(e,t,n){"use strict";t.a="uniform mat3 uvTransform;\nuniform vec2 resolution;\nvarying vec2 vUv;\n\nvoid main() {\n\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\n\tgl_Position = modelMatrix * vec4( position, 1. );\n\tgl_Position.xy /= resolution * .5;\n\n}\n"},function(e,t,n){"use strict";t.a="varying vec2 vUv;\n\nuniform float progress;\nuniform vec2 resolution;\n\nfloat circle( vec2 coordinates, float radius ){\n\n\treturn length( coordinates ) - radius;\n\n}\n\nfloat getAlpha() {\n\n\tfloat aspect = resolution.x / resolution.y;\n\tvec2 normalized = ( vUv * 2. - 1. ) / 3.;\n\tnormalized.x *= aspect;\n\n\tfloat distance = circle( normalized, progress );\n\t// float distanceChange = fwidth( distance ) * .5;\n\t// return 1. - smoothstep( distanceChange, -distanceChange, distance );\n\t return distance > 0. ? 1.: 0.;\n\n}\n\nvoid main() {\n\n\tfloat alpha = getAlpha();\n\tgl_FragColor = vec4( vec3( 1. ), alpha );\n\n}\n"},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return p}));var i=n(7),s=n(4),a=n(0),r=n(14),o=n(221),l=n(220),c=n(228);const h={},{overview:d}=content.global;for(let e=0,t=d.length;e<t;e++){const t=d[e].replace(/(&| |\/)/g,"");h[t]=d[e]}const u={ClubHouse:["ClubHouse"],PerformanceCenter:["SportsPerformanceCenter"],TheQuad:["CentralLawn","Skatepark","VideoApp","VideoBrandFilm"],TheFitnessComplex:["FitnessCenter"],TheAthleticCenter:["SportsCenter","VideoItw1"],TheHub:["ServicesBuilding"],SoccerRugbyPitch:["GameSoccer","SoccerRugby"],SwimmingPool:["SwimmingPool","VideoItw3"],PlaygroundTrack:["GameCycling","RunningCycling","VideoItw2"],TheCourts:["BasketballSoccerFive"],TennisPadel:["Tennis","Mosque"]};class p extends i.a{constructor(t){super(),e(this),t.updateMatrixWorld(!0);const n=t.name.split("-");this.index=parseInt(n[0].replace("Area_","")),this.areaID=n[1],this.visited=!!r.a.areas[this.areaID],this.hitBox=new l.a(t),this.add(this.hitBox);const i=n[0].split("_")[1],s=t.getObjectByName("Name_"+i);this.bubble=new o.a(s,h[this.areaID]),this.add(this.bubble),this.characterIDs={},t.traverse(e=>{if(e.name.match(/Hover/g)){const t=new c.a(e);this.add(t)}else e.name.match(/Teleporter/g)&&(this.teleporter=e.position)}),a.a.addEventListener("ready",this.initialize)}initialize(){this.addEventListeners()}addEventListeners(){a.a.addEventListener("click",this.onClick),a.a.addEventListener("beforeUpdate",this.beforeUpdate)}beforeUpdate(){const{areas:e}=a.a.settings.visibility;this.visible=e.value;Object.keys(r.a.areas).length===a.a.scene.areas.length&&r.a.setAchievement("guide"),r.a.areas[this.areaID]&&this.bubble.exclamation.activate(!1),this.setVisitedState()}onClick(){this.isHovered&&(s.a.router.navigate(),a.a.audio.play("Click"),a.a.player.body.position.copy(this.teleporter))}setVisitedState(){if(!!u[this.areaID].filter(e=>!r.a.characters[e]).length||this.visited)return;this.visited=!0,r.a.areas[this.areaID]=!0;Object.keys(r.a.areas).length>=3&&r.a.setAchievement("explorer")}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return h}));var i=n(7),s=n(71),a=n(2),r=n(23),o=n(12),l=n(4),c=n(0);class h extends i.a{constructor(t){super(),e(this),this.raycaster=new s.a,t.traverse(e=>{if(!e.name.match("HitBox"))return;const t=new o.Body;t.collisionResponse=!1,t.mesh=this;const n=new a.a,i=new r.a;e.getWorldPosition(n),e.getWorldQuaternion(i),t.position.copy(n),t.quaternion.copy(i),t.addEventListener("collide",this.onCollide);const{Default:s}=c.a.physics.groups;t.collisionFilterGroup=s,t.collisionFilterMask=s;const{halfExtents:l}=c.a.physics.getHalfExtents(e.geometry),h=new o.Box(l);t.addShape(h),this.add(e.clone()),c.a.physics.add(t)}),c.a.mouse.addEventListener("move",this.removeCurrentHitBox),c.a.multiTouch.addEventListener("touchStart",this.removeCurrentHitBox),c.a.addEventListener("ready",this.initialize)}initialize(){this.visible=!1,this.addEventListeners()}addEventListeners(){c.a.addEventListener("beforeUpdate",this.beforeUpdate),c.a.mouse.addEventListener("move",this.setHoverState),c.a.multiTouch.addEventListener("touchStart",this.setHoverState)}beforeUpdate(){if("overview"!==l.a.viewID)return this.parent.isHovered=!1}removeCurrentHitBox(){h.current=null}setHoverState(){if("overview"!==l.a.viewID||h.current)return this.parent.isHovered=!1;const e=(c.a.multiTouch.getTouch()||c.a.mouse).getNormalizedPosition(c.a.viewport.size);this.raycaster.setFromCamera(e,c.a.camera),this.visible=!0;const t=this.raycaster.intersectObjects(this.children);this.visible=!1;const n=!!t.length;n&&!this.parent.isHovered&&this.onHover(),this.parent.isHovered=n,n&&!h.current&&(h.current=this)}onHover(){c.a.audio.play("Hover",{volume:.5})}onCollide({body:e}){e.mesh&&"Player"===e.mesh.name&&this.dispatchEvent({type:"playerEnter"})}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return m}));var i=n(18),s=n(33),a=n(1),r=n(114),o=n(115),l=n(53),c=n(16),h=n(4),d=n(0),u=n(106),p=n(222);class m extends i.a{constructor(t,n){const i=new p.a(n);i.position.set(0,4.5,.5);const{x:r,y:o}=i.size,c=m.getRectangle(r+7.5),h=m.getTriangle();c.translate(0,4,0);super(l.a.mergeBufferGeometries([c,h]),new s.a({shadowSide:a.H})),e(this),this.scaleFactor=0,this.hoverFactor=0,this.text=i,this.add(this.text),this.exclamation=new u.a,this.exclamation.position.set(.5*r+3,6,.1),this.exclamation.scaleFactor=10,this.add(this.exclamation),this.castShadow=!0,this.position.copy(t.position),d.a.addEventListener("ready",this.initialize)}initialize(){this.addEventListeners()}addEventListeners(){d.a.addEventListener("beforeUpdate",this.beforeUpdate)}beforeUpdate(){this.setHover(this.parent.isHovered),this.activate("overview"===h.a.viewID),this.quaternion.copy(d.a.camera.quaternion),this.scale.setScalar(this.scaleFactor+this.hoverFactor),this.visible=this.scaleFactor>.05}activate(e){if(this.active===e)return;this.active=e;const{player:t}=d.a.scene,n=this.position.distanceTo(t.position),i=e&&n>10?1:1e-4,s=(e?1:0)+.035*this.parent.index;c.a.killTweensOf(this),c.a.to(this,{scaleFactor:i,ease:e?"elastic.out":"expo.out",duration:e?2.5:.5,delay:s,onComplete:()=>{e||(this.visible=!1)}})}setHover(e){if(this.isHovered===e)return;this.isHovered=e,this.material.color.set(e?"#1c228c":"#ffffff"),this.text.material.color.set(e?"#ffffff":"#1c228c");const t=e?.15:0;c.a.killTweensOf(this,"hoverFactor"),c.a.to(this,1.5,{hoverFactor:t,ease:"elastic.out"})}}m.getRectangle=function(e=20,t=6,n=3){const i=new r.a,s=.5*-e,a=.5*-t;return i.moveTo(s,a+n).lineTo(s,a+t-n).quadraticCurveTo(s,a+t,s+n,a+t).lineTo(s+e-n,a+t).quadraticCurveTo(s+e,a+t,s+e,a+t-n).lineTo(s+e,a+n).quadraticCurveTo(s+e,a,s+e-n,a).lineTo(s+n,a).quadraticCurveTo(s,a,s,a+n),new o.a(i)},m.getTriangle=function(e=5,t=2.5){const n=new r.a,i=.5*t;return n.moveTo(0,i-.5*t).lineTo(0-.5*e,i+.5*t).lineTo(0+.5*e,i+.5*t).lineTo(0,i-.5*t),new o.a(n)}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return a}));var i=n(0),s=n(223);class a extends s.a{constructor(t){const{data:n,textures:s}=i.a.assets,a=n["canvas.pack/AntiqueOlive-Compact.json"],r=s["canvas.pack/AntiqueOlive-Compact.png"];r.flipY=!0,super(a,r,{text:t.toUpperCase()}),e(this),i.a.addEventListener("ready",this.initialize)}initialize(){this.addEventListeners()}addEventListeners(){i.a.addEventListener("beforeUpdate",this.beforeUpdate)}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return f}));var i=n(87),s=n(51),a=n(8),r=n(3),o=n(2),l=n(26),c=n(1),h=n(7),d=n(132),u=n(0),p=n(227),m=n(224);class f extends i.a{constructor(t,n,{text:i="Text",color:h="#1c228c",fontSize:d=1.75,textAlign:f="center",strokeColor:g="#ffffff",strokeWeight:v=!1,onlyStroke:y=!1,lineHeight:b=1,leaveWhiteSpace:_,wordLength:x}={}){h=h.replace("(0, 0, 0, 0)","(0, 0, 0)");super(new s.a,new m.a({roughness:0,metalness:.25,sprite:n,color:new a.a(h),strokeColor:new a.a(g),strokeWeight:v,onlyStroke:y,resolution:new r.a,fog:!1}),i.replace(/\s/g,"").length),e(this),this.data=t,this.texture=n,this.textureWidth=this.data.common.scaleW,this.textureHeight=this.data.common.scaleH,this.instances=[],this.glyph=[],this.data=[],this.layout=new p.a(t,i,{fontSize:d,textAlign:f,lineHeight:b,wordLength:x,leaveWhiteSpace:_}),this.style=this.layout.style,this.fontScale=this.layout.fontScale,this.size=new o.a,this.boundingBox=new l.a,this.createAttributes(),this.setAttributes(),this.instanceMatrix.setUsage(c.B),u.a.addEventListener("beforeUpdate",this.beforeUpdate)}createAttributes(){this.line=0,this.y=.07*this.style.fontSize,this.j=0;for(let e=0,t=this.layout.lines.length;e<t;e++)this.addLine(this.layout.lines[e],e);this.boundingBox.getSize(this.size).setZ(0)}addLine(e){const t=r.a.get(),n=new RegExp(/[ ]/,"g");for(let i=0;i<e.characters.length;i++){const s=e.characters[i].glyph,a=new h.a;if(t.x=e.characters[i].x,t.y=this.y,n.test(s.char))continue;"center"===this.style.textAlign?t.x-=.5*e.width:"right"===this.style.textAlign&&(t.x-=e.width),t.x+=s.xoffset*this.fontScale,t.x+=s.width*this.fontScale*.5;let r=s.yoffset*this.fontScale;r+=s.height*this.fontScale*.5,t.y-=r-.5;const o=s.width*this.fontScale,l=s.height*this.fontScale,c=s.x/this.textureWidth,d=s.width/this.textureWidth,u=s.height/this.textureHeight,p=1-s.y/this.textureHeight-u;a.scale.set(o,l,1),a.position.copy(t).setZ(.001*this.j),this.boundingBox.expandByPoint(t),this.glyph[4*this.j+0]=c,this.glyph[4*this.j+1]=p,this.glyph[4*this.j+2]=d,this.glyph[4*this.j+3]=u,this.data[4*this.j+0]=5*Math.random(),this.data[4*this.j+1]=1,this.data[4*this.j+2]=.85,this.data[4*this.j+3]=0,a.updateMatrixWorld(),this.add(a),this.setMatrixAt(this.j,a.matrixWorld),this.j++}this.y-=1.2*this.style.lineHeight*this.style.fontSize,this.line++,r.a.release(t)}setAttributes(){const e=new d.a(new Float32Array(this.glyph),4),t=new d.a(new Float32Array(this.data),4);this.geometry.setAttribute("glyph",e),this.geometry.setAttribute("data",t),this.instanceMatrix.needsUpdate=!0}beforeUpdate(){this.material.uniforms.resolution.value=u.a.renderer.resolution,this.material.uniforms.elapsedTime.value=u.a.time.elapsedTime}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c}));var i=n(35),s=n(19),a=n(24),r=n(0),o=n(225),l=n(226);class c extends i.a{constructor(t={}){c.prototype.sprite=null,c.prototype.strokeColor=null,c.prototype.strokeWeight=null,c.prototype.onlyStroke=null,c.prototype.resolution=null,c.prototype.elapsedTime=null,super(t),e(this),this.type="StandardMaterial",this.vertexShader=o.a,this.fragmentShader=l.a,this.transparent=!0,this.uniforms=Object.assign({sprite:{value:t.sprite},strokeColor:{value:t.strokeColor},strokeWeight:{value:t.strokeWeight},onlyStroke:{value:t.onlyStroke},resolution:{value:t.resolution},elapsedTime:{value:0}},s.a.clone(a.a.standard.uniforms)),r.a.addEventListener("beforeRender",this.beforeRender)}beforeRender(){this.uniforms.resolution.value=r.a.renderer.resolution,this.uniforms.elapsedTime.value=r.a.time.elapsedTime}}}).call(this,n(6).default)},function(e,t,n){"use strict";t.a="#define STANDARD\n\n#include <common>\n#include <uv_pars_vertex>\n\nattribute vec4 glyph;\nattribute vec4 data;\n\nuniform float elapsedTime;\nvarying vec2 vGlyph;\n\nvoid main() {\n\n\tvGlyph = uv;\n\tvGlyph *= glyph.zw;\n\tvGlyph += glyph.xy;\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\n}\n"},function(e,t,n){"use strict";t.a="#define STANDARD\n\nuniform vec3 diffuse;\nuniform float opacity;\n\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n\nuniform float elapsedTime;\nuniform sampler2D sprite;\nuniform vec3 color;\nuniform vec3 strokeColor;\nuniform float strokeWeight;\nuniform float onlyStroke;\nuniform vec2 resolution;\n\nvarying vec2 vGlyph;\n\nfloat median( float r, float g, float b ) {\n\n\treturn max( min( r, g ), min( max( r, g ), b ) );\n\n}\n\nvec4 getDiffuse() {\n\n\tvec3 texelColor = texture2D( sprite, vGlyph ).rgb;\n\tfloat signedDistance = median( texelColor.r, texelColor.g, texelColor.b ) - .5;\n\tfloat smoothing = fwidth( signedDistance );\n\n\tfloat alpha;\n\tvec3 result;\n\n\tfloat sW = strokeWeight;\n\tvec3 c = color;\n\n\tif ( sW > 0.0 ) {\n\n\t\talpha = smoothstep( - smoothing, smoothing, signedDistance + sW );\n\t\tfloat outlineFactor = smoothstep( - smoothing, smoothing, signedDistance );\n\t\tresult = mix( strokeColor, c, outlineFactor ) * alpha;\n\n\t\tif ( onlyStroke > .5 ) alpha *= ( 1. - outlineFactor );\n\n\t} else {\n\n\t\talpha = smoothstep( - smoothing, smoothing, signedDistance );\n\t\tresult = c * alpha;\n\n\t}\n\n\talpha = mix( signedDistance, alpha,  1.);\n\treturn vec4( result * diffuse, alpha * opacity );\n\n}\n\nvoid main() {\n\n\tvec4 diffuseColor = getDiffuse();\n\tgl_FragColor = vec4( diffuse, diffuseColor.a );\n\n}\n"},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const i=new RegExp(/[\n\r]/,"g"),s=new RegExp(/[ ]/,"g");class a{constructor(e,t,n){this.data=e,this.fontHeight=this.data.common.lineHeight,this.fontBaseline=this.data.common.base,this.fontScaleH=this.data.common.scaleH,this.fontScaleW=this.data.common.scaleW,this.style={fontSize:1,letterSpacing:0,wordSpacing:0,lineHeight:1,maxWidth:1/0,wordBreak:!1,textAlign:"left"},this.leaveWhiteSpace=n.leaveWhiteSpace,this.getGlyphCount(t),this.getGlyphMap(),this.setStyle(n),this.getXHeight(n),this.compute()}getXHeight(){const e=this.map.e;this.xHeight=e.height*this.fontScale,this.xPosition=(.5*e.height+e.yoffset)*this.fontScale}getGlyphCount(e=""){e!==this.text&&(this.text=e,this.glyphCount=e.replace(/[ \n]/g,"").length)}getGlyphMap(){this.map||(this.map=this.data.chars.reduce((e,t)=>(e[t.char]=t,e),{}))}setStyle(e={}){this.style=Object.assign({},this.style,e),this.fontScale=this.style.fontSize/this.fontBaseline}getKerning(e,t){for(let n=0,i=this.data.kernings.length;n<i;n++){const i=this.data.kernings[n];if(i.first===e&&i.second===t||i.first===t&&i.second===e)return i.amount}return 0}addLine(){const e={width:0,characters:[]};return this.word=0,this.lines.push(e),e}cleanLine(e){if(this.leaveWhiteSpace)return;let t=e.characters.getLast();for(;" "===t.glyph.char;){const n=t.glyph,i=this.style.wordSpacing*this.style.fontSize+n.xadvance*this.fontScale;e.width-=i,e.characters.pop(),t=e.characters.getLast()}}compute(){this.lines=[];let e=0,t=this.addLine(e);for(;e<this.text.length;){let n=0;const a=this.text[e],r=this.map[a];i.test(a)?(e++,this.cleanLine(t),t=this.addLine(e)):(this.leaveWhiteSpace||0!==t.width||!s.test(a))&&void 0!==r?(t.characters.push({glyph:r,x:t.width}),s.test(a)?n+=this.style.wordSpacing*this.style.fontSize:n+=this.style.letterSpacing*this.style.fontSize,n+=r.xadvance*this.fontScale,t.width+=n,e++):e++}t.width||this.lines.pop()}}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c}));var i=n(18),s=n(1),a=n(16),r=n(0),o=n(43),l=n(229);class c extends i.a{constructor(t){const{textures:n,svgs:i}=r.a.assets;if(!n.Hover){const e=new o.a(i["canvas.pack/Hover.svg"]);e.wrapT=e.wrapS=s.sc,e.rasterize(),n.Hover=e}const a=new l.a({map:n.Hover,shadowSide:s.H,side:s.y});super(t.geometry,a),e(this),this.position.copy(t.position),this.quaternion.copy(t.quaternion),r.a.addEventListener("ready",this.initialize)}initialize(){this.progress=0,this.addEventListeners()}addEventListeners(){r.a.addEventListener("beforeUpdate",this.beforeUpdate)}beforeUpdate(){this.activate(this.parent.isHovered),this.material.uniforms.progress.value=this.progress,this.position.y=2.5*this.progress,this.visible=this.progress>.01}activate(e){if(this.active===e)return;this.active=e;const t=e?1:0,n=e?0:.25*Math.random();a.a.killTweensOf(this),a.a.to(this,1.5,{progress:t,ease:"expo.out",delay:n})}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c}));var i=n(35),s=n(19),a=n(24),r=n(0),o=n(230),l=n(231);class c extends i.a{constructor(t={}){super(t),e(this),this.type="StandardMaterial",this.vertexShader=o.a,this.fragmentShader=l.a,this.uniforms=Object.assign({elapsedTime:{value:0},progress:{value:0}},s.a.clone(a.a.standard.uniforms)),r.a.addEventListener("beforeUpdate",this.beforeUpdate)}beforeUpdate(){this.uniforms.elapsedTime.value=r.a.time.elapsedTime}}}).call(this,n(6).default)},function(e,t,n){"use strict";t.a="#define STANDARD\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nuniform float elapsedTime;\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal = normalize( transformedNormal );\n\n\t#ifdef USE_TANGENT\n\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\n\t#endif\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n}\n"},function(e,t,n){"use strict";t.a="#define STANDARD\n\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSMISSION\n#endif\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n\n#ifdef TRANSMISSION\n\tuniform float transmission;\n#endif\n\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <transmissionmap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nuniform float elapsedTime;\nuniform float progress;\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#ifdef TRANSMISSION\n\t\tfloat totalTransmission = transmission;\n\t#endif\n\n\t#include <logdepthbuf_fragment>\n\n\t#ifdef USE_MAP\n\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n\n\t#endif\n\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <transmissionmap_fragment>\n\n\t// accumulation\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n\t// this is a stub for the transmission model\n\t#ifdef TRANSMISSION\n\t\tdiffuseColor.a *= saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\n\tvec2 coordinates = vUv;\n\tfloat threshold = vUv.x < .5 ? progress : progress * 1.05;\n\n\tif ( vUv.x > .5 ) coordinates.y = euclideanModulo( coordinates.y - .015, 1. );\n\tif ( threshold < coordinates.x ) discard;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n"},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o}));var i=n(18),s=n(53),a=n(0),r=n(54);class o extends i.a{constructor(t){const{materials:n,textures:i}=a.a.assets;n.Clouds||(n.Clouds=new r.a({envMap:i.EnvMap,roughness:.95,metalness:.15}));const o=[];t.children.forEach((e,t)=>{const{x:n,y:i,z:s}=a.a.settings.clouds[t];e.position.set(n.value,i.value,s.value),e.updateMatrixWorld();const r=e.geometry.clone();r.applyMatrix4(e.matrixWorld),o.push(r),e.scale.setScalar(1)});super(s.a.mergeBufferGeometries(o),n.Clouds),e(this),a.a.addEventListener("ready",this.initialize)}initialize(){this.reset(),this.addEventListeners()}reset(){}addEventListeners(){a.a.addEventListener("applySettings",this.applySettings)}applySettings(){}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o}));var i=n(18),s=n(53),a=n(0),r=n(54);class o extends i.a{constructor(t){const{materials:n,textures:i}=a.a.assets;n.Waters||(n.Waters=new r.a({envMap:i.EnvMap,roughness:0,metalness:.75,transparent:!0,opacity:.75,color:"#42b1d1"}));const o=[];t.children.forEach(e=>{e.updateMatrixWorld(),delete e.geometry.attributes.uv2;const t=e.geometry.clone();t.applyMatrix4(e.matrixWorld),o.push(t)});super(s.a.mergeBufferGeometries(o),n.Waters),e(this),a.a.addEventListener("ready",this.initialize)}initialize(){this.reset(),this.addEventListeners()}reset(){}addEventListeners(){a.a.addEventListener("applySettings",this.applySettings)}applySettings(){}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o}));var i=n(4),s=n(0),a=n(14),r=n(78);class o extends r.a{constructor(t){const{geometries:n}=s.a.assets;super(t,n["Park.glb/Star_001"]),e(this),this.collectableID="connected",this.collected=a.a.stars[this.name]}onCollide({body:e}){if(this.collected||"home"!==i.a.viewID||!e.mesh||"Player"!==e.mesh.name)return;this.collected=!0,super.onCollide(),a.a.stars[this.name]=!0;const t=Object.keys(a.a.stars);1===t.length?i.a.router.navigate("/collectable/connected"):t.length>=8?a.a.setAchievement("connected"):(s.a.ui.collectables.activate(!0,"connected",t.length),setTimeout(()=>s.a.ui.collectables.activate(!1),3e3))}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o}));var i=n(4),s=n(0),a=n(14),r=n(78);class o extends r.a{constructor(t){const{geometries:n}=s.a.assets;super(t,n["Park.glb/Bottle_001"]),e(this),this.collectableID="eco-friendly",this.collected=a.a.bottles[this.name]}onCollide({body:e}){if(this.collected||"home"!==i.a.viewID||!e.mesh||"Player"!==e.mesh.name)return;this.collected=!0,super.onCollide(),a.a.bottles[this.name]=!0;const t=Object.keys(a.a.bottles);1===t.length?i.a.router.navigate("/collectable/eco-friendly"):t.length>=8?a.a.setAchievement("eco-friendly"):(s.a.ui.collectables.activate(!0,"eco-friendly",t.length),setTimeout(()=>s.a.ui.collectables.activate(!1),3e3))}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o}));var i=n(4),s=n(0),a=n(14),r=n(78);class o extends r.a{constructor(t){const{geometries:n}=s.a.assets;super(t,n["Park.glb/Card_001"]),e(this),this.collectableID="accessible",this.collected=a.a.cards[this.name]}onCollide({body:e}){if(this.collected||"home"!==i.a.viewID||!e.mesh||"Player"!==e.mesh.name)return;this.collected=!0,super.onCollide(),a.a.cards[this.name]=!0;const t=Object.keys(a.a.cards);1===t.length?i.a.router.navigate("/collectable/accessible"):t.length>=8?a.a.setAchievement("accessible"):(s.a.ui.collectables.activate(!0,"accessible",t.length),setTimeout(()=>s.a.ui.collectables.activate(!1),3e3))}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c}));var i=n(7),s=n(0),a=n(238),r=n(239),o=n(240),l=n(241);class c extends i.a{constructor(t){super(),e(this),this.terrainID=t.name.split("-")[1],this.collisionBoxes=[],this.sensors=[],this.balls=[],t.updateMatrixWorld(),t.traverse(e=>{const{name:t}=e;if(t.match("Collision")){const t=new a.a(e,this.terrainID);return this.collisionBoxes.push(t),void this.add(t)}if(t.match("Sensor")){const t=new r.a(e,this.terrainID);return this.sensors.push(t),void this.add(t)}if(t.match("Ball")){const t=new o.a(this.terrainID,e);this.balls.push(t)}else;}),this.balls.length&&(this.balls=new l.a(this.balls),this.add(this.balls)),s.a.addEventListener("ready",this.initialize)}initialize(){this.reset(),this.addEventListeners()}reset(){}addEventListeners(){s.a.addEventListener("applySettings",this.applySettings)}applySettings(){}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return h}));var i=n(7),s=n(2),a=n(26),r=n(3),o=n(23),l=n(12),c=n(0);class h extends i.a{constructor(t,n){super(),e(this),this.name="CollisionBox",this.terrainID=n,this.object=t,this.isForBall=!!t.name.match(/Ball/),t.isBridge=!!t.name.split("-")[1],t.parent.updateMatrixWorld();const i=new s.a;t.parent.updateMatrixWorld(),t.getWorldPosition(i);const o=new a.a,l=this.setBody,h=t,d=new s.a;o.setFromObject(t),o.getSize(d);const u=new r.a(d.x,d.z).multiplyScalar(.5).multiplyScalar("Soccer"===this.terrainID?15:1.1).length();this.isForBall?this.body=this.setBody(t):c.a.broadphase.add({object:t,minDistance:u,boundingBox:o,collider:h,position:i,callback:l}),c.a.addEventListener("ready",this.initialize)}initialize(){this.reset(),this.addEventListeners()}reset(){}addEventListeners(){}setBody(e){const{halfExtents:t}=c.a.physics.getHalfExtents(e.geometry),n=new o.a,i=e.name.match("Cylinder");i&&n.setFromAxisAngle(new l.Vec3(1,0,0),.5*-Math.PI);const a=t.x,r=2*t.y,h=i?new l.Cylinder(a,a,r,8):new l.Box(t),d=new l.Body;d.addShape(h,new l.Vec3,n),d.material=c.a.physics.settings.CollisionBox,d.mesh=this;const{Default:u,Ball:p,OnlyBall:m}=c.a.physics.groups;this.isForBall?d.collisionFilterGroup=m:d.collisionFilterGroup=u,d.collisionFilterMask=u|p|m;const f=new s.a,g=new o.a;return e.parent.updateMatrixWorld(),e.getWorldPosition(f),e.getWorldQuaternion(g),d.position.copy(f),d.quaternion.copy(g),e.isBridge&&(d.position.y=0),c.a.physics.add(d),d}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return r}));var i=n(7),s=n(26),a=n(0);class r extends i.a{constructor(t,n){super(),e(this),this.name="Sensor",this.terrainID=n,this.object=t,this.boundingBox=(new s.a).setFromObject(t),this.boundingBox.max.y=-1,a.a.addEventListener("ready",this.initialize)}initialize(){this.reset(),this.addEventListeners()}reset(){}addEventListeners(){a.a.addEventListener("beforePhysics",this.beforePhysics)}beforePhysics(){const{player:e}=a.a.scene;this.boundingBox.containsPoint(e.position)&&(e.inSensor=!0)}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return l}));var i=n(7),s=n(2),a=n(23),r=n(12),o=n(0);class l extends i.a{constructor(t,n){super(),e(this);this.name="Ball",this.radius=.25,this.geometryID=n.name.match("Soccer")?"BallSoccer_001":"BallBasket_001";const i=new s.a,l=new a.a;n.updateMatrixWorld(),n.getWorldPosition(i),n.getWorldQuaternion(l),this.body=new r.Body({mass:.01}),this.body.mesh=this;const c=new r.Sphere(.25);this.body.addShape(c);const h=(new s.a).randomize(),d=Math.random()*Math.PI*2;this.body.quaternion.setFromAxisAngle(h,d),this.body.position.copy(i),this.body.position.y+=.25;const{Default:u,Ball:p,OnlyBall:m}=o.a.physics.groups;this.body.collisionFilterGroup=p,this.body.collisionFilterMask=u|p|m,this.body.material=o.a.physics.settings.Ball,o.a.physics.add(this.body),o.a.addEventListener("ready",this.initialize)}initialize(){this.reset(),this.addEventListeners()}reset(){}addEventListeners(){o.a.addEventListener("beforeUpdate",this.beforeUpdate)}beforeUpdate(){this.position.copy(this.body.position),this.quaternion.copy(this.body.quaternion),"Soccer5"===this.terrainID&&(this.position.y-=.15)}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return a}));var i=n(87),s=n(0);class a extends i.a{constructor(t){const{geometries:n,materials:i,textures:a}=s.a.assets;i.Ball||(i.Ball=new CustomStandardMaterial({map:a.Colors,envMap:a.EnvMap,roughness:.95,metalness:.15}));const r=t.length;super(n["Park.glb/"+t[0].geometryID],i.Ball.clone(),r),e(this),this.instances=t,this.receiveShadow=!0,this.castShadow=!0,this.frustumCulled=!1,s.a.addEventListener("ready",this.initialize)}initialize(){this.addEventListeners()}addEventListeners(){s.a.addEventListener("beforeUpdate",this.beforeUpdate)}beforeUpdate(){this.instances.forEach((e,t)=>{e.updateMatrixWorld(),this.setMatrixAt(t,e.matrixWorld)}),this.instanceMatrix.needsUpdate=!0}}}).call(this,n(6).default)},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var i=n(7),s=n(2),a=n(26),r=n(18),o=n(8),l=n(5),c=n(12),h=n(0),d=n(53),u=n(243);class p extends i.a{constructor(e){super();const{materials:t,textures:n}=h.a.assets;if(!t.Merge){const e=n["canvas.pack/ao_maps/Other.png"];t.Merge=new u.a({map:n.Colors,envMap:n.EnvMap,roughness:.95,metalness:.15,aoMap:e})}const i=[],o=new s.a;e.children.forEach(e=>{const t=e.children.filter(e=>!e.geometry),n=e.children.filter(e=>e.geometry)[0].geometry,{name:s}=e,r=this.setBody,l=h.a.assets.objects["Park.glb/ColliderBox"+s]||h.a.assets.objects["Park.glb/ColliderCylinder"+s];for(let e=0;e<t.length;e++){const n=t[e],i=new a.a,{position:s}=n;l&&(i.setFromObject(l),i.translate(i.getCenter(o).negate()),i.translate(n.position)),h.a.broadphase.add({object:n,boundingBox:i,collider:l,position:s,callback:r})}const c=s.match(/(Trees_001|Cars|Armchair)/g);c||this.setColor(s,n);const d=n.attributes.uv2;for(let e=0,t=.5*d.array.length;e<t;e++){const t=d.getX(e);d.setX(e,.5*t+.5)}for(let e=0;e<t.length;e++){const a=t[e],r=n.clone();a.updateMatrixWorld(),c&&this.setColor(s,r,e),r.applyMatrix4(a.matrixWorld),i.push(r)}});const l=d.a.mergeBufferGeometries(i),c=t.Merge,p=new r.a(l,c);p.castShadow="Low"!==h.a.version.quality,p.receiveShadow=!0,p.frustumCulled=!1,this.add(p)}setColor(e,t,n){const i=t.attributes.position.count,s=new Array(3*i).fill(0);if(e.match(/(Trees_001|Cars|Armchair)/g)){const t=e.split("_")[0],a=new o.a,r={Cars:["#5b5b5b","#ffffff","#dbdada","#018eea","#bc0d33","#035477","#2b2b2b","#f2ece7"],Trees:["#5ba28d","#5db68e","#7cc8a2","#89cdbc"],Armchairs:["#47cfff","#f675b6","#fee502"]},l=r[t].length,c=r[t][n%l];a.set(c);for(let e=0,t=i;e<t;e++)s[3*e+0]=a.r,s[3*e+1]=a.g,s[3*e+2]=a.b}const a=new l.a(new Float32Array(s),3);t.setAttribute("color",a)}setBody(e,t){if(!t)return;const{halfExtents:n}=h.a.physics.getHalfExtents(t);n.x*=100*e.scale.x,n.y*=100*e.scale.y,n.z*=100*e.scale.z;const i=new c.Quaternion,s=t.name.match("Cylinder");s&&i.setFromAxisAngle(new c.Vec3(1,0,0),.5*-Math.PI);const a=n.x,r=n.y,o=s?new c.Cylinder(a,a,r,8):new c.Box(n),l=new c.Body;l.addShape(o,new c.Vec3,i);const{Default:d}=h.a.physics.groups;return l.collisionFilterGroup=d,l.collisionFilterMask=d,l.mesh=this,l.position.copy(e.position),l.quaternion.copy(e.quaternion),h.a.physics.add(l),l}}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c}));var i=n(35),s=n(19),a=n(24),r=n(0),o=n(244),l=n(245);class c extends i.a{constructor(t={}){c.prototype.mask=null,c.prototype.rimPower=null,c.prototype.rimStrength=null,super(t),e(this),this.type="StandardMaterial",this.vertexShader=o.a,this.fragmentShader=l.a;const{textures:n}=r.a.assets;this.uniforms=Object.assign({elapsedTime:{value:0},rimPower:{value:t.rimPower||2.5},rimStrength:{value:t.rimStrength||.15},mask:{value:t.mask},matCap:{value:n.MatCap},matCapStrength:{value:0}},s.a.clone(a.a.standard.uniforms)),r.a.addEventListener("beforeUpdate",this.beforeUpdate)}beforeUpdate(){const{rimLight:e,matCap:t,ambientOcclusion:n}=r.a.settings.lighting;this.uniforms.elapsedTime.value=r.a.time.elapsedTime,this.uniforms.rimPower.value=e.power.value,this.uniforms.rimStrength.value=e.enabled.value?e.intensity.value:0,this.uniforms.matCapStrength.value=t.enabled.value?t.intensity.value:0,this.aoMapIntensity=n.enabled.value?n.intensity.value:0}}}).call(this,n(6).default)},function(e,t,n){"use strict";t.a="#define STANDARD\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nattribute vec3 color;\n\nuniform float elapsedTime;\n\nvarying vec3 vColor;\nvarying vec3 vEye;\n\nvoid main() {\n\n\tvColor = color;\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal = normalize( transformedNormal );\n\n\t#ifdef USE_TANGENT\n\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\n\t#endif\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n\tvEye = normalize( vec3( mvPosition ) );\n\n}\n"},function(e,t,n){"use strict";t.a="#define STANDARD\n\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSMISSION\n#endif\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n\n#ifdef TRANSMISSION\n\tuniform float transmission;\n#endif\n\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <transmissionmap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nuniform sampler2D mask;\nuniform float rimPower;\nuniform float rimStrength;\nuniform sampler2D matCap;\nuniform float matCapStrength;\n\nvarying vec3 vEye;\nvarying vec3 vColor;\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#ifdef TRANSMISSION\n\t\tfloat totalTransmission = transmission;\n\t#endif\n\n\t#include <logdepthbuf_fragment>\n\n\t#ifdef USE_MAP\n\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor.rgb *= texelColor.rgb;\n\tdiffuseColor.rgb += vColor * ( 1. - texelColor.a );\n\n\t#endif\n\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <transmissionmap_fragment>\n\n\t// accumulation\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n\t// #ifdef USE_MATCAP\n\n\tvec3 viewDirection = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDirection.z, 0.0, - viewDirection.x ) );\n\tvec3 y = cross( viewDirection, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * .495 + 0.5;\n\n\tvec4 matCapColor = texture2D( matCap, uv );\n\toutgoingLight.rgb *= 1. - matCapStrength + matCapColor.rgb * matCapStrength;\n\n\t// #endif\n\n\t// this is a stub for the transmission model\n\t#ifdef TRANSMISSION\n\t\tdiffuseColor.a *= saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n\tfloat rimLight = rimPower * abs( dot( vNormal, normalize( vEye ) ) );\n\trimLight = 1. - smoothstep( .0, 1., rimLight );\n\tgl_FragColor.rgb += vec3( rimLight * rimStrength );\n\n}\n"},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return u}));var i=n(7),s=n(124),a=n(125),r=n(27),o=n(300),l=n(294),c=n(248),h=n(247),d=n(0);class u extends i.a{constructor(){super(),e(this),this.axesHelper=new s.a(50),this.add(this.axesHelper),this.gridHelper=new a.a(50,50,0,16777215),this.add(this.gridHelper),this.camera=new r.a(50,1,1,1e5),this.camera.position.set(100,100,100),this.camera.updateProjectionMatrix(),this.debugRenderer=new h.a(this,d.a.physics),this.orbitControls=new c.a(this.camera,document.body.querySelector(".app")),this.orbitControls.update(),this.cameraHelpers=[],d.a.scene.traverse(e=>{if("DirectionalLight"===e.type){const t=new o.a(e);if(this.add(t),e.castShadow){const t=new l.a(e.shadow.camera);this.cameraHelpers.push(t),this.add(t)}}else if("PerspectiveCamera"===e.type){const t=new l.a(e);this.cameraHelpers.push(t),this.add(t)}}),this.initialize()}initialize(){this.setCameraTarget(),this.addEventListeners()}addEventListeners(){const{target:e}=d.a.settings.developement.controls;e.addEventListener("change",this.setCameraTarget),d.a.addEventListener("applySettings",this.applySettings),d.a.addEventListener("beforeRender",this.beforeRender)}applySettings(){const{controls:e,helpers:t}=d.a.settings.developement;this.controls=e.enabled.value,this.visible=t.visible.value,"Player"===e.target.value&&this.orbitControls.target.copy(d.a.scene.player.position)}beforeRender(){this.debugRenderer.update();for(let e=0;e<this.cameraHelpers.length;e++)this.cameraHelpers[e].update();d.a.overrideCamera=this.controls?this.camera:null,this.camera.aspect=d.a.viewport.aspect,this.camera.updateProjectionMatrix()}setCameraTarget(){const{target:e}=d.a.settings.developement.controls;let t;switch(e.value){case"Scene":t=d.a.scene;break;case"Player":t=d.a.scene.player}this.orbitControls.target.copy(t.position)}get controls(){return this.orbitControls.enabled}set controls(e){this.orbitControls.enabled=e,this.orbitControls.update()}}}).call(this,n(6).default)},function(e,t,n){"use strict";var i=n(33),s=n(291),a=n(107),r=n(292),o=n(299),l=n(34),c=n(18),h=n(2),d=n(57),u=n(12);const p=function(e,t){this.scene=e,this.world=t,this._meshes=[],this._material=new i.a({color:3355443,wireframe:!0}),this._sphereGeometry=new s.a(1,8,8),this._boxGeometry=new a.a(1,1,1),this._planeGeometry=new r.a(2,2,1,1),this._cylinderGeometry=new o.a(1,1,10,10)};p.prototype={tmpVec0:new u.Vec3,tmpVec1:new u.Vec3,tmpVec2:new u.Vec3,tmpQuat0:new u.Vec3,update:function(){const e=this.world.bodies,t=this._meshes,n=this.tmpVec0,i=this.tmpQuat0;let s=0;for(let a=0;a!==e.length;a++){const r=e[a];for(let e=0;e!==r.shapes.length;e++){const a=r.shapes[e];this._updateMesh(s,r,a);const o=t[s];o&&(o&&(r.quaternion.vmult(r.shapeOffsets[e],n),r.position.vadd(n,n),r.quaternion.mult(r.shapeOrientations[e],i),o.position.copy(n),o.quaternion.copy(i)),s++)}}for(let e=s;e<t.length;e++){const n=t[e];n&&this.scene.remove(n)}t.length=s},_updateMesh:function(e,t,n){let i=this._meshes[e];this._typeMatch(i,n)||(i&&this.scene.remove(i),i=this._meshes[e]=this._createMesh(n)),this._scaleMesh(i,n)},_typeMatch:function(e,t){if(!e)return!1;const n=e.geometry;return n instanceof s.a&&t instanceof u.Sphere||n instanceof a.a&&t instanceof u.Box||n instanceof r.a&&t instanceof u.Plane||n.id===t.geometryId&&t instanceof u.ConvexPolyhedron||n.id===t.geometryId&&t instanceof u.Trimesh||n.id===t.geometryId&&t instanceof u.Heightfield},_createMesh:function(e){let t;const n=new l.a,i=this._material,s=this.tmpVec0,a=this.tmpVec1,r=this.tmpVec2;switch(e.type){case u.Shape.types.SPHERE:t=new c.a(this._sphereGeometry,i);break;case u.Shape.types.BOX:t=new c.a(this._boxGeometry,i);break;case u.Shape.types.PLANE:t=new c.a(this._planeGeometry,i);break;case u.Shape.types.CONVEXPOLYHEDRON:const o=new l.a;for(let t=0;t<e.vertices.length;t++){const n=e.vertices[t];o.vertices.push(new h.a(n.x,n.y,n.z))}for(let t=0;t<e.faces.length;t++){const n=e.faces[t],i=n[0],s=n[1],a=n[2];o.faces.push(new d.a(i,s,a))}o.computeBoundingSphere(),o.computeFaceNormals(),t=new c.a(o,i),e.geometryId=o.id;break;case u.Shape.types.TRIMESH:for(let t=0;t<e.indices.length/3;t++){e.getTriangleVertices(t,s,a,r),n.vertices.push(new h.a(s.x,s.y,s.z),new h.a(a.x,a.y,a.z),new h.a(r.x,r.y,r.z));const i=n.vertices.length-3;n.faces.push(new d.a(i,i+1,i+2))}n.computeBoundingSphere(),n.computeFaceNormals(),t=new c.a(n,i),e.geometryId=n.id;break;case u.Shape.types.HEIGHTFIELD:for(let t=0;t<e.data.length-1;t++)for(let i=0;i<e.data[t].length-1;i++)for(let o=0;o<2;o++){e.getConvexTrianglePillar(t,i,0===o),s.copy(e.pillarConvex.vertices[0]),a.copy(e.pillarConvex.vertices[1]),r.copy(e.pillarConvex.vertices[2]),s.vadd(e.pillarOffset,s),a.vadd(e.pillarOffset,a),r.vadd(e.pillarOffset,r),n.vertices.push(new h.a(s.x,s.y,s.z),new h.a(a.x,a.y,a.z),new h.a(r.x,r.y,r.z));const l=n.vertices.length-3;n.faces.push(new d.a(l,l+1,l+2))}n.computeBoundingSphere(),n.computeFaceNormals(),t=new c.a(n,i),e.geometryId=n.id}return t&&(t.castShadow=!0,t.receiveShadow=!0,e.invisible||this.scene.add(t)),t},_scaleMesh:function(e,t){switch(t.type){case u.Shape.types.SPHERE:const n=t.radius;e.scale.set(n,n,n);break;case u.Shape.types.BOX:e.scale.copy(t.halfExtents),e.scale.multiplyScalar(2.01);break;case u.Shape.types.CONVEXPOLYHEDRON:e.scale.set(1,1,1);break;case u.Shape.types.TRIMESH:e.scale.copy(t.scale);break;case u.Shape.types.HEIGHTFIELD:e.scale.set(1,1,1)}}},t.a=p},function(e,t,n){"use strict";var i=n(2),s=n(1),a=n(23),r=n(293),o=n(3),l=n(36);const c=function(e,t){document,this.object=e,this.domElement=t,this.enabled=!0,this.target=new i.a,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:s.gb.ROTATE,MIDDLE:s.gb.DOLLY,RIGHT:s.gb.PAN},this.touches={ONE:s.Pc.ROTATE,TWO:s.Pc.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return m.phi},this.getAzimuthalAngle=function(){return m.theta},this.saveState=function(){n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=function(){n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(l),n.update(),u=d.NONE},this.update=function(){const t=new i.a,s=(new a.a).setFromUnitVectors(e.up,new i.a(0,1,0)),r=s.clone().inverse(),o=new i.a,c=new a.a;return function(){const e=n.object.position;return t.copy(e).sub(n.target),t.applyQuaternion(s),m.setFromVector3(t),n.autoRotate&&u===d.NONE&&C(2*Math.PI/60/60*n.autoRotateSpeed),n.enableDamping?(m.theta+=f.theta*n.dampingFactor,m.phi+=f.phi*n.dampingFactor):(m.theta+=f.theta,m.phi+=f.phi),m.theta=Math.max(n.minAzimuthAngle,Math.min(n.maxAzimuthAngle,m.theta)),m.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,m.phi)),m.makeSafe(),m.radius*=g,m.radius=Math.max(n.minDistance,Math.min(n.maxDistance,m.radius)),!0===n.enableDamping?n.target.addScaledVector(v,n.dampingFactor):n.target.add(v),t.setFromSpherical(m),t.applyQuaternion(r),e.copy(n.target).add(t),n.object.lookAt(n.target),!0===n.enableDamping?(f.theta*=1-n.dampingFactor,f.phi*=1-n.dampingFactor,v.multiplyScalar(1-n.dampingFactor)):(f.set(0,0,0),v.set(0,0,0)),g=1,!!(y||o.distanceToSquared(n.object.position)>p||8*(1-c.dot(n.object.quaternion))>p)&&(n.dispatchEvent(l),o.copy(n.object.position),c.copy(n.object.quaternion),y=!1,!0)}}(),this.dispose=function(){n.domElement.removeEventListener("contextmenu",Q,!1),n.domElement.removeEventListener("mousedown",V,!1),n.domElement.removeEventListener("wheel",Y,!1),n.domElement.removeEventListener("touchstart",K,!1),n.domElement.removeEventListener("touchend",$,!1),n.domElement.removeEventListener("touchmove",Z,!1),document.removeEventListener("mousemove",W,!1),document.removeEventListener("mouseup",q,!1),n.domElement.removeEventListener("keydown",X,!1)};var n=this,l={type:"change"};const c={type:"start"},h={type:"end"};var d={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},u=d.NONE,p=1e-6,m=new r.a,f=new r.a,g=1,v=new i.a,y=!1;const b=new o.a,_=new o.a,x=new o.a,w=new o.a,S=new o.a,L=new o.a,T=new o.a,E=new o.a,A=new o.a;function M(){return Math.pow(.95,n.zoomSpeed)}function C(e){f.theta-=e}function D(e){f.phi-=e}const P=function(){const e=new i.a;return function(t,n){e.setFromMatrixColumn(n,0),e.multiplyScalar(-t),v.add(e)}}(),I=function(){const e=new i.a;return function(t,i){!0===n.screenSpacePanning?e.setFromMatrixColumn(i,1):(e.setFromMatrixColumn(i,0),e.crossVectors(n.object.up,e)),e.multiplyScalar(t),v.add(e)}}(),k=function(){const e=new i.a;return function(t,i){const s=n.domElement;if(n.object.isPerspectiveCamera){const a=n.object.position;e.copy(a).sub(n.target);let r=e.length();r*=Math.tan(n.object.fov/2*Math.PI/180),P(2*t*r/s.clientHeight,n.object.matrix),I(2*i*r/s.clientHeight,n.object.matrix)}else n.object.isOrthographicCamera?(P(t*(n.object.right-n.object.left)/n.object.zoom/s.clientWidth,n.object.matrix),I(i*(n.object.top-n.object.bottom)/n.object.zoom/s.clientHeight,n.object.matrix)):n.enablePan=!1}}();function R(e){n.object.isPerspectiveCamera?g/=e:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom*e)),n.object.updateProjectionMatrix(),y=!0):n.enableZoom=!1}function z(e){n.object.isPerspectiveCamera?g*=e:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/e)),n.object.updateProjectionMatrix(),y=!0):n.enableZoom=!1}function O(e){b.set(e.clientX,e.clientY)}function U(e){w.set(e.clientX,e.clientY)}function F(e){if(1==e.touches.length)b.set(e.touches[0].pageX,e.touches[0].pageY);else{const t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);b.set(t,n)}}function N(e){if(1==e.touches.length)w.set(e.touches[0].pageX,e.touches[0].pageY);else{const t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);w.set(t,n)}}function B(e){const t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,i=Math.sqrt(t*t+n*n);T.set(0,i)}function H(e){if(1==e.touches.length)_.set(e.touches[0].pageX,e.touches[0].pageY);else{const t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);_.set(t,n)}x.subVectors(_,b).multiplyScalar(n.rotateSpeed);const t=n.domElement;C(2*Math.PI*x.x/t.clientHeight),D(2*Math.PI*x.y/t.clientHeight),b.copy(_)}function j(e){if(1==e.touches.length)S.set(e.touches[0].pageX,e.touches[0].pageY);else{const t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);S.set(t,n)}L.subVectors(S,w).multiplyScalar(n.panSpeed),k(L.x,L.y),w.copy(S)}function G(e){const t=e.touches[0].pageX-e.touches[1].pageX,i=e.touches[0].pageY-e.touches[1].pageY,s=Math.sqrt(t*t+i*i);E.set(0,s),A.set(0,Math.pow(E.y/T.y,n.zoomSpeed)),R(A.y),T.copy(E)}function V(e){if(!1!==n.enabled){switch(e.preventDefault(),n.domElement.focus?n.domElement.focus():window.focus(),e.button){case 0:switch(n.mouseButtons.LEFT){case s.gb.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===n.enablePan)return;U(e),u=d.PAN}else{if(!1===n.enableRotate)return;O(e),u=d.ROTATE}break;case s.gb.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===n.enableRotate)return;O(e),u=d.ROTATE}else{if(!1===n.enablePan)return;U(e),u=d.PAN}break;default:u=d.NONE}break;case 1:switch(n.mouseButtons.MIDDLE){case s.gb.DOLLY:if(!1===n.enableZoom)return;!function(e){T.set(e.clientX,e.clientY)}(e),u=d.DOLLY;break;default:u=d.NONE}break;case 2:switch(n.mouseButtons.RIGHT){case s.gb.ROTATE:if(!1===n.enableRotate)return;O(e),u=d.ROTATE;break;case s.gb.PAN:if(!1===n.enablePan)return;U(e),u=d.PAN;break;default:u=d.NONE}}u!==d.NONE&&(document.addEventListener("mousemove",W,!1),document.addEventListener("mouseup",q,!1),n.dispatchEvent(c))}}function W(e){if(!1!==n.enabled)switch(e.preventDefault(),u){case d.ROTATE:if(!1===n.enableRotate)return;!function(e){_.set(e.clientX,e.clientY),x.subVectors(_,b).multiplyScalar(n.rotateSpeed);const t=n.domElement;C(2*Math.PI*x.x/t.clientHeight),D(2*Math.PI*x.y/t.clientHeight),b.copy(_),n.update()}(e);break;case d.DOLLY:if(!1===n.enableZoom)return;!function(e){E.set(e.clientX,e.clientY),A.subVectors(E,T),A.y>0?R(M()):A.y<0&&z(M()),T.copy(E),n.update()}(e);break;case d.PAN:if(!1===n.enablePan)return;!function(e){S.set(e.clientX,e.clientY),L.subVectors(S,w).multiplyScalar(n.panSpeed),k(L.x,L.y),w.copy(S),n.update()}(e)}}function q(e){!1!==n.enabled&&(document.removeEventListener("mousemove",W,!1),document.removeEventListener("mouseup",q,!1),n.dispatchEvent(h),u=d.NONE)}function Y(e){!1===n.enabled||!1===n.enableZoom||u!==d.NONE&&u!==d.ROTATE||(e.preventDefault(),e.stopPropagation(),n.dispatchEvent(c),function(e){e.deltaY<0?z(M()):e.deltaY>0&&R(M()),n.update()}(e),n.dispatchEvent(h))}function X(e){!1!==n.enabled&&!1!==n.enableKeys&&!1!==n.enablePan&&function(e){let t=!1;switch(e.keyCode){case n.keys.UP:k(0,n.keyPanSpeed),t=!0;break;case n.keys.BOTTOM:k(0,-n.keyPanSpeed),t=!0;break;case n.keys.LEFT:k(n.keyPanSpeed,0),t=!0;break;case n.keys.RIGHT:k(-n.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),n.update())}(e)}function K(e){if(!1!==n.enabled){switch(e.preventDefault(),e.touches.length){case 1:switch(n.touches.ONE){case s.Pc.ROTATE:if(!1===n.enableRotate)return;F(e),u=d.TOUCH_ROTATE;break;case s.Pc.PAN:if(!1===n.enablePan)return;N(e),u=d.TOUCH_PAN;break;default:u=d.NONE}break;case 2:switch(n.touches.TWO){case s.Pc.DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;!function(e){n.enableZoom&&B(e),n.enablePan&&N(e)}(e),u=d.TOUCH_DOLLY_PAN;break;case s.Pc.DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;!function(e){n.enableZoom&&B(e),n.enableRotate&&F(e)}(e),u=d.TOUCH_DOLLY_ROTATE;break;default:u=d.NONE}break;default:u=d.NONE}u!==d.NONE&&n.dispatchEvent(c)}}function Z(e){if(!1!==n.enabled)switch(e.preventDefault(),e.stopPropagation(),u){case d.TOUCH_ROTATE:if(!1===n.enableRotate)return;H(e),n.update();break;case d.TOUCH_PAN:if(!1===n.enablePan)return;j(e),n.update();break;case d.TOUCH_DOLLY_PAN:if(!1===n.enableZoom&&!1===n.enablePan)return;!function(e){n.enableZoom&&G(e),n.enablePan&&j(e)}(e),n.update();break;case d.TOUCH_DOLLY_ROTATE:if(!1===n.enableZoom&&!1===n.enableRotate)return;!function(e){n.enableZoom&&G(e),n.enableRotate&&H(e)}(e),n.update();break;default:u=d.NONE}}function $(e){!1!==n.enabled&&(n.dispatchEvent(h),u=d.NONE)}function Q(e){!1!==n.enabled&&e.preventDefault()}n.domElement.addEventListener("contextmenu",Q,!1),n.domElement.addEventListener("mousedown",V,!1),n.domElement.addEventListener("wheel",Y,{passive:!1}),n.domElement.addEventListener("touchstart",K,{passive:!1}),n.domElement.addEventListener("touchend",$,{passive:!1}),n.domElement.addEventListener("touchmove",Z,{passive:!1}),n.domElement.addEventListener("keydown",X,!1),-1===n.domElement.tabIndex&&(n.domElement.tabIndex=0),this.update()};(c.prototype=Object.create(l.a.prototype)).constructor=c;const h=function(e,t){c.call(this,e,t),this.mouseButtons.LEFT=s.gb.PAN,this.mouseButtons.RIGHT=s.gb.ROTATE,this.touches.ONE=s.Pc.PAN,this.touches.TWO=s.Pc.DOLLY_ROTATE};(h.prototype=Object.create(l.a.prototype)).constructor=h,t.a=c},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return h}));var i=n(4),s=n(0),a=n(14),r=n(92),o=n(102),l=n(108),c=n(109);class h extends r.a{constructor(t,n){super(t,n),e(this),s.a.injuredCharacter=this,s.a.addEventListener("ready",this.initialize)}initialize(){this.initialized||(super.initialize(),this.initialized=!0,this.speechBubble=new l.a(this),s.a.scene.add(this.speechBubble),this.raycastTarget=new c.a(this),s.a.scene.add(this.raycastTarget),a.a.characters.Injured?this.setFinalState():this.setInitialState())}setObjects(){super.setObjects(),this.bike=new o.a,this.bike.scale.setScalar(.75),s.a.scene.add(this.bike)}setVisible(){this.visible=!(!s.a.cycling.initialized&&!a.a.characters.Injured),this.bike.visible=this.visible}setAnimationMixer(){super.setAnimationMixer(["Injured","HappyIdle","Waving"])}setAnimation(){this.currentAnimation=s.a.cycling.initialized?this.isHovered?"Waving":"Injured":"HappyIdle",super.setAnimation(this.currentAnimation)}setRotation(){i.a.viewID.match(/(dialog|game)/g)&&super.setRotation()}setInitialState(){this.position.copy(this.node.position),this.quaternion.copy(this.node.quaternion),this.setHeight(),this.bike.rotation.set(0,0,.45*Math.PI),this.bike.position.set(-.75,0,0).applyQuaternion(this.quaternion).add(this.position),this.speechBubble.setActive(!0)}setDialogState(){this.bike.rotation.set(0,0,0),this.bike.position.copy(this.bike.position.initial).setX(-.75).setY(0).add(this.position),this.speechBubble.setActive(!1),this.setPlayerClose()}setFinalState(e){const{objects:t}=s.a.assets,n=t["Park.glb/InjuredFinalPosition"];this.position.copy(n.position),this.quaternion.copy(n.quaternion),this.object.rotation.y=0,e&&this.setPlayerClose(),this.setHeight(),this.bike.rotation.set(0,0,0),this.bike.position.set(-.75,0,0).applyQuaternion(this.quaternion).add(this.position),this.bike.quaternion.copy(this.quaternion),this.speechBubble.setActive(!1);const{controls:i}=s.a.camera;i.setCameraTarget(s.a.player.body.position)}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return h}));var i=n(33),s=n(8),a=n(3),r=n(19),o=n(24),l=n(251),c=n(252);class h extends i.a{constructor(t={}){super(t),e(this),this.type="BasicMaterial",this.vertexShader=l.a,this.fragmentShader=c.a,this.uniforms=Object.assign({colorA:{value:new s.a("#ffffff")},colorB:{value:new s.a("#1c228c")},icon:{value:new a.a}},r.a.clone(o.a.basic.uniforms))}}}).call(this,n(6).default)},function(e,t,n){"use strict";t.a="#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\n\t#ifdef USE_ENVMAP\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n\t#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n\n}\n"},function(e,t,n){"use strict";t.a="uniform vec3 diffuse;\nuniform float opacity;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nuniform vec3 colorA;\nuniform vec3 colorB;\nuniform vec2 icon;\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\n\t#ifdef USE_MAP\n\n\tvec2 divisions = 1. / vec2( 8., 2. );\n\tvec2 coordinates = vUv * divisions + icon * divisions;\n\tvec4 texelColor = texture2D( map, coordinates );\n\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n\n\tdiffuseColor.rgb = mix( colorB, colorA, texelColor.r ).rgb;\n\n\t#endif\n\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\n\t// accumulation (baked indirect lighting only)\n\t#ifdef USE_LIGHTMAP\n\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\n\t#else\n\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\n\t#endif\n\n\t// modulation\n\t#include <aomap_fragment>\n\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\n\t#include <envmap_fragment>\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n"},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return r}));var i=n(2),s=n(47),a=n(79);class r extends a.a{constructor(t,n){super(t,n),e(this),this.setCurve()}update(){super.update(),this.setSpeed(),this.setProgress(),this.setTransform(),this.setPosition(),this.setAnimationFromSpeed()}setProperties(){super.setProperties()}setSpeed(){if(!this.visible||!this.curve)return;this.isStopped=this.isHovered||this.canSpeak&&this.isClose;const e=.1*("Running"===this.animationID?1:.4),t=this.isStopped?0:e/this.curveLength;this.speed=Math.lerp(this.speed,t,.1)}setAnimationMixer(){super.setAnimationMixer(["HappyIdle","Running","Walking","Swimming","Waving"])}setAnimationFromSpeed(){const e=1e3*this.speed;this.currentAnimation=this.animationID||(e<.1?"HappyIdle":e<1?"Walking":"Running")}setCurve(){const e=this.points.map(e=>(new i.a).fromArray(e));this.curve=new s.a(e,!0),this.curveLength=this.curve.getLength(),this.speed=0,this.progress=0,this.setTransform(),this.setHeight()}setProgress(){this.progress+=this.speed,this.progress%=1}setTransform(){const e=i.a.get(),t=i.a.get();this.curve.getPointAt(this.progress,e),this.position.setX(e.x).setZ(e.z),this.curve.getTangentAt(this.progress,t);const n=Math.atan2(-t.z,t.x)+.5*Math.PI;this.rotation.y=Math.lerpAngle(this.rotation.y,n,.25),i.a.release(e,t)}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return h}));var i=n(72),s=n(0),a=n(256),r=n(257),o=n(255),l=n(261),c=n(116);class h extends i.a{constructor(){super(),e(this),this.name="UI",this.camera=new o.a,this.lighting=new a.a(!1),this.add(this.lighting),this.wave=new r.a,this.add(this.wave),this.minimap=new l.a(this.camera),this.add(this.minimap),this.dialog=new c.a(this.camera,"Dialog"),this.add(this.dialog),this.achievements=new c.a(this.camera,"Achievements"),this.add(this.achievements),this.collectables=new c.a(this.camera,"Collectables"),this.add(this.collectables),s.a.ui=this,s.a.addEventListener("ready",this.initialize)}initialize(){this.addEventListeners()}addEventListeners(){s.a.addEventListener("afterRender",this.afterRender)}afterRender(){s.a.renderer.needsUpdate&&(s.a.renderer.clearDepth(),s.a.renderer.render(this,this.camera))}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return a}));var i=n(27),s=n(0);class a extends i.a{constructor(){super(25,1,1,50),e(this),this.name="UICamera",this.position.set(0,0,30),s.a.addEventListener("ready",this.initialize)}initialize(){this.applySettings(),this.addEventListeners()}addEventListeners(){s.a.addEventListener("applySettings",this.applySettings),s.a.addEventListener("beforeRender",this.beforeRender)}applySettings(){const{near:e,far:t}=s.a.settings.camera;this.fov=15,this.near=e.value,this.far=t.value}beforeRender(){s.a.viewport.aspect!==this.aspect&&(this.aspect=s.a.viewport.aspect,this.updateProjectionMatrix(),this.dispatchEvent({type:"resize"}))}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c}));var i=n(7),s=n(2),a=n(288),r=n(289),o=n(133),l=n(0);class c extends i.a{constructor(){super(),e(this),this.target=new s.a,this.ambientLight=new a.a(16777215,.25),this.add(this.ambientLight),this.hemisphereLight=new r.a(3892113,10137529,.85),this.add(this.hemisphereLight),this.keyLight=new o.a(16777215,.85),this.keyLight.direction=new s.a(0,15,5),this.add(this.keyLight),this.add(this.keyLight.target),this.keyLight.shadow.camera.far=50,this.shadowCameraSize=2,l.a.addEventListener("applySettings",this.applySettings),l.a.addEventListener("beforeUpdate",this.beforeUpdate)}applySettings(){const{ambientLight:e,hemisphereLight:t,keyLight:n}=l.a.settings.lighting;this.ambientLight.intensity=1.25*e.intensity.value,this.ambientLight.color.set(e.color.value),this.hemisphereLight.intensity=t.intensity.value,this.hemisphereLight.color.set(t.skyColor.value),this.hemisphereLight.groundColor.set(t.groundColor.value),this.keyLight.castShadow=n.castShadow.value,this.keyLight.intensity=n.intensity.value,this.keyLight.color.set(n.color.value),this.keyLight.direction.x=n.position.x.value,this.keyLight.direction.y=n.position.y.value,this.keyLight.direction.z=n.position.z.value;const i=parseInt(.25*n.shadowMapSize.value);this.mapSize!==i&&(this.mapSize=i,this.keyLight.shadow.mapSize.width=i,this.keyLight.shadow.mapSize.height=i,this.keyLight.shadow.map&&(this.keyLight.shadow.map.dispose(),this.keyLight.shadow.map=null))}beforeUpdate(){const e=s.a.get();this.keyLight.target.position.copy(e),this.keyLight.position.copy(e).add(this.keyLight.direction),s.a.release(e)}get shadowCameraSize(){return this.keyLight.shadow.camera.top}set shadowCameraSize(e){this.keyLight.shadow.camera.top=e,this.keyLight.shadow.camera.right=e,this.keyLight.shadow.camera.bottom=-e,this.keyLight.shadow.camera.left=-e,this.keyLight.shadow.camera.updateProjectionMatrix()}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return l}));var i=n(16),s=n(258),a=n(4),r=n(0),o=n(105);class l extends o.a{constructor(){super(r.a.assets.geometries["Park.glb/Wave"],new s.a),e(this),this.material.color.set("#fff"),this.renderOrder=-1e5,this.frustumCulled=!1,this.transition=0,this.scaleY=0,r.a.addEventListener("ready",this.initialize)}addEventListeners(){super.addEventListeners(),r.a.addEventListener("beforeUpdate",this.beforeUpdate)}beforeUpdate(){const{width:e,height:t}=r.a.viewport,n=e<1024?280:e<1600?350:400;this.setSize(n,n),this.position.y=.5*-t,this.activate("home"===a.a.viewID),this.setHoverState(),this.material.uniforms.transition.value=this.transition,this.material.uniforms.scaleY.value=this.scaleY}activate(e){if(this.active===e)return;this.active=e;const t=e?1:0,n=e?.75:0;i.a.to(this.scale,1,{y:t,ease:"expo.out",delay:n})}setHoverState(){const e=a.a.nodes.overview.matches(":hover");if(e===this.isHovered)return;this.isHovered=e;const t=this.isHovered?1:0,n=this.isHovered?1:.9,{camera:s}=r.a;i.a.to(this,.75,{transition:t,scaleY:n,ease:"power4.out"}),i.a.to(s,1,{fovOffset:e?5:0})}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return h}));var i=n(33),s=n(8),a=n(19),r=n(24),o=n(0),l=n(259),c=n(260);class h extends i.a{constructor(t){super(t),e(this),this.type="StandardMaterial",this.vertexShader=l.a,this.fragmentShader=c.a,this.uniforms=Object.assign({pixelRatio:{value:o.a.renderer.pixelRatio},resolution:{value:o.a.viewport.size},topColor:{value:new s.a("#5fa2e4")},bottomColor:{value:new s.a("#6bb78c")},transition:{value:0},scaleY:{value:1}},a.a.clone(r.a.standard.uniforms)),this.depthTest=!1,this.fog=!1,o.a.addEventListener("beforeRender",this.beforeRender)}beforeRender(){this.uniforms.pixelRatio.value=o.a.renderer.pixelRatio,this.uniforms.resolution.value=o.a.viewport.size}}}).call(this,n(6).default)},function(e,t,n){"use strict";t.a="uniform vec2 resolution;\nuniform float scaleY;\n\nvarying vec2 vUv;\n\nvoid main() {\n\n\tvUv = uv;\n\n\tvec3 transformed = position;\n\ttransformed.x /= scaleY;\n\n\tgl_Position = modelMatrix * vec4( transformed, 1. );\n\tgl_Position.xy /= resolution * .5;\n\n}\n"},function(e,t,n){"use strict";t.a="uniform vec3 diffuse;\nuniform float opacity;\n\nuniform vec3 topColor;\nuniform vec3 bottomColor;\nuniform float transition;\n\nvarying vec2 vUv;\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec3 color;\n\tfloat y = transition * 2. + ( vUv.x * vUv.y ) - 1.;\n\n\tcolor = mix( vec3( 1. ), bottomColor, smoothstep( .0, 1., y ) );\n\tcolor = mix( color, topColor, smoothstep( 1., 2., y ) );\n\n\tvec4 diffuseColor = vec4( color, opacity );\n\tgl_FragColor = diffuseColor;\n\n}\n"},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return f}));var i=n(7),s=n(51),a=n(33),r=n(18),o=n(71),l=n(41),c=n(2),h=n(3),d=n(16),u=n(4),p=n(0),m=n(103);class f extends i.a{constructor(t){super(),e(this),this.object=new i.a,this.add(this.object);const{textures:n}=p.a.assets,h=n["canvas.pack/Minimap.png"],d=new s.a(2,1),u=new a.a({map:h,transparent:!0});h.flipY=!0,this.mesh=new r.a(d,u),this.object.add(this.mesh),this.pin=new m.a({onMinimap:!0}),this.add(this.pin),this.camera=t,this.offsetY=-1.5,this.scale.setScalar(1.15),this.raycaster=new o.a,this.plane=new l.a(new c.a(0,0,1)),p.a.addEventListener("ready",this.initialize)}initialize(){this.reset(),this.addEventListeners()}reset(){}addEventListeners(){this.camera.addEventListener("resize",this.onResize),p.a.addEventListener("beforeUpdate",this.beforeUpdate),p.a.viewport.addEventListener("resize",this.onResize)}beforeUpdate(){this.rotation.z=.05*Math.sin(p.a.time.elapsedTime),this.object.position.y=this.offsetY,this.activate("home"===u.a.viewID&&u.a.preloader.hidden)}activate(e){if(this.active===e)return;this.active=e;const t=e?0:-1.5,n=e?.5:0,i=e?1:.5,s=e?"expo.out":"expo.inOut";d.a.to(this,i,{offsetY:t,ease:s,delay:n})}onResize(){this.camera.updateMatrixWorld();const{width:e,height:t}=p.a.viewport;this.scale.setScalar(1.15);const n=e<1024?t-115:e<1600?t-150:t-175,i=h.a.get().set(0,-n/t),s=c.a.get();this.raycaster.setFromCamera(i,this.camera),this.raycaster.ray.intersectPlane(this.plane,s),this.position.set(s.x,s.y,0),h.a.release(i),c.a.release(s)}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){var i=n(305),s=n(302),a=n(81),r=n(16),o=n(4),l=n(0);t.a=class{constructor(){e(this),this.variations={},this.streams={},this.volume=0,this.active=!0}start(){if(this.started)return;this.started=!0;const{audioBuffers:e}=l.a.assets;for(const t in e){const e=t.replace("canvas.pack/audio/","").replace(".m4a","").split("_");if(e.length<2)continue;const n=e.length<3?e[0]:`${e[0]}_${e[1]}`,i=parseInt(e.getLast());this.variations[n]||(this.variations[n]={index:0,length:-1/0}),this.variations[n].length=Math.max(this.variations[n].length,i)}this.listener=new i.a,l.a.camera.add(this.listener),this.ambient=this.play("Ambient",{volume:1,loop:!0}),this.default=this.play("Default",{volume:.25,loop:!0}),this.game=this.play("Game",{volume:.25,loop:!0}),this.default.pause(),this.game.pause(),r.a.to(this,1.5,{volume:1}),this.addEventListeners()}addEventListeners(){addEventListener("visibilitychange",this.onVisibilityChange),l.a.addEventListener("update",this.update)}play(e="Character",{context:t=null,delay:n=0,volume:i=1,loop:r=!1}={}){if(!this.started)return;const c=o.a.files.map[`canvas.static/audio/${e}.m4a`];if(c){if(!this.streams[e]){const t=document.createElement("audio");Object.assign(t,{crossOrigin:"anonymous",src:c,loop:r,volume:i}),this.streams[e]=t}return this.streams[e].play(),this.streams[e]}const{audioBuffers:h}=l.a.assets,d=this.variations[e];d&&(e+="_00"+(d.index+1),d.index++,d.index%=d.length);const u=h[`canvas.pack/audio/${e}.m4a`],p=new(t?s.a:a.a)(this.listener);return t&&(p.setRefDistance(10),p.updateMatrixWorld()),p.setVolume(i),p.setLoop(r),p.setBuffer(u),p.weight=0,setTimeout(()=>p.play(),n),p}pause(e){this.streams[e]&&this.streams[e].pause()}update(){const e=document.querySelector("video");this.hasVideo=e&&!e.paused;const t=this.disabled||this.hasVideo?0:this.volume;this.listener.setMasterVolume(t),this.default.volume=.25*t,this.game.volume=.25*t,this.ambient.volume=t,this.setStreamState(this.default,"game"===o.a.viewID||this.disabled||this.hasVideo||!this.active),this.setStreamState(this.game,"game"!==o.a.viewID||this.disabled||this.hasVideo||!this.active),this.setStreamState(this.ambient,this.disabled||this.hasVideo||!this.active)}onBlur(){this.disabled=!0,this.update()}onFocus(){this.disabled=!1,this.update()}onVisibilityChange(){this.disabled=document.hidden,this.update()}toggle(){this.active=!this.active;const e=this.active?1:0;return r.a.to(this,.5,{volume:e}),this.active}setStreamState(e,t){e.paused&&!t&&e.play(),!e.paused&&t&&e.pause()}}}).call(this,n(6).default)},function(e,t,n){e.exports=function(e){Promise.all([n.e(0),n.e(9)]).then(function(t){e(n(308))}.bind(null,n)).catch(n.oe)}},function(e,t,n){e.exports=function(e){Promise.all([n.e(0),n.e(6)]).then(function(t){e(n(309))}.bind(null,n)).catch(n.oe)}},function(e,t,n){e.exports=function(e){Promise.all([n.e(0),n.e(5)]).then(function(t){e(n(310))}.bind(null,n)).catch(n.oe)}},function(e,t,n){e.exports=function(e){Promise.all([n.e(0),n.e(11)]).then(function(t){e(n(311))}.bind(null,n)).catch(n.oe)}},function(e,t,n){e.exports=function(e){Promise.all([n.e(0),n.e(7)]).then(function(t){e(n(312))}.bind(null,n)).catch(n.oe)}},function(e,t,n){e.exports=function(e){Promise.all([n.e(0),n.e(8)]).then(function(t){e(n(313))}.bind(null,n)).catch(n.oe)}},function(e,t,n){e.exports=function(e){Promise.all([n.e(0),n.e(1)]).then(function(t){e(n(314))}.bind(null,n)).catch(n.oe)}},function(e,t,n){e.exports=function(e){Promise.all([n.e(0),n.e(14)]).then(function(t){e(n(315))}.bind(null,n)).catch(n.oe)}},function(e,t,n){e.exports=function(e){Promise.all([n.e(0),n.e(13)]).then(function(t){e(n(316))}.bind(null,n)).catch(n.oe)}},function(e,t,n){e.exports=function(e){Promise.all([n.e(0),n.e(4)]).then(function(t){e(n(317))}.bind(null,n)).catch(n.oe)}},function(e,t,n){e.exports=function(e){Promise.all([n.e(0),n.e(17),n.e(3)]).then(function(t){e(n(318))}.bind(null,n)).catch(n.oe)}},function(e,t,n){e.exports=function(e){Promise.all([n.e(0),n.e(10)]).then(function(t){e(n(319))}.bind(null,n)).catch(n.oe)}},function(e,t,n){e.exports=function(e){Promise.all([n.e(0),n.e(12)]).then(function(t){e(n(320))}.bind(null,n)).catch(n.oe)}},function(e,t,n){e.exports={xs:"220px",achievements:"500px",trophies:"600px",sm:"768px",md:"1024px",lg:"1200px",dashboard:"1400px",xl:"1600px",xxl:"99999px"}},function(e,t,n){"use strict";(function(e){var i=n(4),s=n(48),a=n(0);class r extends s.a{constructor(t){super(),e(this),this.hidden=!1,this.nodes=i.a.templateEngine.getNodesFromDom(t,{main:t}),this.nodes.value.addEventListener("click",this.onClick),i.a.files.loader.addEventListener("progress",this.onProgress)}onProgress(e){const t=e.progress;this.nodes.progress.style.setProperty("--progress",t),this.nodes.percent.innerText=""+Math.round(100*t)}onClick(e){a.a.scene.overlay.hide(),e&&a.a.audio.start(),this.nodes.main.classList.add("preloader--hidden"),a.a.audio.play("Enter"),setTimeout(()=>{document.body.classList.add("loaded"),this.dispatchEvent({type:"hide"}),this.hidden=!0},500)}onLoad(){this.nodes.main.classList.add("preloader--loaded")}}t.a=r}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){var i=n(4),s=n(0);t.a=class{constructor(t){e(this),this.nodes=i.a.templateEngine.getNodesFromDom(t,{main:t});const{toggle:n,links:a}=this.nodes;n.addEventListener("click",this._onClick),a.forEach(e=>e.addEventListener("click",this._close)),i.a.router.addEventListener("match",this._close),s.a.addEventListener("update",this.update)}_onClick(){i.a.viewport.width>1024?i.a.router.navigate():document.body.classList.toggle("show-menu")}_close(){document.body.classList.remove("show-menu")}update(){const{width:e}=i.a.viewport,t=document.body.classList.contains("show-menu");s.a.renderer.needsUpdate=e>1024||!t}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){var i=n(4);t.a=class{constructor(t){e(this),this.nodes=i.a.templateEngine.getNodesFromDom(t,{main:t}),this.map={};for(let e=0,t=content.dashboard.achievements.length;e<t;e++){const t=content.dashboard.achievements[e];this.map[t.id]=t.name}}show(e,t,n){const{main:i,achievement:s,collectable:a,count:r}=this.nodes;i.classList.contains("notification--visible")||(s.textContent=this.map[t],a.textContent=content.global.common[t],r.textContent=n+content.global.common["collectibles-count"],i.classList.add("notification--visible"),i.classList.add("notification--"+e.toLowerCase()))}hide(){const{main:e}=this.nodes;e.classList.remove("notification--visible"),e.classList.remove("notification--achievements"),e.classList.remove("notification--collectables")}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){var i=n(4),s=n(0);t.a=class{constructor(t){e(this),this.nodes=i.a.templateEngine.getNodesFromDom(t,{main:t}),this.nodes.details.forEach(e=>e.addEventListener("mousedown",this.copyToClipboard)),this.nodes.details.forEach(e=>e.addEventListener("touchstart",this.copyToClipboard)),this.nodes.sound.addEventListener("click",this.toggleSound)}copyToClipboard({currentTarget:e}){const t=document.createElement("input");t.value=e.querySelector(".content_dummy").textContent,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),clearTimeout(this.timeout),this.timeout=setTimeout(()=>e.classList.remove("footer__detail--copied"),1e3),e.classList.add("footer__detail--copied")}toggleSound(){document.body.classList.toggle("sound-muted",!s.a.audio.toggle())}}}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){var i=n(4),s=n(48),a=n(0);class r extends s.a{constructor(t){super(),e(this),this.nodes=i.a.templateEngine.getNodesFromDom(t,{main:t}),a.a.addEventListener("ready",this.initialize)}initialize(){this.nodes.main.addEventListener("click",this.onClick),a.a.addEventListener("beforeUpdate",this.beforeUpdate)}onClick(){this.dispatchEvent({type:"click",atBottom:this.atBottom})}setNode(e){this.node=e}beforeUpdate(){if(!this.node)return;const{height:e}=a.a.viewport;this.atBottom=this.node.scrollTop>this.node.scrollHeight-1.25*e,this.nodes.main.classList.toggle("scroll-to--at-bottom",this.atBottom)}}t.a=r}).call(this,n(6).default)},function(e,t,n){"use strict";(function(e){var i=n(4),s=n(0);t.a=class{constructor(t){e(this),this.nodes=i.a.templateEngine.getNodesFromDom(t,{main:t}),s.a.addEventListener("ready",this.initialize)}initialize(){addEventListener("mousedown",this.onClick),addEventListener("touchstart",this.onClick),s.a.addEventListener("beforeUpdate",this.beforeUpdate)}onClick(){this.visible&&this.nodes.main.classList.remove("tutorial--visible")}beforeUpdate(){const{controls:e}=s.a.camera;e.radiusFactor<.1&&"home"===i.a.viewID&&!this.visible&&(this.visible=!0,this.nodes.main.classList.add("tutorial--visible"))}}}).call(this,n(6).default)},function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var i=n(3),s=n(2),a=n(33),r=n(8),o=n(112),l=n(72),c=n(18),h=n(51),d=n(1),u=n(59),p=n(46),m=n(19),f=n(82),g=n(49),v={uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new r.a(0)},defaultOpacity:{value:0}},vertexShader:g.a,fragmentShader:"uniform sampler2D tDiffuse;\nuniform vec3 defaultColor;\nuniform float defaultOpacity;\nuniform float luminosityThreshold;\nuniform float smoothWidth;\n\nvarying vec2 vUv;\n\nvoid main() {\n\n\tvec4 texelColor = texture2D( tDiffuse, vUv );\n\tvec3 luma = vec3( .299, .587, .114 );\n\tfloat v = dot( texelColor.xyz, luma );\n\n\tvec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );\n\tfloat alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );\n\n\tgl_FragColor = mix( outputColor, texelColor, alpha );\n\n}"},y=n(75),b={defines:{KERNEL_RADIUS:null,SIGMA:null},uniforms:{colorTexture:{value:null},textureSize:{value:new i.a(.5,.5)},direction:{value:new i.a(.5,.5)}},vertexShader:g.a,fragmentShader:"#include <common>\n\nvarying vec2 vUv;\nuniform sampler2D colorTexture;\nuniform vec2 textureSize;\nuniform vec2 direction;\n\nfloat gaussian( in float x, in float sigma ) {\n\n\treturn .39894 * exp( -.5 * x * x / ( sigma * sigma ) ) / sigma;\n\n}\n\nvoid main() {\n\n\tvec2 inverseTextureSize = 1. / textureSize;\n\t\n\tfloat sigma = float( SIGMA );\n\tfloat weightSum = gaussian( .0, sigma );\n\tvec3 diffuseSum = texture2D( colorTexture, vUv ).rgb * weightSum;\n\n\tfor ( int i = 1; i < KERNEL_RADIUS; i ++ ) {\n\n\t\tfloat x = float( i );\n\t\tfloat weight = gaussian( x, sigma );\n\n\t\tvec2 offset = direction * inverseTextureSize * x;\n\n\t\tvec3 sampleA = texture2D( colorTexture, vUv + offset ).rgb;\n\t\tvec3 sampleB = texture2D( colorTexture, vUv - offset ).rgb;\n\t\t\n\t\tdiffuseSum += ( sampleA + sampleB ) * weight;\n\t\tweightSum += 2. * weight;\n\n\t}\n\n\tgl_FragColor = vec4( diffuseSum / weightSum, 1. );\n\n}"},_={defines:{MIPMAP_COUNT:null},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},dirtTexture:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:g.a,fragmentShader:"varying vec2 vUv;\n\nuniform sampler2D blurTexture1;\nuniform sampler2D blurTexture2;\nuniform sampler2D blurTexture3;\nuniform sampler2D blurTexture4;\nuniform sampler2D blurTexture5;\nuniform sampler2D dirtTexture;\n\nuniform float bloomStrength;\nuniform float bloomRadius;\nuniform float bloomFactors[ MIPMAP_COUNT ];\nuniform vec3 bloomTintColors[ MIPMAP_COUNT ];\n\nfloat lerpBloomFactor( const in float factor ) {\n\n\tfloat mirrorFactor = 1.2 - factor;\n\treturn mix( factor, mirrorFactor, bloomRadius );\n\n}\n\nvoid main() {\n\n\tgl_FragColor = bloomStrength * ( \n\t\tlerpBloomFactor( bloomFactors[ 0 ] ) * vec4( bloomTintColors[ 0 ], 1. ) * texture2D( blurTexture1, vUv ) +\n\t\tlerpBloomFactor( bloomFactors[ 1 ] ) * vec4( bloomTintColors[ 1 ], 1. ) * texture2D( blurTexture2, vUv ) +\n\t\tlerpBloomFactor( bloomFactors[ 2 ] ) * vec4( bloomTintColors[ 2 ], 1. ) * texture2D( blurTexture3, vUv ) +\n\t\tlerpBloomFactor( bloomFactors[ 3 ] ) * vec4( bloomTintColors[ 3 ], 1. ) * texture2D( blurTexture4, vUv ) +\n\t\tlerpBloomFactor( bloomFactors[ 4 ] ) * vec4( bloomTintColors[ 4 ], 1. ) * texture2D( blurTexture5, vUv ) \n\t);\n\n}"};class x extends y.a{constructor(e=1,t,n,d=new i.a(256,256)){super(),this.strength=e,this.radius=t,this.threshold=n,this.resolution=d,this.mipmapCount=5,this.bloomTintColors=[];for(let e=0,t=this.mipmapCount;e<t;e++)this.bloomTintColors.push(new s.a(1,1,1));this.createRenderTargets(),this.materials={basic:new a.a,luminosityHighPass:this.getLuminosityHighPassMaterial(),seperableBlurs:this.getSeperableBlurMaterials(),composite:this.getCompositeMaterial(),copy:this.getCopyMaterial()},this.enabled=!0,this.needsSwap=!1,this.clearColor=new r.a,this.oldClearColor=new r.a,this.oldClearAlpha=1,this.camera=new o.a(-1,1,1,-1,0,1),this.scene=new l.a,this.quad=new c.a(new h.a(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)}createRenderTargets(){const e={minFilter:d.V,magFilter:d.V,format:d.Fb};this.renderTargetsHorizontal=[],this.renderTargetsVertical=[];let t=Math.round(.5*this.resolution.x),n=Math.round(.5*this.resolution.y);this.renderTargetLuminosity=new u.a(t,n,e),this.renderTargetLuminosity.texture.name="UnrealBloomPass.bright",this.renderTargetLuminosity.texture.generateMipmaps=!1;for(let i=0;i<this.mipmapCount;i++){const s=new u.a(t,n,e);s.texture.name="UnrealBloomPass.h"+i,s.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(s);const a=new u.a(t,n,e);a.texture.name="UnrealBloomPass.v"+i,a.texture.generateMipmaps=!1,this.renderTargetsVertical.push(a),t=Math.round(.5*t),n=Math.round(.5*n)}}getLuminosityHighPassMaterial(){const e=new p.a(v);return e.uniforms=m.a.clone(v.uniforms),Object.assign(e.uniforms,{luminosityThreshold:{value:this.threshold},smoothWidth:{value:.01}}),e}getSeperableBlurMaterial(e){const t=new p.a(b);return t.uniforms=m.a.clone(b.uniforms),t.defines={KERNEL_RADIUS:e,SIGMA:e},t}getSeperableBlurMaterials(){const e=[],t=[3,5,7,9,11];let n=Math.round(.5*this.resolution.x),i=Math.round(.5*this.resolution.y);for(let s=0;s<this.mipmapCount;s++){const a=this.getSeperableBlurMaterial(t[s]);a.uniforms.textureSize.value.set(n,i),e.push(a),n=Math.round(.5*n),i=Math.round(.5*i)}return e}getCompositeMaterial(){const e=new p.a(_);return e.uniforms=m.a.clone(_.uniforms),e.defines={MIPMAP_COUNT:this.mipmapCount},Object.assign(e.uniforms,{blurTexture1:{value:this.renderTargetsVertical[0].texture},blurTexture2:{value:this.renderTargetsVertical[1].texture},blurTexture3:{value:this.renderTargetsVertical[2].texture},blurTexture4:{value:this.renderTargetsVertical[3].texture},blurTexture5:{value:this.renderTargetsVertical[4].texture},bloomStrength:{value:this.strength},bloomFactors:{value:[1,.8,.6,.4,.2]},bloomTintColors:{value:this.bloomTintColors},bloomRadius:{value:.1}}),e.needsUpdate=!0,e}getCopyMaterial(){const e=new p.a(Object.assign({},f.a,{blending:d.e,depthTest:!1,depthWrite:!1,transparent:!0}));return e.uniforms=m.a.clone(f.a.uniforms),e.uniforms.opacity.value=1,e}renderReadBuffer(e,t){this.quad.material=this.materials.basic,this.materials.basic.map=t.texture,e.setRenderTarget(null),e.clear(),e.render(this.scene,this.camera)}renderLuminosityHighPass(e,t){const n=this.materials.luminosityHighPass;this.quad.material=n,Object.assign(n.uniforms,{tDiffuse:{value:t.texture},luminosityThreshold:{value:this.threshold}}),e.setRenderTarget(this.renderTargetLuminosity),e.clear(),e.render(this.scene,this.camera)}renderSeperableBlurs(e){let t=this.renderTargetLuminosity;for(let n=0;n<this.mipmapCount;n++){const i=this.materials.seperableBlurs[n];this.quad.material=i,Object.assign(i.uniforms,{colorTexture:{value:t.texture},direction:{value:x.BlurDirectionX}}),e.setRenderTarget(this.renderTargetsHorizontal[n]),e.clear(),e.render(this.scene,this.camera),Object.assign(i.uniforms,{colorTexture:{value:this.renderTargetsHorizontal[n].texture},direction:{value:x.BlurDirectionY}}),e.setRenderTarget(this.renderTargetsVertical[n]),e.clear(),e.render(this.scene,this.camera),t=this.renderTargetsVertical[n]}}renderComposite(e){const t=this.materials.composite;this.quad.material=t,Object.assign(t.uniforms,{bloomStrength:{value:this.strength},bloomRadius:{value:this.radius},bloomTintColors:{value:this.bloomTintColors}}),e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),e.render(this.scene,this.camera)}renderCopy(e,t){const n=this.materials.copy;this.quad.material=n,Object.assign(n.uniforms,{tDiffuse:{value:this.renderTargetsHorizontal[0].texture}}),this.renderToScreen?(e.setRenderTarget(null),e.render(this.scene,this.camera)):(e.setRenderTarget(t),e.render(this.scene,this.camera))}dispose(){for(let e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(let e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetLuminosity.dispose()}setSize(e,t){let n=Math.round(e/2),i=Math.round(t/2);this.renderTargetLuminosity.setSize(n,i);for(let e=0;e<this.mipmapCount;e++)this.renderTargetsHorizontal[e].setSize(n,i),this.renderTargetsVertical[e].setSize(n,i),this.materials.seperableBlurs[e].uniforms.textureSize.value.set(n,i),n=Math.round(n/2),i=Math.round(i/2)}render(e,t,n,i,s){this.oldClearColor.copy(e.getClearColor()),this.oldClearAlpha=e.getClearAlpha();const a=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),s&&e.context.disable(e.context.STENCIL_TEST),this.renderToScreen&&this.renderReadBuffer(e,n),this.renderLuminosityHighPass(e,n),this.renderSeperableBlurs(e),this.renderComposite(e),this.renderCopy(e,n),s&&e.context.enable(e.context.STENCIL_TEST),e.setClearColor(this.oldClearColor,this.oldClearAlpha),e.autoClear=a}}x.BlurDirectionX=new i.a(1,0),x.BlurDirectionY=new i.a(0,1)},function(e,t,n){"use strict";var i=n(21);i.a.getInstanceMatrix="mat4 getInstanceMatrix( vec3 p, vec4 q, vec3 s ) {\n\n    mat4 m;\n\n    float x = q.x;\n    float y = q.y;\n    float z = q.z;\n    float w = q.w;\n\n    float x2 = x + x;\n    float y2 = y + y;\n    float z2 = z + z;\n\n    float xx = x * x2; \n    float xy = x * y2; \n    float xz = x * z2;\n\n    float yy = y * y2; \n    float yz = y * z2; \n    float zz = z * z2;\n\n    float wx = w * x2; \n    float wy = w * y2; \n    float wz = w * z2;\n\n    float sx = s.x;\n    float sy = s.y; \n    float sz = s.z;\n\n    m[ 0 ][ 0 ] = ( 1. - ( yy + zz ) ) * sx;\n    m[ 0 ][ 1 ] = ( xy + wz ) * sx;\n    m[ 0 ][ 2 ] = ( xz - wy ) * sx;\n    m[ 0 ][ 3 ] = 0.;\n\n    m[ 1 ][ 0 ] = ( xy - wz ) * sy;\n    m[ 1 ][ 1 ] = ( 1. - ( xx + zz ) ) * sy;\n    m[ 1 ][ 2 ] = ( yz + wx ) * sy;\n    m[ 1 ][ 3 ] = 0.;\n\n    m[ 2 ][ 0 ] = ( xz + wy ) * sz;\n    m[ 2 ][ 1 ] = ( yz - wx ) * sz;\n    m[ 2 ][ 2 ] = ( 1. - ( xx + yy ) ) * sz;\n    m[ 2 ][ 3 ] = 0.;\n\n    m[ 3 ][ 0 ] = p.x;\n    m[ 3 ][ 1 ] = p.y;\n    m[ 3 ][ 2 ] = p.z;\n    m[ 3 ][ 3 ] = 1.;\n\n    return m;\n\n}\n",i.a.inverseMatrix="float inverseMatrix( float m ) {\n\treturn 1. / m;\n}\n\nmat2 inverseMatrix( mat2 m ) {\n\treturn mat2(\n\t\tm[ 1 ][ 1 ],-m[ 0 ][ 1 ],\n\t\t-m[ 1 ][ 0 ], m[ 0 ][ 0 ]) / ( m[ 0 ][ 0 ] * m[ 1 ][ 1 ] - m[ 0 ][ 1 ] * m[ 1 ][ 0 ]\n\t);\n}\n\nmat3 inverseMatrix( mat3 m ) {\n\n\tfloat a00 = m[ 0 ][ 0 ], a01 = m[ 0 ][ 1 ], a02 = m[ 0 ][ 2 ];\n\tfloat a10 = m[ 1 ][ 0 ], a11 = m[ 1 ][ 1 ], a12 = m[ 1 ][ 2 ];\n\tfloat a20 = m[ 2 ][ 0 ], a21 = m[ 2 ][ 1 ], a22 = m[ 2 ][ 2 ];\n\n\tfloat b01 = a22 * a11 - a12 * a21;\n\tfloat b11 = -a22 * a10 + a12 * a20;\n\tfloat b21 = a21 * a10 - a11 * a20;\n\n\tfloat det = a00 * b01 + a01 * b11 + a02 * b21;\n\n\treturn mat3(\n\t\tb01, ( -a22 * a01 + a02 * a21 ), ( a12 * a01 - a02 * a11 ),\n\t\tb11, ( a22 * a00 - a02 * a20 ), ( -a12 * a00 + a02 * a10 ),\n\t\tb21, ( -a21 * a00 + a01 * a20 ), ( a11 * a00 - a01 * a10 )\n\t) / det;\n\n}\n\nmat4 inverseMatrix( mat4 m ) {\n\n\tfloat\n\t\ta00 = m[ 0 ][ 0 ], a01 = m[ 0 ][ 1 ], a02 = m[ 0 ][ 2 ], a03 = m[ 0 ][ 3 ],\n\t\ta10 = m[ 1 ][ 0 ], a11 = m[ 1 ][ 1 ], a12 = m[ 1 ][ 2 ], a13 = m[ 1 ][ 3 ],\n\t\ta20 = m[ 2 ][ 0 ], a21 = m[ 2 ][ 1 ], a22 = m[ 2 ][ 2 ], a23 = m[ 2 ][ 3 ],\n\t\ta30 = m[ 3 ][ 0 ], a31 = m[ 3 ][ 1 ], a32 = m[ 3 ][ 2 ], a33 = m[ 3 ][ 3 ],\n\n\t\tb00 = a00 * a11 - a01 * a10,\n\t\tb01 = a00 * a12 - a02 * a10,\n\t\tb02 = a00 * a13 - a03 * a10,\n\t\tb03 = a01 * a12 - a02 * a11,\n\t\tb04 = a01 * a13 - a03 * a11,\n\t\tb05 = a02 * a13 - a03 * a12,\n\t\tb06 = a20 * a31 - a21 * a30,\n\t\tb07 = a20 * a32 - a22 * a30,\n\t\tb08 = a20 * a33 - a23 * a30,\n\t\tb09 = a21 * a32 - a22 * a31,\n\t\tb10 = a21 * a33 - a23 * a31,\n\t\tb11 = a22 * a33 - a23 * a32,\n\n\t\tdet = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n\treturn mat4(\n\t\ta11 * b11 - a12 * b10 + a13 * b09,\n\t\ta02 * b10 - a01 * b11 - a03 * b09,\n\t\ta31 * b05 - a32 * b04 + a33 * b03,\n\t\ta22 * b04 - a21 * b05 - a23 * b03,\n\t\ta12 * b08 - a10 * b11 - a13 * b07,\n\t\ta00 * b11 - a02 * b08 + a03 * b07,\n\t\ta32 * b02 - a30 * b05 - a33 * b01,\n\t\ta20 * b05 - a22 * b02 + a23 * b01,\n\t\ta10 * b10 - a11 * b08 + a13 * b06,\n\t\ta01 * b08 - a00 * b10 - a03 * b06,\n\t\ta30 * b04 - a31 * b02 + a33 * b00,\n\t\ta21 * b02 - a20 * b04 - a23 * b00,\n\t\ta11 * b07 - a10 * b09 - a12 * b06,\n\t\ta00 * b09 - a01 * b07 + a02 * b06,\n\t\ta31 * b01 - a30 * b03 - a32 * b00,\n\t\ta20 * b03 - a21 * b01 + a22 * b00\n\t) / det;\n\n}\n\nfloat transposeMatrix( float m ) {\n\n\treturn m;\n\n}\n\nmat2 transposeMatrix( mat2 m ) {\n\n\treturn mat2( m[ 0 ][ 0 ], m[ 1 ][ 0 ],\n\t\t\t\t m[ 0 ][ 1 ], m[ 1 ][ 1 ] );\n\n}\n\nmat3 transposeMatrix( mat3 m ) {\n\n\treturn mat3( m[ 0 ][ 0 ], m[ 1 ][ 0 ], m[ 2 ][ 0 ],\n\t\t\t\t m[ 0 ][ 1 ], m[ 1 ][ 1 ], m[ 2 ][ 1 ],\n\t\t\t\t m[ 0 ][ 2 ], m[ 1 ][ 2 ], m[ 2 ][ 2 ] );\n\n}\n\nmat4 transposeMatrix( mat4 m ) {\n\n\treturn mat4( m[ 0 ][ 0 ], m[ 1 ][ 0 ], m[ 2 ][ 0 ], m[ 3 ][ 0 ],\n\t\t\t\t m[ 0 ][ 1 ], m[ 1 ][ 1 ], m[ 2 ][ 1 ], m[ 3 ][ 1 ],\n\t\t\t\t m[ 0 ][ 2 ], m[ 1 ][ 2 ], m[ 2 ][ 2 ], m[ 3 ][ 2 ],\n\t\t\t\t m[ 0 ][ 3 ], m[ 1 ][ 3 ], m[ 2 ][ 3 ], m[ 3 ][ 3 ] );\n\n}\n",i.a.getLuma="float getLuma (\n    \n    const in vec3 color\n\n) {\n\n    return dot( color, vec3( .299, .587, .114 ) );\n\n}\n",i.a.common="#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n\n#ifndef saturate\n// <tonemapping_pars_fragment> may have defined saturate() already\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\n\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\n// expects values in the range of [0,1]x[0,1], returns values in the [0,1] range.\n// do not collapse into a single function per: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\n\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\n\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\n\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n}\n\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t// dir can be either a direction vector or a normal vector\n\t// upper-left 3x3 of matrix is assumed to be orthogonal\n\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n\n}\n\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\n\treturn - distance * planeNormal + point;\n\n}\n\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n\n}\n\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n\n}\n\nmat3 transposeMat3( const in mat3 m ) {\n\n\tmat3 tmp;\n\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\n\treturn tmp;\n\n}\n\n// https://en.wikipedia.org/wiki/Relative_luminance\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\n\treturn dot( weights, color.rgb );\n\n}\n\nbool isPerspectiveMatrix( mat4 m ) {\n\n\treturn m[ 2 ][ 3 ] == - 1.0;\n\n}\n\nvec2 equirectUv( in vec3 dir ) {\n\n\t// dir is assumed to be unit length\n\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\n\treturn vec2( u, v );\n\n}\n\nfloat isEqual( float x, float y ) { return 1. - abs( sign( x - y ) ); }\nfloat isNotEqual( float x, float y ) { return abs( sign( x - y ) ); }\nfloat isGreater( float x, float y ) { return max( sign( x - y ), 0. ); }\nfloat isLess( float x, float y ) { return max( sign( y - x ), 0. ); }\nfloat isGreaterEqual( float x, float y ) { return 1. - max( sign( x - y ), 0. ); }\nfloat isLessEqual( float x, float y ) { return 1. - max( sign( y - x ), 0. ); }\n\nfloat and( float x, float y ) { return x * y; }\nfloat or( float x, float y ) { return min( x + y, 1. ); }\n// float not( float x ) { return 1. - x; }\n\nfloat random( vec2 c ) { return fract( sin( dot( c.xy, vec2( 12.9898, 78.233 ) ) ) * 43758.5453 ); }\nfloat randFloat( vec2 c, float low, float high ) { return low + random( c ) * ( high - low ); }\nint randInt( vec2 c, float low, float high ) { return int( low + floor( random( c ) * ( high - low + 1. ) ) ); }\n\nfloat mapLinear( float value, float min1, float max1, float min2, float max2 ) {\n\n\treturn min2 + ( value - min1 ) * ( max2 - min2 ) / ( max1 - min1 );\n\n}\n\nvec3 randomVector3( vec2 c, float scale ) {\n\n\tfloat theta = 2. * PI * random( c );\n\tfloat phi = acos( 2. * random( c ) - 1. );\n\n\tfloat x = sin( phi ) * cos( theta );\n\tfloat y = sin( phi ) * sin( theta );\n\tfloat z = cos( phi );\n\n\treturn vec3( x, y, z ) * scale;\n\n}\n\nfloat euclideanModulo( float n, float m ) {\n\n\treturn mod( ( mod( n, m ) + m ), m );\n\n}\n\nfloat bounceOut( float t ) {\n\n\tconst float a = 4. / 11.;\n\tconst float b = 8. / 11.;\n\tconst float c = 9. / 10.;\n\tconst float ca = 4356. / 361.;\n\tconst float cb = 35442. / 1805.;\n\tconst float cc = 16061. / 1805.;\n\tfloat t2 = t * t;\n\n\treturn t < a ? 7.5625 * t2 : t < b ? 9.075 * t2 - 9.9 * t + 3.4 : t < c ? ca * t2 - cb * t + cc : 10.8 * t * t - 20.52 * t + 10.72;\n\n}\n\nfloat bounceInOut( float t ) { return t < .5 ? .5 * ( 1. - bounceOut( 1. - t * 2. ) ) : .5 * bounceOut( t * 2. - 1. ) + .5; }\nfloat bounceIn( float t ) { return 1. - bounceOut( 1. - t ); }\n\nfloat circularIn( float t ) { return 1. - sqrt( 1. - t * t ); }\nfloat circularOut( float t ) { return sqrt( ( 2. - t ) * t ); }\nfloat circularInOut( float t ) { return t < .5 ? .5 * ( 1. - sqrt( 1. - 4. * t * t ) ) : .5 * ( sqrt( ( 3. - 2. * t ) * ( 2. * t - 1. ) ) + 1. ); }\n\nfloat cubicInOut( float t ) { return t < .5 ? 4. * t * t * t : .5 * pow( 2. * t - 2.0, 3. ) + 1.; }\nfloat cubicIn( float t ) { return t * t * t; }\nfloat cubicOut( float t ) {\n\n\tfloat f = t - 1.;\n\treturn f * f * f + 1.;\n\n}\n\nfloat elasticIn( float t ) { return sin( 13. * t * PI_HALF ) * pow( 2.0, 10. * ( t - 1. ) ); }\nfloat elasticOut( float t ) { return sin( -13. * ( t + 1. ) * PI_HALF ) * pow( 2.0, -10. * t ) + 1.; }\nfloat elasticInOut( float t ) { return t < .5 ? .5 * sin( +13. * PI_HALF * 2. * t ) * pow( 2.0, 10. * ( 2. * t - 1. ) ) : .5 * sin( -13. * PI_HALF * ( ( 2. * t - 1. ) + 1. ) ) * pow( 2.0, -10. * ( 2. * t - 1. ) ) + 1.; }\n\nfloat exponentialIn( float t ) { return t == .0 ? t : pow( 2.0, 10. * ( t - 1. ) ); }\nfloat exponentialOut( float t ) { return t == 1. ? t : 1. - pow( 2.0, -10. * t ); }\nfloat exponentialInOut( float t ) { return t == .0 || t == 1. ? t : t < .5 ? +0.5 * pow( 2.0, ( 20. * t ) - 10. ) : -0.5 * pow( 2.0, 10. - ( t * 20. ) ) + 1.; }\n\nfloat quadraticIn( float t ) { return t * t; }\nfloat quadraticOut( float t ) { return -t * ( t - 2. ); }\nfloat quadraticInOut( float t ) {\n\n\tfloat p = 2. * t * t;\n\treturn t < .5 ? p : -p + ( 4. * t ) - 1.;\n\n}\n\nfloat quarticIn( float t ) { return pow( t, 4. ); }\nfloat quarticOut( float t ) { return pow( t - 1.0, 3. ) * ( 1. - t ) + 1.; }\nfloat quarticInOut( float t ) { return t < .5 ? + 8. * pow( t, 4. ) : - 8. * pow( t - 1.0, 4. ) + 1.; }\n\nfloat qinticIn( float t ) { return pow( t, 5. ); }\nfloat qinticOut( float t ) { return 1. - ( pow( t - 1.0, 5. ) ); }\nfloat qinticInOut( float t ) { return t < .5 ? + 16. * pow( t, 5. ) : - .5 * pow( 2. * t - 2.0, 5. ) + 1.; }\n\nfloat sineInOut( float t ) { return -0.5 * ( cos( PI * t ) - 1. ); }\nfloat sineIn( float t ) { return sin( ( t - 1. ) * PI_HALF ) + 1.; }\nfloat sineOut( float t ) { return sin( t * PI_HALF ); }\n\nfloat linear( float t ) { return t; }\n",i.a.lights_fragment_begin="/**\n * This is a template that can be used to light a material, it uses pluggable\n * RenderEquations (RE)for specific lighting scenarios.\n *\n * Instructions for use:\n * - Ensure that both RE_Direct, RE_IndirectDiffuse and RE_IndirectSpecular are defined\n * - If you have defined an RE_IndirectSpecular, you need to also provide a Material_LightProbeLOD. <---- ???\n * - Create a material parameter that is to be passed as the third parameter to your lighting functions.\n *\n * TODO:\n * - Add area light support.\n * - Add sphere light support.\n * - Add diffuse light probe (irradiance cubemap) support.\n */\n\nGeometricContext geometry;\n\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n\n#ifdef CLEARCOAT\n\n\tgeometry.clearcoatNormal = clearcoatNormal;\n\n#endif\n\nIncidentLight directLight;\n\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\n\t\tpointLight = pointLights[ i ];\n\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\n\t\tspotLight = spotLights[ i ];\n\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\n\tfloat shadow;\n\tfloat weight;\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\n\t\tdirectionalLight = directionalLights[ i ];\n\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tshadow = all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\tweight = clamp( quarticIn( length( vDirectionalShadowCoord[ i ].xy * 2. - 1. ) ), .0, 1. );\n\t\tdirectLight.color *= mix( shadow, 1., weight );\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\n\tRectAreaLight rectAreaLight;\n\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\n\t}\n\t#pragma unroll_loop_end\n\n#endif\n\n#if defined( RE_IndirectDiffuse )\n\n\tvec3 iblIrradiance = vec3( 0.0 );\n\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\n\t\t}\n\t\t#pragma unroll_loop_end\n\n\t#endif\n\n#endif\n\n#if defined( RE_IndirectSpecular )\n\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n\n#endif\n";t.a=i.a},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(76),s=n(49);class a extends i.a{constructor(){super({uniforms:{tDiffuse:{value:null},v:{value:1/512},r:{value:.35}},vertexShader:s.a,fragmentShader:"uniform sampler2D tDiffuse;\nuniform float v;\nuniform float r;\n\nvarying vec2 vUv;\n\nvoid main() {\n\n\tvec4 sum = vec4( 0.0 );\n\n\tfloat vv = v * abs( r - vUv.y );\n\n\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * vv ) ) * 0.051;\n\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * vv ) ) * 0.0918;\n\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * vv ) ) * 0.12245;\n\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * vv ) ) * 0.1531;\n\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;\n\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * vv ) ) * 0.1531;\n\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * vv ) ) * 0.12245;\n\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * vv ) ) * 0.0918;\n\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * vv ) ) * 0.051;\n\n\tgl_FragColor = sum;\n\n}\n"})}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(8),s=n(76),a=n(49);class r extends s.a{constructor(){super({uniforms:{tDiffuse:{value:null},color:{value:new i.a},aspect:{value:1},strength:{value:.5}},vertexShader:a.a,fragmentShader:"varying vec2 vUv;\n\nuniform sampler2D tDiffuse;\nuniform vec3 color;\nuniform float aspect;\nuniform float strength;\n\nvoid main() {\n\n\tgl_FragColor = texture2D( tDiffuse, vUv );\n\n\tvec2 uv = vUv * 2. - 1.;\n\tfloat radius = length( uv );\n\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, color, radius * strength );\n\n}\n"})}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var i=n(122),s=n(121);class a{constructor(e){this.files=e,this.log=!1,this.clear()}getFilesData(e,t=[]){if(e.hasOwnProperty("mime"))t.push(e);else for(const n in e)this.getFilesData(e[n],t)}add(e,t,n){this.items[e]=t,n&&(this.files.map[e]=t.source||t.string,this.packs[n]||(this.packs[n]={}),this.packs[n][e]=t)}get(e,t=!0){if(this.items[e])return this.items[e];if(this.packs[e])return this.packs[e];if(t)for(const t in this.items)if(t.match(e))return this.items[t]}clear(){this.packs={},this.items={}}}class r{constructor(e){this.path=e.config.paths.assets,this.manifest=e.manifest,this.map=this.manifest.map,this.cache=new a(this),this.unpacker=new s.a(this),this.loader=new i.a(this)}load(e){return this.loader.load(e)}get(e,t=!0){return this.cache.get(e,t)}}},,,,,,,,function(e,t,n){"use strict";n.r(t),function(e){var t=n(134),i=n(4),s=n(0),a=n(14),r=n(117),o=n(276),l=n.n(o),c=n(277),h=n(278),d=n(279),u=n(280),p=n(281),m=n(282);class f extends t.a{constructor(){const t=new Date,n=new Date("11/26/2020");if(Date.parse(t)>Date.parse(n)&&(content.dynamic.date=!1),!config.isDev){const e=/(home)/g;for(let t=0,n=r.a.views.length;t<n;t++){const n=r.a.views[t];n.options.silent=!n.id.match(e)}}super(r.a,l.a),e(this),i.a.preloader=new c.a(this.nodes.preloader),i.a.menu=new h.a(this.nodes.menu),i.a.notification=new d.a(this.nodes.notification),i.a.footer=new u.a(this.nodes.footer),i.a.scrollTo=new p.a(this.nodes.scrollTo),i.a.tutorial=new m.a(this.nodes.tutorial),this.files=[{path:"packs/canvas.pack"},{path:"packs/app.pack"}],a.a.characters.Intro?i.a.router.start():i.a.router.navigate("/dialog/intro"),i.a.tracker.map={"dialog/intro":"intro","video/brand-film":"special-content/brand-film","dialog/video-itw-1":"dialog/itw-raneem-el-weleily","dialog/video-itw-2":"dialog/itw-derek-redmond","dialog/video-itw-3":"dialog/itw-dara-torres","video/itw-1":"video/itw-raneem-el-weleily","video/itw-2":"video/itw-derek-redmond","video/itw-3":"video/itw-dara-torres","video/app":"video/app-demo","collectable/accessible":"collectible/accessible","collectable/connected":"collectible/connected","collectable/eco-friendly":"collectible/eco-friendly"},this._setAudioEventListeners(this.nodes.main),s.a.addEventListener("ready",this._onEngineReady)}_onRouteMatched(e){super._onRouteMatched(e),i.a.router.history.current||(this.nodes.main.style=null)}_onViewLoaded(e){super._onViewLoaded(e);const t=e.target;t.addEventListener("enter",this._onViewEnter),t.addEventListener("exit",this._onViewExit),s.a.initialize(i.a.files.get("canvas.pack"))}_onEngineReady(){const e=this.nodes.main.children[0];this.nodes.main.insertBefore(s.a.renderer.domElement,e)}_onViewEnter(e){const t=e.target;this._setAudioEventListeners(t.nodes.main)}_onViewExit(e){const t=e.target;this._setAudioEventListeners(t.nodes.main,!1)}_setAudioEventListeners(e,t=!0){const n=e.querySelectorAll(".button, a");if(!n)return;const i=Array.ensure(Array.from(n)),s=t?"addEventListener":"removeEventListener";i.forEach(e=>e[s]("mouseenter",this._onMouseEnter)),i.forEach(e=>e[s]("mouseleave",this._onMouseExit)),i.forEach(e=>e[s]("click",this._onClick))}_onMouseEnter(){s.a.audio&&s.a.audio.play("Hover",{volume:.5})}_onMouseExit(){}_onClick(){s.a.audio&&s.a.audio.play("Click")}}new f}.call(this,n(6).default)}],[[295,15,16]]]);